var mc=Object.defineProperty;var pc=(e,n,s)=>n in e?mc(e,n,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[n]=s;var xe=(e,n,s)=>pc(e,typeof n!="symbol"?n+"":n,s);import{j as t,e as gc,B as Qe,L as yc,f as xc,D as li,I as _n,g as ci,T as St,h as ui,b as di,M as hi,i as ar,k as us,l as fi,_ as mt,u as Kt,m as _e,n as rt,o as Xt,p as Jt,q as Va,F as mi,r as Mt,s as It,t as Je,v as pi,w as gi,x as Ya,y as vc,z as nr,A as bc,E as bs,G as Vt,H as Cr,J as yi,K as kn,N as xi,O as wc,Q as jc,R as kc,U as Cc,V as Nc,P as ca,W as Dc,X as ua,Y as Sc,Z as Mc,$ as Tc,a0 as Lo,a1 as Ro,a2 as da,a3 as ha,a4 as Ac,a5 as fa}from"./vendor-mui-BZvP95xl.js";import{r as f,g as zn,d as hn,h as Pc}from"./vendor-react-CcROqoQW.js";import{e as Oe,B as le,C as cn,a as Da,b as Sa,d as un,f as vi,c as Oc}from"./card-BllKVjiZ.js";import{I as vt,L as yr}from"./label-By7erjOc.js";import{c as De,b as He,a as or,X as Tt,D as bi,_ as Ec,d as rs,e as Xn}from"./index-BKYOk2PZ.js";import{S as ws,Z as _c,a as Ic,R as Ma,M as Fc}from"./ModeToggle-DHb4EDdt.js";import{M as Lc,r as Rc,a as $c}from"./vendor-markdown-DrF4gBv6.js";import{u as Bc,a as zc,P as js,b as Vc,R as Yc,I as Kc,c as ma,d as Wc,e as Hc,f as wi}from"./vendor-ui-C8BSmXpo.js";import{r as jr,w as In,a as ji,b as Uc,c as ki,e as qc,O as Gc,f as Qc,g as ds,d as Ci,h as Xc,i as Jc,t as Ta,j as Ni,k as Aa,l as Zc,D as eu,m as tu}from"./vendor-collab-yLth9yvd.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hs=De("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pa=De("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nu=De("ArchiveRestore",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h2",key:"tvwodi"}],["path",{d:"M20 8v11a2 2 0 0 1-2 2h-2",key:"1gkqxj"}],["path",{d:"m9 15 3-3 3 3",key:"1pd0qc"}],["path",{d:"M12 12v9",key:"192myk"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ks=De("Archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oa=De("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Di=De("CheckSquare",[["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11",key:"1jnkn4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fn=De("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ka=De("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ru=De("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Si=De("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const su=De("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mi=De("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wa=De("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const au=De("CloudOff",[["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M5.782 5.782A7 7 0 0 0 9 19h8.5a4.5 4.5 0 0 0 1.307-.193",key:"yfwify"}],["path",{d:"M21.532 16.5A4.5 4.5 0 0 0 17.5 10h-1.79A7.008 7.008 0 0 0 10 5.07",key:"jlfiyv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ou=De("Cloud",[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iu=De("Code",[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lu=De("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ea=De("Crown",[["path",{d:"m2 4 3 12h14l3-12-6 7-4-7-4 7-6-7zm3 16h14",key:"zkxr6b"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cu=De("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cs=De("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uu=De("FileJson",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 12a1 1 0 0 0-1 1v1a1 1 0 0 1-1 1 1 1 0 0 1 1 1v1a1 1 0 0 0 1 1",key:"1oajmo"}],["path",{d:"M14 18a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1 1 1 0 0 1-1-1v-1a1 1 0 0 0-1-1",key:"mpwhp6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _t=De("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const du=De("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ti=De("FolderPlus",[["path",{d:"M12 10v6",key:"1bos4e"}],["path",{d:"M9 13h6",key:"1uhe8q"}],["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hu=De("FolderTree",[["path",{d:"M20 10a1 1 0 0 0 1-1V6a1 1 0 0 0-1-1h-2.5a1 1 0 0 1-.8-.4l-.9-1.2A1 1 0 0 0 15 3h-2a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1Z",key:"hod4my"}],["path",{d:"M20 21a1 1 0 0 0 1-1v-3a1 1 0 0 0-1-1h-2.9a1 1 0 0 1-.88-.55l-.42-.85a1 1 0 0 0-.92-.6H13a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1Z",key:"w4yl2u"}],["path",{d:"M3 5a2 2 0 0 0 2 2h3",key:"f2jnh7"}],["path",{d:"M3 3v13a2 2 0 0 0 2 2h3",key:"k8epm1"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ai=De("Folder",[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pa=De("HardDrive",[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fu=De("Heading1",[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"m17 12 3-2v8",key:"1hhhft"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mu=De("Heading2",[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"M21 18h-4c0-4 4-3 4-6 0-1.5-2-2.5-4-1",key:"9jr5yi"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pu=De("Heading3",[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"M17.5 10.5c1.7-1 3.5 0 3.5 1.5a2 2 0 0 1-2 2",key:"68ncm8"}],["path",{d:"M17 17.5c2 1.5 4 .3 4-1.5a2 2 0 0 0-2-2",key:"1ejuhz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gu=De("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pi=De("Inbox",[["polyline",{points:"22 12 16 12 14 15 10 15 8 12 2 12",key:"o97t9d"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oi=De("Keyboard",[["path",{d:"M10 8h.01",key:"1r9ogq"}],["path",{d:"M12 12h.01",key:"1mp3jc"}],["path",{d:"M14 8h.01",key:"1primd"}],["path",{d:"M16 12h.01",key:"1l6xoz"}],["path",{d:"M18 8h.01",key:"emo2bl"}],["path",{d:"M6 8h.01",key:"x9i8wu"}],["path",{d:"M7 16h10",key:"wp8him"}],["path",{d:"M8 12h.01",key:"czm47f"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yu=De("ListOrdered",[["line",{x1:"10",x2:"21",y1:"6",y2:"6",key:"76qw6h"}],["line",{x1:"10",x2:"21",y1:"12",y2:"12",key:"16nom4"}],["line",{x1:"10",x2:"21",y1:"18",y2:"18",key:"u3jurt"}],["path",{d:"M4 6h1v4",key:"cnovpq"}],["path",{d:"M4 10h2",key:"16xx2s"}],["path",{d:"M6 18H4c0-1 2-2 2-3s-1-1.5-2-1",key:"m9a95d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xu=De("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ei=De("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vu=De("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bu=De("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _a=De("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wu=De("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _i=De("MoreVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ju=De("Network",[["rect",{x:"16",y:"16",width:"6",height:"6",rx:"1",key:"4q2zg0"}],["rect",{x:"2",y:"16",width:"6",height:"6",rx:"1",key:"8cvhb9"}],["rect",{x:"9",y:"2",width:"6",height:"6",rx:"1",key:"1egb70"}],["path",{d:"M5 16v-3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3",key:"1jsf9p"}],["path",{d:"M12 12V8",key:"2874zd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ku=De("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ns=De("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pr=De("Pencil",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cu=De("PinOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["line",{x1:"12",x2:"12",y1:"17",y2:"22",key:"1jrz49"}],["path",{d:"M9 9v1.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24V17h12",key:"13x2n8"}],["path",{d:"M15 9.34V6h1a2 2 0 0 0 0-4H7.89",key:"reo3ki"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ii=De("Pin",[["line",{x1:"12",x2:"12",y1:"17",y2:"22",key:"1jrz49"}],["path",{d:"M5 17h14v-1.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V6h1a2 2 0 0 0 0-4H8a2 2 0 0 0 0 4h1v4.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24Z",key:"13yl11"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cn=De("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nu=De("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Du=De("Quote",[["path",{d:"M3 21c3 0 7-1 7-8V5c0-1.25-.756-2.017-2-2H4c-1.25 0-2 .75-2 1.972V11c0 1.25.75 2 2 2 1 0 1 0 1 1v1c0 1-1 2-2 2s-1 .008-1 1.031V20c0 1 0 1 1 1z",key:"4rm80e"}],["path",{d:"M15 21c3 0 7-1 7-8V5c0-1.25-.757-2.017-2-2h-4c-1.25 0-2 .75-2 1.972V11c0 1.25.75 2 2 2h.75c0 2.25.25 4-2.75 4v3c0 1 0 1 1 1z",key:"10za9r"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fi=De("Reply",[["polyline",{points:"9 17 4 12 9 7",key:"hvgpf2"}],["path",{d:"M20 18v-2a4 4 0 0 0-4-4H4",key:"5vmcpk"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Su=De("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Li=De("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mu=De("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tu=De("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Au=De("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pu=De("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ou=De("Table",[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rr=De("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yt=De("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Eu=De("Undo2",[["path",{d:"M9 14 4 9l5-5",key:"102s5s"}],["path",{d:"M4 9h10.5a5.5 5.5 0 0 1 5.5 5.5v0a5.5 5.5 0 0 1-5.5 5.5H11",key:"llx8ln"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ri=De("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $o=De("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const er=De("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _u=De("ZoomIn",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Iu=De("ZoomOut",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);function Ds({className:e,variant:n="default",children:s,...o}){const l=()=>{switch(n){case"default":return"primary";case"secondary":return"secondary";case"destructive":return"error";case"outline":return"default";default:return"primary"}},u=()=>n==="outline"?"outlined":"filled";return t.jsx(gc,{label:s,color:l(),variant:u(),size:"small",className:Oe(e),sx:{height:"auto",borderRadius:"9999px",padding:"0.125rem 0","& .MuiChip-label":{padding:"0 0.625rem",fontSize:"0.75rem",fontWeight:600}},...o})}const Ss=f.forwardRef(({className:e,value:n=0,max:s=100,...o},l)=>{const u=Math.min(Math.max(n/s*100,0),100);return t.jsx(Qe,{ref:l,className:Oe("relative w-full",e),...o,children:t.jsx(yc,{variant:"determinate",value:u,sx:{height:"0.5rem",borderRadius:"9999px",backgroundColor:"rgba(var(--primary-rgb, 79, 70, 229), 0.2)","& .MuiLinearProgress-bar":{borderRadius:"9999px",backgroundColor:"primary.main"}}})})});Ss.displayName="Progress";const $i=f.createContext(null);function Bi(){const e=f.useContext($i);if(!e)throw new Error("Popover components must be used within a Popover");return e}const Ia=({children:e,open:n,onOpenChange:s,defaultOpen:o=!1})=>{const[l,u]=f.useState(o),[d,m]=f.useState(null),y=n!==void 0,g=y?n:l,w=f.useCallback(b=>{y||u(b),s==null||s(b)},[y,s]);return t.jsx($i.Provider,{value:{open:g,setOpen:w,anchorEl:d,setAnchorEl:m},children:e})},fs=f.forwardRef(({children:e,asChild:n,onClick:s,...o},l)=>{const{open:u,setOpen:d,setAnchorEl:m}=Bi(),y=g=>{s==null||s(g),m(g.currentTarget),d(!u)};return n&&f.isValidElement(e)?f.cloneElement(e,{onClick:y,ref:l}):t.jsx("button",{ref:l,onClick:y,...o,children:e})});fs.displayName="PopoverTrigger";const ms=f.forwardRef(({className:e,children:n,align:s="center",side:o="bottom",sideOffset:l=4,alignOffset:u=0,onPointerDownOutside:d,onEscapeKeyDown:m,...y},g)=>{const{open:w,setOpen:b,anchorEl:C}=Bi(),x=()=>({vertical:o==="top"?"top":o==="bottom"?"bottom":"center",horizontal:s==="start"?"left":s==="end"?"right":"center"}),j=()=>({vertical:o==="top"?"bottom":o==="bottom"?"top":"center",horizontal:s==="start"?"left":s==="end"?"right":"center"}),I=(k,M)=>{if(M==="backdropClick"&&d){const D=new Event("pointerdown");d(D);return}if(M==="escapeKeyDown"&&m){const D=new KeyboardEvent("keydown",{key:"Escape"});m(D);return}b(!1)};return t.jsx(xc,{open:w&&!!C,anchorEl:C,onClose:I,anchorOrigin:x(),transformOrigin:j(),slotProps:{paper:{ref:g,className:Oe("w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md",e),sx:{marginTop:o==="bottom"?`${l}px`:void 0,marginBottom:o==="top"?`${l}px`:void 0,marginLeft:o==="right"?`${l}px`:void 0,marginRight:o==="left"?`${l}px`:void 0,backgroundImage:"none"},...y}},children:n})});ms.displayName="PopoverContent";var zi={exports:{}};(function(e,n){(function(s,o){e.exports=o()})(hn,function(){var s=function(r,a){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,c){i.__proto__=c}||function(i,c){for(var h in c)Object.prototype.hasOwnProperty.call(c,h)&&(i[h]=c[h])})(r,a)},o=function(){return(o=Object.assign||function(r){for(var a,i=1,c=arguments.length;i<c;i++)for(var h in a=arguments[i])Object.prototype.hasOwnProperty.call(a,h)&&(r[h]=a[h]);return r}).apply(this,arguments)};function l(r,a,i){for(var c,h=0,p=a.length;h<p;h++)!c&&h in a||((c=c||Array.prototype.slice.call(a,0,h))[h]=a[h]);return r.concat(c||Array.prototype.slice.call(a))}var u=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:hn,d=Object.keys,m=Array.isArray;function y(r,a){return typeof a!="object"||d(a).forEach(function(i){r[i]=a[i]}),r}typeof Promise>"u"||u.Promise||(u.Promise=Promise);var g=Object.getPrototypeOf,w={}.hasOwnProperty;function b(r,a){return w.call(r,a)}function C(r,a){typeof a=="function"&&(a=a(g(r))),(typeof Reflect>"u"?d:Reflect.ownKeys)(a).forEach(function(i){j(r,i,a[i])})}var x=Object.defineProperty;function j(r,a,i,c){x(r,a,y(i&&b(i,"get")&&typeof i.get=="function"?{get:i.get,set:i.set,configurable:!0}:{value:i,configurable:!0,writable:!0},c))}function I(r){return{from:function(a){return r.prototype=Object.create(a.prototype),j(r.prototype,"constructor",r),{extend:C.bind(null,r.prototype)}}}}var k=Object.getOwnPropertyDescriptor,M=[].slice;function D(r,a,i){return M.call(r,a,i)}function q(r,a){return a(r)}function O(r){if(!r)throw new Error("Assertion Failed")}function Q(r){u.setImmediate?setImmediate(r):setTimeout(r,0)}function T(r,a){if(typeof a=="string"&&b(r,a))return r[a];if(!a)return r;if(typeof a!="string"){for(var i=[],c=0,h=a.length;c<h;++c){var p=T(r,a[c]);i.push(p)}return i}var v=a.indexOf(".");if(v!==-1){var N=r[a.substr(0,v)];return N==null?void 0:T(N,a.substr(v+1))}}function P(r,a,i){if(r&&a!==void 0&&!("isFrozen"in Object&&Object.isFrozen(r)))if(typeof a!="string"&&"length"in a){O(typeof i!="string"&&"length"in i);for(var c=0,h=a.length;c<h;++c)P(r,a[c],i[c])}else{var p,v,N=a.indexOf(".");N!==-1?(p=a.substr(0,N),(v=a.substr(N+1))===""?i===void 0?m(r)&&!isNaN(parseInt(p))?r.splice(p,1):delete r[p]:r[p]=i:P(N=!(N=r[p])||!b(r,p)?r[p]={}:N,v,i)):i===void 0?m(r)&&!isNaN(parseInt(a))?r.splice(a,1):delete r[a]:r[a]=i}}function U(r){var a,i={};for(a in r)b(r,a)&&(i[a]=r[a]);return i}var Y=[].concat;function J(r){return Y.apply([],r)}var fe="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(J([8,16,32,64].map(function(r){return["Int","Uint","Float"].map(function(a){return a+r+"Array"})}))).filter(function(r){return u[r]}),ne=new Set(fe.map(function(r){return u[r]})),G=null;function oe(r){return G=new WeakMap,r=function a(i){if(!i||typeof i!="object")return i;var c=G.get(i);if(c)return c;if(m(i)){c=[],G.set(i,c);for(var h=0,p=i.length;h<p;++h)c.push(a(i[h]))}else if(ne.has(i.constructor))c=i;else{var v,N=g(i);for(v in c=N===Object.prototype?{}:Object.create(N),G.set(i,c),i)b(i,v)&&(c[v]=a(i[v]))}return c}(r),G=null,r}var te={}.toString;function z(r){return te.call(r).slice(8,-1)}var K=typeof Symbol<"u"?Symbol.iterator:"@@iterator",W=typeof K=="symbol"?function(r){var a;return r!=null&&(a=r[K])&&a.apply(r)}:function(){return null};function ee(r,a){return a=r.indexOf(a),0<=a&&r.splice(a,1),0<=a}var ie={};function me(r){var a,i,c,h;if(arguments.length===1){if(m(r))return r.slice();if(this===ie&&typeof r=="string")return[r];if(h=W(r)){for(i=[];!(c=h.next()).done;)i.push(c.value);return i}if(r==null)return[r];if(typeof(a=r.length)!="number")return[r];for(i=new Array(a);a--;)i[a]=r[a];return i}for(a=arguments.length,i=new Array(a);a--;)i[a]=arguments[a];return i}var ke=typeof Symbol<"u"?function(r){return r[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},Ct=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],Pt=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(Ct),Te={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function Ae(r,a){this.name=r,this.message=a}function Be(r,a){return r+". Errors: "+Object.keys(a).map(function(i){return a[i].toString()}).filter(function(i,c,h){return h.indexOf(i)===c}).join(`
`)}function de(r,a,i,c){this.failures=a,this.failedKeys=c,this.successCount=i,this.message=Be(r,a)}function Le(r,a){this.name="BulkError",this.failures=Object.keys(a).map(function(i){return a[i]}),this.failuresByPos=a,this.message=Be(r,this.failures)}I(Ae).from(Error).extend({toString:function(){return this.name+": "+this.message}}),I(de).from(Ae),I(Le).from(Ae);var Ve=Pt.reduce(function(r,a){return r[a]=a+"Error",r},{}),tt=Ae,ce=Pt.reduce(function(r,a){var i=a+"Error";function c(h,p){this.name=i,h?typeof h=="string"?(this.message="".concat(h).concat(p?`
 `+p:""),this.inner=p||null):typeof h=="object"&&(this.message="".concat(h.name," ").concat(h.message),this.inner=h):(this.message=Te[a]||i,this.inner=null)}return I(c).from(tt),r[a]=c,r},{});ce.Syntax=SyntaxError,ce.Type=TypeError,ce.Range=RangeError;var Ie=Ct.reduce(function(r,a){return r[a+"Error"]=ce[a],r},{}),X=Pt.reduce(function(r,a){return["Syntax","Type","Range"].indexOf(a)===-1&&(r[a+"Error"]=ce[a]),r},{});function se(){}function Ce(r){return r}function we(r,a){return r==null||r===Ce?a:function(i){return a(r(i))}}function re(r,a){return function(){r.apply(this,arguments),a.apply(this,arguments)}}function Pe(r,a){return r===se?a:function(){var i=r.apply(this,arguments);i!==void 0&&(arguments[0]=i);var c=this.onsuccess,h=this.onerror;this.onsuccess=null,this.onerror=null;var p=a.apply(this,arguments);return c&&(this.onsuccess=this.onsuccess?re(c,this.onsuccess):c),h&&(this.onerror=this.onerror?re(h,this.onerror):h),p!==void 0?p:i}}function qe(r,a){return r===se?a:function(){r.apply(this,arguments);var i=this.onsuccess,c=this.onerror;this.onsuccess=this.onerror=null,a.apply(this,arguments),i&&(this.onsuccess=this.onsuccess?re(i,this.onsuccess):i),c&&(this.onerror=this.onerror?re(c,this.onerror):c)}}function Ze(r,a){return r===se?a:function(i){var c=r.apply(this,arguments);y(i,c);var h=this.onsuccess,p=this.onerror;return this.onsuccess=null,this.onerror=null,i=a.apply(this,arguments),h&&(this.onsuccess=this.onsuccess?re(h,this.onsuccess):h),p&&(this.onerror=this.onerror?re(p,this.onerror):p),c===void 0?i===void 0?void 0:i:y(c,i)}}function st(r,a){return r===se?a:function(){return a.apply(this,arguments)!==!1&&r.apply(this,arguments)}}function Ee(r,a){return r===se?a:function(){var i=r.apply(this,arguments);if(i&&typeof i.then=="function"){for(var c=this,h=arguments.length,p=new Array(h);h--;)p[h]=arguments[h];return i.then(function(){return a.apply(c,p)})}return a.apply(this,arguments)}}X.ModifyError=de,X.DexieError=Ae,X.BulkError=Le;var Re=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function kt(r){Re=r}var pt={},Wt=100,fe=typeof Promise>"u"?[]:function(){var r=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[r,g(r),r];var a=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[a,g(a),r]}(),Ct=fe[0],Pt=fe[1],fe=fe[2],Pt=Pt&&Pt.then,Se=Ct&&Ct.constructor,Ge=!!fe,bt=function(r,a){We.push([r,a]),Vn&&(queueMicrotask(Kl),Vn=!1)},ir=!0,Vn=!0,Ft=[],en=[],Nn=Ce,At={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:se,pgp:!1,env:{},finalize:se},Me=At,We=[],ct=0,Lt=[];function ge(r){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var a=this._PSD=Me;if(typeof r!="function"){if(r!==pt)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&Es(this,this._value))}this._state=null,this._value=null,++a.ref,function i(c,h){try{h(function(p){if(c._state===null){if(p===c)throw new TypeError("A promise cannot be resolved with itself.");var v=c._lib&&Yn();p&&typeof p.then=="function"?i(c,function(N,A){p instanceof ge?p._then(N,A):p.then(N,A)}):(c._state=!0,c._value=p,so(c)),v&&Kn()}},Es.bind(null,c))}catch(p){Es(c,p)}}(this,r)}var Os={get:function(){var r=Me,a=Lr;function i(c,h){var p=this,v=!r.global&&(r!==Me||a!==Lr),N=v&&!nn(),A=new ge(function(E,R){_s(p,new ro(oo(c,r,v,N),oo(h,r,v,N),E,R,r))});return this._consoleTask&&(A._consoleTask=this._consoleTask),A}return i.prototype=pt,i},set:function(r){j(this,"then",r&&r.prototype===pt?Os:{get:function(){return r},set:Os.set})}};function ro(r,a,i,c,h){this.onFulfilled=typeof r=="function"?r:null,this.onRejected=typeof a=="function"?a:null,this.resolve=i,this.reject=c,this.psd=h}function Es(r,a){var i,c;en.push(a),r._state===null&&(i=r._lib&&Yn(),a=Nn(a),r._state=!1,r._value=a,c=r,Ft.some(function(h){return h._value===c._value})||Ft.push(c),so(r),i&&Kn())}function so(r){var a=r._listeners;r._listeners=[];for(var i=0,c=a.length;i<c;++i)_s(r,a[i]);var h=r._PSD;--h.ref||h.finalize(),ct===0&&(++ct,bt(function(){--ct==0&&Is()},[]))}function _s(r,a){if(r._state!==null){var i=r._state?a.onFulfilled:a.onRejected;if(i===null)return(r._state?a.resolve:a.reject)(r._value);++a.psd.ref,++ct,bt(Yl,[i,r,a])}else r._listeners.push(a)}function Yl(r,a,i){try{var c,h=a._value;!a._state&&en.length&&(en=[]),c=Re&&a._consoleTask?a._consoleTask.run(function(){return r(h)}):r(h),a._state||en.indexOf(h)!==-1||function(p){for(var v=Ft.length;v;)if(Ft[--v]._value===p._value)return Ft.splice(v,1)}(a),i.resolve(c)}catch(p){i.reject(p)}finally{--ct==0&&Is(),--i.psd.ref||i.psd.finalize()}}function Kl(){Dn(At,function(){Yn()&&Kn()})}function Yn(){var r=ir;return Vn=ir=!1,r}function Kn(){var r,a,i;do for(;0<We.length;)for(r=We,We=[],i=r.length,a=0;a<i;++a){var c=r[a];c[0].apply(null,c[1])}while(0<We.length);Vn=ir=!0}function Is(){var r=Ft;Ft=[],r.forEach(function(c){c._PSD.onunhandled.call(null,c._value,c)});for(var a=Lt.slice(0),i=a.length;i;)a[--i]()}function _r(r){return new ge(pt,!1,r)}function at(r,a){var i=Me;return function(){var c=Yn(),h=Me;try{return rn(i,!0),r.apply(this,arguments)}catch(p){a&&a(p)}finally{rn(h,!1),c&&Kn()}}}C(ge.prototype,{then:Os,_then:function(r,a){_s(this,new ro(null,null,r,a,Me))},catch:function(r){if(arguments.length===1)return this.then(null,r);var a=r,i=arguments[1];return typeof a=="function"?this.then(null,function(c){return(c instanceof a?i:_r)(c)}):this.then(null,function(c){return(c&&c.name===a?i:_r)(c)})},finally:function(r){return this.then(function(a){return ge.resolve(r()).then(function(){return a})},function(a){return ge.resolve(r()).then(function(){return _r(a)})})},timeout:function(r,a){var i=this;return r<1/0?new ge(function(c,h){var p=setTimeout(function(){return h(new ce.Timeout(a))},r);i.then(c,h).finally(clearTimeout.bind(null,p))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&j(ge.prototype,Symbol.toStringTag,"Dexie.Promise"),At.env=ao(),C(ge,{all:function(){var r=me.apply(null,arguments).map(Rr);return new ge(function(a,i){r.length===0&&a([]);var c=r.length;r.forEach(function(h,p){return ge.resolve(h).then(function(v){r[p]=v,--c||a(r)},i)})})},resolve:function(r){return r instanceof ge?r:r&&typeof r.then=="function"?new ge(function(a,i){r.then(a,i)}):new ge(pt,!0,r)},reject:_r,race:function(){var r=me.apply(null,arguments).map(Rr);return new ge(function(a,i){r.map(function(c){return ge.resolve(c).then(a,i)})})},PSD:{get:function(){return Me},set:function(r){return Me=r}},totalEchoes:{get:function(){return Lr}},newPSD:tn,usePSD:Dn,scheduler:{get:function(){return bt},set:function(r){bt=r}},rejectionMapper:{get:function(){return Nn},set:function(r){Nn=r}},follow:function(r,a){return new ge(function(i,c){return tn(function(h,p){var v=Me;v.unhandleds=[],v.onunhandled=p,v.finalize=re(function(){var N,A=this;N=function(){A.unhandleds.length===0?h():p(A.unhandleds[0])},Lt.push(function E(){N(),Lt.splice(Lt.indexOf(E),1)}),++ct,bt(function(){--ct==0&&Is()},[])},v.finalize),r()},a,i,c)})}}),Se&&(Se.allSettled&&j(ge,"allSettled",function(){var r=me.apply(null,arguments).map(Rr);return new ge(function(a){r.length===0&&a([]);var i=r.length,c=new Array(i);r.forEach(function(h,p){return ge.resolve(h).then(function(v){return c[p]={status:"fulfilled",value:v}},function(v){return c[p]={status:"rejected",reason:v}}).then(function(){return--i||a(c)})})})}),Se.any&&typeof AggregateError<"u"&&j(ge,"any",function(){var r=me.apply(null,arguments).map(Rr);return new ge(function(a,i){r.length===0&&i(new AggregateError([]));var c=r.length,h=new Array(c);r.forEach(function(p,v){return ge.resolve(p).then(function(N){return a(N)},function(N){h[v]=N,--c||i(new AggregateError(h))})})})}),Se.withResolvers&&(ge.withResolvers=Se.withResolvers));var ut={awaits:0,echoes:0,id:0},Wl=0,Ir=[],Fr=0,Lr=0,Hl=0;function tn(r,a,i,c){var h=Me,p=Object.create(h);return p.parent=h,p.ref=0,p.global=!1,p.id=++Hl,At.env,p.env=Ge?{Promise:ge,PromiseProp:{value:ge,configurable:!0,writable:!0},all:ge.all,race:ge.race,allSettled:ge.allSettled,any:ge.any,resolve:ge.resolve,reject:ge.reject}:{},a&&y(p,a),++h.ref,p.finalize=function(){--this.parent.ref||this.parent.finalize()},c=Dn(p,r,i,c),p.ref===0&&p.finalize(),c}function Wn(){return ut.id||(ut.id=++Wl),++ut.awaits,ut.echoes+=Wt,ut.id}function nn(){return!!ut.awaits&&(--ut.awaits==0&&(ut.id=0),ut.echoes=ut.awaits*Wt,!0)}function Rr(r){return ut.echoes&&r&&r.constructor===Se?(Wn(),r.then(function(a){return nn(),a},function(a){return nn(),it(a)})):r}function Ul(){var r=Ir[Ir.length-1];Ir.pop(),rn(r,!1)}function rn(r,a){var i,c=Me;(a?!ut.echoes||Fr++&&r===Me:!Fr||--Fr&&r===Me)||queueMicrotask(a?(function(h){++Lr,ut.echoes&&--ut.echoes!=0||(ut.echoes=ut.awaits=ut.id=0),Ir.push(Me),rn(h,!0)}).bind(null,r):Ul),r!==Me&&(Me=r,c===At&&(At.env=ao()),Ge&&(i=At.env.Promise,a=r.env,(c.global||r.global)&&(Object.defineProperty(u,"Promise",a.PromiseProp),i.all=a.all,i.race=a.race,i.resolve=a.resolve,i.reject=a.reject,a.allSettled&&(i.allSettled=a.allSettled),a.any&&(i.any=a.any))))}function ao(){var r=u.Promise;return Ge?{Promise:r,PromiseProp:Object.getOwnPropertyDescriptor(u,"Promise"),all:r.all,race:r.race,allSettled:r.allSettled,any:r.any,resolve:r.resolve,reject:r.reject}:{}}function Dn(r,a,i,c,h){var p=Me;try{return rn(r,!0),a(i,c,h)}finally{rn(p,!1)}}function oo(r,a,i,c){return typeof r!="function"?r:function(){var h=Me;i&&Wn(),rn(a,!0);try{return r.apply(this,arguments)}finally{rn(h,!1),c&&queueMicrotask(nn)}}}function Fs(r){Promise===Se&&ut.echoes===0?Fr===0?r():enqueueNativeMicroTask(r):setTimeout(r,0)}(""+Pt).indexOf("[native code]")===-1&&(Wn=nn=se);var it=ge.reject,Sn="ï¿¿",Ht="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",io="String expected.",Hn=[],$r="__dbnames",Ls="readonly",Rs="readwrite";function Mn(r,a){return r?a?function(){return r.apply(this,arguments)&&a.apply(this,arguments)}:r:a}var lo={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Br(r){return typeof r!="string"||/\./.test(r)?function(a){return a}:function(a){return a[r]===void 0&&r in a&&delete(a=oe(a))[r],a}}function co(){throw ce.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function Ke(r,a){try{var i=uo(r),c=uo(a);if(i!==c)return i==="Array"?1:c==="Array"?-1:i==="binary"?1:c==="binary"?-1:i==="string"?1:c==="string"?-1:i==="Date"?1:c!=="Date"?NaN:-1;switch(i){case"number":case"Date":case"string":return a<r?1:r<a?-1:0;case"binary":return function(h,p){for(var v=h.length,N=p.length,A=v<N?v:N,E=0;E<A;++E)if(h[E]!==p[E])return h[E]<p[E]?-1:1;return v===N?0:v<N?-1:1}(ho(r),ho(a));case"Array":return function(h,p){for(var v=h.length,N=p.length,A=v<N?v:N,E=0;E<A;++E){var R=Ke(h[E],p[E]);if(R!==0)return R}return v===N?0:v<N?-1:1}(r,a)}}catch{}return NaN}function uo(r){var a=typeof r;return a!="object"?a:ArrayBuffer.isView(r)?"binary":(r=z(r),r==="ArrayBuffer"?"binary":r)}function ho(r){return r instanceof Uint8Array?r:ArrayBuffer.isView(r)?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):new Uint8Array(r)}function zr(r,a,i){var c=r.schema.yProps;return c?(a&&0<i.numFailures&&(a=a.filter(function(h,p){return!i.failures[p]})),Promise.all(c.map(function(h){return h=h.updatesTable,a?r.db.table(h).where("k").anyOf(a).delete():r.db.table(h).clear()})).then(function(){return i})):i}var lr=(fo.prototype.execute=function(r){var a=this["@@propmod"];if(a.add!==void 0){var i=a.add;if(m(i))return l(l([],m(r)?r:[],!0),i).sort();if(typeof i=="number")return(Number(r)||0)+i;if(typeof i=="bigint")try{return BigInt(r)+i}catch{return BigInt(0)+i}throw new TypeError("Invalid term ".concat(i))}if(a.remove!==void 0){var c=a.remove;if(m(c))return m(r)?r.filter(function(h){return!c.includes(h)}).sort():[];if(typeof c=="number")return Number(r)-c;if(typeof c=="bigint")try{return BigInt(r)-c}catch{return BigInt(0)-c}throw new TypeError("Invalid subtrahend ".concat(c))}return i=(i=a.replacePrefix)===null||i===void 0?void 0:i[0],i&&typeof r=="string"&&r.startsWith(i)?a.replacePrefix[1]+r.substring(i.length):r},fo);function fo(r){this["@@propmod"]=r}function mo(r,a){for(var i=d(a),c=i.length,h=!1,p=0;p<c;++p){var v=i[p],N=a[v],A=T(r,v);N instanceof lr?(P(r,v,N.execute(A)),h=!0):A!==N&&(P(r,v,N),h=!0)}return h}var po=(nt.prototype._trans=function(r,a,i){var c=this._tx||Me.trans,h=this.name,p=Re&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(r==="readonly"?"read":"write"," ").concat(this.name));function v(E,R,S){if(!S.schema[h])throw new ce.NotFound("Table "+h+" not part of transaction");return a(S.idbtrans,S)}var N=Yn();try{var A=c&&c.db._novip===this.db._novip?c===Me.trans?c._promise(r,v,i):tn(function(){return c._promise(r,v,i)},{trans:c,transless:Me.transless||Me}):function E(R,S,B,_){if(R.idbdb&&(R._state.openComplete||Me.letThrough||R._vip)){var F=R._createTransaction(S,B,R._dbSchema);try{F.create(),R._state.PR1398_maxLoop=3}catch(L){return L.name===Ve.InvalidState&&R.isOpen()&&0<--R._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),R.close({disableAutoOpen:!1}),R.open().then(function(){return E(R,S,B,_)})):it(L)}return F._promise(S,function(L,$){return tn(function(){return Me.trans=F,_(L,$,F)})}).then(function(L){if(S==="readwrite")try{F.idbtrans.commit()}catch{}return S==="readonly"?L:F._completion.then(function(){return L})})}if(R._state.openComplete)return it(new ce.DatabaseClosed(R._state.dbOpenError));if(!R._state.isBeingOpened){if(!R._state.autoOpen)return it(new ce.DatabaseClosed);R.open().catch(se)}return R._state.dbReadyPromise.then(function(){return E(R,S,B,_)})}(this.db,r,[this.name],v);return p&&(A._consoleTask=p,A=A.catch(function(E){return console.trace(E),it(E)})),A}finally{N&&Kn()}},nt.prototype.get=function(r,a){var i=this;return r&&r.constructor===Object?this.where(r).first(a):r==null?it(new ce.Type("Invalid argument to Table.get()")):this._trans("readonly",function(c){return i.core.get({trans:c,key:r}).then(function(h){return i.hook.reading.fire(h)})}).then(a)},nt.prototype.where=function(r){if(typeof r=="string")return new this.db.WhereClause(this,r);if(m(r))return new this.db.WhereClause(this,"[".concat(r.join("+"),"]"));var a=d(r);if(a.length===1)return this.where(a[0]).equals(r[a[0]]);var i=this.schema.indexes.concat(this.schema.primKey).filter(function(N){if(N.compound&&a.every(function(E){return 0<=N.keyPath.indexOf(E)})){for(var A=0;A<a.length;++A)if(a.indexOf(N.keyPath[A])===-1)return!1;return!0}return!1}).sort(function(N,A){return N.keyPath.length-A.keyPath.length})[0];if(i&&this.db._maxKey!==Sn){var p=i.keyPath.slice(0,a.length);return this.where(p).equals(p.map(function(A){return r[A]}))}!i&&Re&&console.warn("The query ".concat(JSON.stringify(r)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(a.join("+"),"]"));var c=this.schema.idxByName;function h(N,A){return Ke(N,A)===0}var v=a.reduce(function(S,A){var E=S[0],R=S[1],S=c[A],B=r[A];return[E||S,E||!S?Mn(R,S&&S.multi?function(_){return _=T(_,A),m(_)&&_.some(function(F){return h(B,F)})}:function(_){return h(B,T(_,A))}):R]},[null,null]),p=v[0],v=v[1];return p?this.where(p.name).equals(r[p.keyPath]).filter(v):i?this.filter(v):this.where(a).equals("")},nt.prototype.filter=function(r){return this.toCollection().and(r)},nt.prototype.count=function(r){return this.toCollection().count(r)},nt.prototype.offset=function(r){return this.toCollection().offset(r)},nt.prototype.limit=function(r){return this.toCollection().limit(r)},nt.prototype.each=function(r){return this.toCollection().each(r)},nt.prototype.toArray=function(r){return this.toCollection().toArray(r)},nt.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},nt.prototype.orderBy=function(r){return new this.db.Collection(new this.db.WhereClause(this,m(r)?"[".concat(r.join("+"),"]"):r))},nt.prototype.reverse=function(){return this.toCollection().reverse()},nt.prototype.mapToClass=function(r){var a,i=this.db,c=this.name;function h(){return a!==null&&a.apply(this,arguments)||this}(this.schema.mappedClass=r).prototype instanceof co&&(function(A,E){if(typeof E!="function"&&E!==null)throw new TypeError("Class extends value "+String(E)+" is not a constructor or null");function R(){this.constructor=A}s(A,E),A.prototype=E===null?Object.create(E):(R.prototype=E.prototype,new R)}(h,a=r),Object.defineProperty(h.prototype,"db",{get:function(){return i},enumerable:!1,configurable:!0}),h.prototype.table=function(){return c},r=h);for(var p=new Set,v=r.prototype;v;v=g(v))Object.getOwnPropertyNames(v).forEach(function(A){return p.add(A)});function N(A){if(!A)return A;var E,R=Object.create(r.prototype);for(E in A)if(!p.has(E))try{R[E]=A[E]}catch{}return R}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=N,this.hook("reading",N),r},nt.prototype.defineClass=function(){return this.mapToClass(function(r){y(this,r)})},nt.prototype.add=function(r,a){var i=this,c=this.schema.primKey,h=c.auto,p=c.keyPath,v=r;return p&&h&&(v=Br(p)(r)),this._trans("readwrite",function(N){return i.core.mutate({trans:N,type:"add",keys:a!=null?[a]:null,values:[v]})}).then(function(N){return N.numFailures?ge.reject(N.failures[0]):N.lastResult}).then(function(N){if(p)try{P(r,p,N)}catch{}return N})},nt.prototype.upsert=function(r,a){var i=this,c=this.schema.primKey.keyPath;return this._trans("readwrite",function(h){return i.core.get({trans:h,key:r}).then(function(p){var v=p??{};return mo(v,a),c&&P(v,c,r),i.core.mutate({trans:h,type:"put",values:[v],keys:[r],upsert:!0,updates:{keys:[r],changeSpecs:[a]}}).then(function(N){return N.numFailures?ge.reject(N.failures[0]):!!p})})})},nt.prototype.update=function(r,a){return typeof r!="object"||m(r)?this.where(":id").equals(r).modify(a):(r=T(r,this.schema.primKey.keyPath),r===void 0?it(new ce.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(r).modify(a))},nt.prototype.put=function(r,a){var i=this,c=this.schema.primKey,h=c.auto,p=c.keyPath,v=r;return p&&h&&(v=Br(p)(r)),this._trans("readwrite",function(N){return i.core.mutate({trans:N,type:"put",values:[v],keys:a!=null?[a]:null})}).then(function(N){return N.numFailures?ge.reject(N.failures[0]):N.lastResult}).then(function(N){if(p)try{P(r,p,N)}catch{}return N})},nt.prototype.delete=function(r){var a=this;return this._trans("readwrite",function(i){return a.core.mutate({trans:i,type:"delete",keys:[r]}).then(function(c){return zr(a,[r],c)}).then(function(c){return c.numFailures?ge.reject(c.failures[0]):void 0})})},nt.prototype.clear=function(){var r=this;return this._trans("readwrite",function(a){return r.core.mutate({trans:a,type:"deleteRange",range:lo}).then(function(i){return zr(r,null,i)})}).then(function(a){return a.numFailures?ge.reject(a.failures[0]):void 0})},nt.prototype.bulkGet=function(r){var a=this;return this._trans("readonly",function(i){return a.core.getMany({keys:r,trans:i}).then(function(c){return c.map(function(h){return a.hook.reading.fire(h)})})})},nt.prototype.bulkAdd=function(r,a,i){var c=this,h=Array.isArray(a)?a:void 0,p=(i=i||(h?void 0:a))?i.allKeys:void 0;return this._trans("readwrite",function(v){var E=c.schema.primKey,N=E.auto,E=E.keyPath;if(E&&h)throw new ce.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(h&&h.length!==r.length)throw new ce.InvalidArgument("Arguments objects and keys must have the same length");var A=r.length,E=E&&N?r.map(Br(E)):r;return c.core.mutate({trans:v,type:"add",keys:h,values:E,wantResults:p}).then(function(F){var S=F.numFailures,B=F.results,_=F.lastResult,F=F.failures;if(S===0)return p?B:_;throw new Le("".concat(c.name,".bulkAdd(): ").concat(S," of ").concat(A," operations failed"),F)})})},nt.prototype.bulkPut=function(r,a,i){var c=this,h=Array.isArray(a)?a:void 0,p=(i=i||(h?void 0:a))?i.allKeys:void 0;return this._trans("readwrite",function(v){var E=c.schema.primKey,N=E.auto,E=E.keyPath;if(E&&h)throw new ce.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(h&&h.length!==r.length)throw new ce.InvalidArgument("Arguments objects and keys must have the same length");var A=r.length,E=E&&N?r.map(Br(E)):r;return c.core.mutate({trans:v,type:"put",keys:h,values:E,wantResults:p}).then(function(F){var S=F.numFailures,B=F.results,_=F.lastResult,F=F.failures;if(S===0)return p?B:_;throw new Le("".concat(c.name,".bulkPut(): ").concat(S," of ").concat(A," operations failed"),F)})})},nt.prototype.bulkUpdate=function(r){var a=this,i=this.core,c=r.map(function(v){return v.key}),h=r.map(function(v){return v.changes}),p=[];return this._trans("readwrite",function(v){return i.getMany({trans:v,keys:c,cache:"clone"}).then(function(N){var A=[],E=[];r.forEach(function(S,B){var _=S.key,F=S.changes,L=N[B];if(L){for(var $=0,V=Object.keys(F);$<V.length;$++){var H=V[$],Z=F[H];if(H===a.schema.primKey.keyPath){if(Ke(Z,_)!==0)throw new ce.Constraint("Cannot update primary key in bulkUpdate()")}else P(L,H,Z)}p.push(B),A.push(_),E.push(L)}});var R=A.length;return i.mutate({trans:v,type:"put",keys:A,values:E,updates:{keys:c,changeSpecs:h}}).then(function(S){var B=S.numFailures,_=S.failures;if(B===0)return R;for(var F=0,L=Object.keys(_);F<L.length;F++){var $,V=L[F],H=p[Number(V)];H!=null&&($=_[V],delete _[V],_[H]=$)}throw new Le("".concat(a.name,".bulkUpdate(): ").concat(B," of ").concat(R," operations failed"),_)})})})},nt.prototype.bulkDelete=function(r){var a=this,i=r.length;return this._trans("readwrite",function(c){return a.core.mutate({trans:c,type:"delete",keys:r}).then(function(h){return zr(a,r,h)})}).then(function(v){var h=v.numFailures,p=v.lastResult,v=v.failures;if(h===0)return p;throw new Le("".concat(a.name,".bulkDelete(): ").concat(h," of ").concat(i," operations failed"),v)})},nt);function nt(){}function cr(r){function a(v,N){if(N){for(var A=arguments.length,E=new Array(A-1);--A;)E[A-1]=arguments[A];return i[v].subscribe.apply(null,E),r}if(typeof v=="string")return i[v]}var i={};a.addEventType=p;for(var c=1,h=arguments.length;c<h;++c)p(arguments[c]);return a;function p(v,N,A){if(typeof v!="object"){var E;N=N||st;var R={subscribers:[],fire:A=A||se,subscribe:function(S){R.subscribers.indexOf(S)===-1&&(R.subscribers.push(S),R.fire=N(R.fire,S))},unsubscribe:function(S){R.subscribers=R.subscribers.filter(function(B){return B!==S}),R.fire=R.subscribers.reduce(N,A)}};return i[v]=a[v]=R}d(E=v).forEach(function(S){var B=E[S];if(m(B))p(S,E[S][0],E[S][1]);else{if(B!=="asap")throw new ce.InvalidArgument("Invalid event config");var _=p(S,Ce,function(){for(var F=arguments.length,L=new Array(F);F--;)L[F]=arguments[F];_.subscribers.forEach(function($){Q(function(){$.apply(null,L)})})})}})}}function ur(r,a){return I(a).from({prototype:r}),a}function Un(r,a){return!(r.filter||r.algorithm||r.or)&&(a?r.justLimit:!r.replayFilter)}function $s(r,a){r.filter=Mn(r.filter,a)}function Bs(r,a,i){var c=r.replayFilter;r.replayFilter=c?function(){return Mn(c(),a())}:a,r.justLimit=i&&!c}function Vr(r,a){if(r.isPrimKey)return a.primaryKey;var i=a.getIndexByKeyPath(r.index);if(!i)throw new ce.Schema("KeyPath "+r.index+" on object store "+a.name+" is not indexed");return i}function go(r,a,i){var c=Vr(r,a.schema);return a.openCursor({trans:i,values:!r.keysOnly,reverse:r.dir==="prev",unique:!!r.unique,query:{index:c,range:r.range}})}function Yr(r,a,i,c){var h=r.replayFilter?Mn(r.filter,r.replayFilter()):r.filter;if(r.or){var p={},v=function(N,A,E){var R,S;h&&!h(A,E,function(B){return A.stop(B)},function(B){return A.fail(B)})||((S=""+(R=A.primaryKey))=="[object ArrayBuffer]"&&(S=""+new Uint8Array(R)),b(p,S)||(p[S]=!0,a(N,A,E)))};return Promise.all([r.or._iterate(v,i),yo(go(r,c,i),r.algorithm,v,!r.keysOnly&&r.valueMapper)])}return yo(go(r,c,i),Mn(r.algorithm,h),a,!r.keysOnly&&r.valueMapper)}function yo(r,a,i,c){var h=at(c?function(p,v,N){return i(c(p),v,N)}:i);return r.then(function(p){if(p)return p.start(function(){var v=function(){return p.continue()};a&&!a(p,function(N){return v=N},function(N){p.stop(N),v=se},function(N){p.fail(N),v=se})||h(p.value,p,function(N){return v=N}),v()})})}var ql=(Ue.prototype._read=function(r,a){var i=this._ctx;return i.error?i.table._trans(null,it.bind(null,i.error)):i.table._trans("readonly",r).then(a)},Ue.prototype._write=function(r){var a=this._ctx;return a.error?a.table._trans(null,it.bind(null,a.error)):a.table._trans("readwrite",r,"locked")},Ue.prototype._addAlgorithm=function(r){var a=this._ctx;a.algorithm=Mn(a.algorithm,r)},Ue.prototype._iterate=function(r,a){return Yr(this._ctx,r,a,this._ctx.table.core)},Ue.prototype.clone=function(r){var a=Object.create(this.constructor.prototype),i=Object.create(this._ctx);return r&&y(i,r),a._ctx=i,a},Ue.prototype.raw=function(){return this._ctx.valueMapper=null,this},Ue.prototype.each=function(r){var a=this._ctx;return this._read(function(i){return Yr(a,r,i,a.table.core)})},Ue.prototype.count=function(r){var a=this;return this._read(function(i){var c=a._ctx,h=c.table.core;if(Un(c,!0))return h.count({trans:i,query:{index:Vr(c,h.schema),range:c.range}}).then(function(v){return Math.min(v,c.limit)});var p=0;return Yr(c,function(){return++p,!1},i,h).then(function(){return p})}).then(r)},Ue.prototype.sortBy=function(r,a){var i=r.split(".").reverse(),c=i[0],h=i.length-1;function p(A,E){return E?p(A[i[E]],E-1):A[c]}var v=this._ctx.dir==="next"?1:-1;function N(A,E){return Ke(p(A,h),p(E,h))*v}return this.toArray(function(A){return A.sort(N)}).then(a)},Ue.prototype.toArray=function(r){var a=this;return this._read(function(i){var c=a._ctx;if(c.dir==="next"&&Un(c,!0)&&0<c.limit){var h=c.valueMapper,p=Vr(c,c.table.core.schema);return c.table.core.query({trans:i,limit:c.limit,values:!0,query:{index:p,range:c.range}}).then(function(N){return N=N.result,h?N.map(h):N})}var v=[];return Yr(c,function(N){return v.push(N)},i,c.table.core).then(function(){return v})},r)},Ue.prototype.offset=function(r){var a=this._ctx;return r<=0||(a.offset+=r,Un(a)?Bs(a,function(){var i=r;return function(c,h){return i===0||(i===1?--i:h(function(){c.advance(i),i=0}),!1)}}):Bs(a,function(){var i=r;return function(){return--i<0}})),this},Ue.prototype.limit=function(r){return this._ctx.limit=Math.min(this._ctx.limit,r),Bs(this._ctx,function(){var a=r;return function(i,c,h){return--a<=0&&c(h),0<=a}},!0),this},Ue.prototype.until=function(r,a){return $s(this._ctx,function(i,c,h){return!r(i.value)||(c(h),a)}),this},Ue.prototype.first=function(r){return this.limit(1).toArray(function(a){return a[0]}).then(r)},Ue.prototype.last=function(r){return this.reverse().first(r)},Ue.prototype.filter=function(r){var a;return $s(this._ctx,function(i){return r(i.value)}),(a=this._ctx).isMatch=Mn(a.isMatch,r),this},Ue.prototype.and=function(r){return this.filter(r)},Ue.prototype.or=function(r){return new this.db.WhereClause(this._ctx.table,r,this)},Ue.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},Ue.prototype.desc=function(){return this.reverse()},Ue.prototype.eachKey=function(r){var a=this._ctx;return a.keysOnly=!a.isMatch,this.each(function(i,c){r(c.key,c)})},Ue.prototype.eachUniqueKey=function(r){return this._ctx.unique="unique",this.eachKey(r)},Ue.prototype.eachPrimaryKey=function(r){var a=this._ctx;return a.keysOnly=!a.isMatch,this.each(function(i,c){r(c.primaryKey,c)})},Ue.prototype.keys=function(r){var a=this._ctx;a.keysOnly=!a.isMatch;var i=[];return this.each(function(c,h){i.push(h.key)}).then(function(){return i}).then(r)},Ue.prototype.primaryKeys=function(r){var a=this._ctx;if(a.dir==="next"&&Un(a,!0)&&0<a.limit)return this._read(function(c){var h=Vr(a,a.table.core.schema);return a.table.core.query({trans:c,values:!1,limit:a.limit,query:{index:h,range:a.range}})}).then(function(c){return c.result}).then(r);a.keysOnly=!a.isMatch;var i=[];return this.each(function(c,h){i.push(h.primaryKey)}).then(function(){return i}).then(r)},Ue.prototype.uniqueKeys=function(r){return this._ctx.unique="unique",this.keys(r)},Ue.prototype.firstKey=function(r){return this.limit(1).keys(function(a){return a[0]}).then(r)},Ue.prototype.lastKey=function(r){return this.reverse().firstKey(r)},Ue.prototype.distinct=function(){var r=this._ctx,r=r.index&&r.table.schema.idxByName[r.index];if(!r||!r.multi)return this;var a={};return $s(this._ctx,function(h){var c=h.primaryKey.toString(),h=b(a,c);return a[c]=!0,!h}),this},Ue.prototype.modify=function(r){var a=this,i=this._ctx;return this._write(function(c){var h=typeof r=="function"?r:function(L){return mo(L,r)},p=i.table.core,E=p.schema.primaryKey,v=E.outbound,N=E.extractKey,A=200,E=a.db._options.modifyChunkSize;E&&(A=typeof E=="object"?E[p.name]||E["*"]||200:E);function R(L,H){var V=H.failures,H=H.numFailures;B+=L-H;for(var Z=0,ae=d(V);Z<ae.length;Z++){var he=ae[Z];S.push(V[he])}}var S=[],B=0,_=[],F=r===xo;return a.clone().primaryKeys().then(function(L){function $(H){var Z=Math.min(A,L.length-H),ae=L.slice(H,H+Z);return(F?Promise.resolve([]):p.getMany({trans:c,keys:ae,cache:"immutable"})).then(function(he){var ve=[],ue=[],pe=v?[]:null,be=F?ae:[];if(!F)for(var ye=0;ye<Z;++ye){var Ne=he[ye],$e={value:oe(Ne),primKey:L[H+ye]};h.call($e,$e.value,$e)!==!1&&($e.value==null?be.push(L[H+ye]):v||Ke(N(Ne),N($e.value))===0?(ue.push($e.value),v&&pe.push(L[H+ye])):(be.push(L[H+ye]),ve.push($e.value)))}return Promise.resolve(0<ve.length&&p.mutate({trans:c,type:"add",values:ve}).then(function(ze){for(var Ye in ze.failures)be.splice(parseInt(Ye),1);R(ve.length,ze)})).then(function(){return(0<ue.length||V&&typeof r=="object")&&p.mutate({trans:c,type:"put",keys:pe,values:ue,criteria:V,changeSpec:typeof r!="function"&&r,isAdditionalChunk:0<H}).then(function(ze){return R(ue.length,ze)})}).then(function(){return(0<be.length||V&&F)&&p.mutate({trans:c,type:"delete",keys:be,criteria:V,isAdditionalChunk:0<H}).then(function(ze){return zr(i.table,be,ze)}).then(function(ze){return R(be.length,ze)})}).then(function(){return L.length>H+Z&&$(H+A)})})}var V=Un(i)&&i.limit===1/0&&(typeof r!="function"||F)&&{index:i.index,range:i.range};return $(0).then(function(){if(0<S.length)throw new de("Error modifying one or more objects",S,B,_);return L.length})})})},Ue.prototype.delete=function(){var r=this._ctx,a=r.range;return!Un(r)||r.table.schema.yProps||!r.isPrimKey&&a.type!==3?this.modify(xo):this._write(function(i){var c=r.table.core.schema.primaryKey,h=a;return r.table.core.count({trans:i,query:{index:c,range:h}}).then(function(p){return r.table.core.mutate({trans:i,type:"deleteRange",range:h}).then(function(A){var N=A.failures,A=A.numFailures;if(A)throw new de("Could not delete some values",Object.keys(N).map(function(E){return N[E]}),p-A);return p-A})})})},Ue);function Ue(){}var xo=function(r,a){return a.value=null};function Gl(r,a){return r<a?-1:r===a?0:1}function Ql(r,a){return a<r?-1:r===a?0:1}function Nt(r,a,i){return r=r instanceof bo?new r.Collection(r):r,r._ctx.error=new(i||TypeError)(a),r}function qn(r){return new r.Collection(r,function(){return vo("")}).limit(0)}function Kr(r,a,i,c){var h,p,v,N,A,E,R,S=i.length;if(!i.every(function(F){return typeof F=="string"}))return Nt(r,io);function B(F){h=F==="next"?function($){return $.toUpperCase()}:function($){return $.toLowerCase()},p=F==="next"?function($){return $.toLowerCase()}:function($){return $.toUpperCase()},v=F==="next"?Gl:Ql;var L=i.map(function($){return{lower:p($),upper:h($)}}).sort(function($,V){return v($.lower,V.lower)});N=L.map(function($){return $.upper}),A=L.map(function($){return $.lower}),R=(E=F)==="next"?"":c}B("next"),r=new r.Collection(r,function(){return sn(N[0],A[S-1]+c)}),r._ondirectionchange=function(F){B(F)};var _=0;return r._addAlgorithm(function(F,L,$){var V=F.key;if(typeof V!="string")return!1;var H=p(V);if(a(H,A,_))return!0;for(var Z=null,ae=_;ae<S;++ae){var he=function(ve,ue,pe,be,ye,Ne){for(var $e=Math.min(ve.length,be.length),ze=-1,Ye=0;Ye<$e;++Ye){var Dt=ue[Ye];if(Dt!==be[Ye])return ye(ve[Ye],pe[Ye])<0?ve.substr(0,Ye)+pe[Ye]+pe.substr(Ye+1):ye(ve[Ye],be[Ye])<0?ve.substr(0,Ye)+be[Ye]+pe.substr(Ye+1):0<=ze?ve.substr(0,ze)+ue[ze]+pe.substr(ze+1):null;ye(ve[Ye],Dt)<0&&(ze=Ye)}return $e<be.length&&Ne==="next"?ve+pe.substr(ve.length):$e<ve.length&&Ne==="prev"?ve.substr(0,pe.length):ze<0?null:ve.substr(0,ze)+be[ze]+pe.substr(ze+1)}(V,H,N[ae],A[ae],v,E);he===null&&Z===null?_=ae+1:(Z===null||0<v(Z,he))&&(Z=he)}return L(Z!==null?function(){F.continue(Z+R)}:$),!1}),r}function sn(r,a,i,c){return{type:2,lower:r,upper:a,lowerOpen:i,upperOpen:c}}function vo(r){return{type:1,lower:r,upper:r}}var bo=(Object.defineProperty(dt.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),dt.prototype.between=function(r,a,i,c){i=i!==!1,c=c===!0;try{return 0<this._cmp(r,a)||this._cmp(r,a)===0&&(i||c)&&(!i||!c)?qn(this):new this.Collection(this,function(){return sn(r,a,!i,!c)})}catch{return Nt(this,Ht)}},dt.prototype.equals=function(r){return r==null?Nt(this,Ht):new this.Collection(this,function(){return vo(r)})},dt.prototype.above=function(r){return r==null?Nt(this,Ht):new this.Collection(this,function(){return sn(r,void 0,!0)})},dt.prototype.aboveOrEqual=function(r){return r==null?Nt(this,Ht):new this.Collection(this,function(){return sn(r,void 0,!1)})},dt.prototype.below=function(r){return r==null?Nt(this,Ht):new this.Collection(this,function(){return sn(void 0,r,!1,!0)})},dt.prototype.belowOrEqual=function(r){return r==null?Nt(this,Ht):new this.Collection(this,function(){return sn(void 0,r)})},dt.prototype.startsWith=function(r){return typeof r!="string"?Nt(this,io):this.between(r,r+Sn,!0,!0)},dt.prototype.startsWithIgnoreCase=function(r){return r===""?this.startsWith(r):Kr(this,function(a,i){return a.indexOf(i[0])===0},[r],Sn)},dt.prototype.equalsIgnoreCase=function(r){return Kr(this,function(a,i){return a===i[0]},[r],"")},dt.prototype.anyOfIgnoreCase=function(){var r=me.apply(ie,arguments);return r.length===0?qn(this):Kr(this,function(a,i){return i.indexOf(a)!==-1},r,"")},dt.prototype.startsWithAnyOfIgnoreCase=function(){var r=me.apply(ie,arguments);return r.length===0?qn(this):Kr(this,function(a,i){return i.some(function(c){return a.indexOf(c)===0})},r,Sn)},dt.prototype.anyOf=function(){var r=this,a=me.apply(ie,arguments),i=this._cmp;try{a.sort(i)}catch{return Nt(this,Ht)}if(a.length===0)return qn(this);var c=new this.Collection(this,function(){return sn(a[0],a[a.length-1])});c._ondirectionchange=function(p){i=p==="next"?r._ascending:r._descending,a.sort(i)};var h=0;return c._addAlgorithm(function(p,v,N){for(var A=p.key;0<i(A,a[h]);)if(++h===a.length)return v(N),!1;return i(A,a[h])===0||(v(function(){p.continue(a[h])}),!1)}),c},dt.prototype.notEqual=function(r){return this.inAnyRange([[-1/0,r],[r,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},dt.prototype.noneOf=function(){var r=me.apply(ie,arguments);if(r.length===0)return new this.Collection(this);try{r.sort(this._ascending)}catch{return Nt(this,Ht)}var a=r.reduce(function(i,c){return i?i.concat([[i[i.length-1][1],c]]):[[-1/0,c]]},null);return a.push([r[r.length-1],this.db._maxKey]),this.inAnyRange(a,{includeLowers:!1,includeUppers:!1})},dt.prototype.inAnyRange=function(V,a){var i=this,c=this._cmp,h=this._ascending,p=this._descending,v=this._min,N=this._max;if(V.length===0)return qn(this);if(!V.every(function(H){return H[0]!==void 0&&H[1]!==void 0&&h(H[0],H[1])<=0}))return Nt(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",ce.InvalidArgument);var A=!a||a.includeLowers!==!1,E=a&&a.includeUppers===!0,R,S=h;function B(H,Z){return S(H[0],Z[0])}try{(R=V.reduce(function(H,Z){for(var ae=0,he=H.length;ae<he;++ae){var ve=H[ae];if(c(Z[0],ve[1])<0&&0<c(Z[1],ve[0])){ve[0]=v(ve[0],Z[0]),ve[1]=N(ve[1],Z[1]);break}}return ae===he&&H.push(Z),H},[])).sort(B)}catch{return Nt(this,Ht)}var _=0,F=E?function(H){return 0<h(H,R[_][1])}:function(H){return 0<=h(H,R[_][1])},L=A?function(H){return 0<p(H,R[_][0])}:function(H){return 0<=p(H,R[_][0])},$=F,V=new this.Collection(this,function(){return sn(R[0][0],R[R.length-1][1],!A,!E)});return V._ondirectionchange=function(H){S=H==="next"?($=F,h):($=L,p),R.sort(B)},V._addAlgorithm(function(H,Z,ae){for(var he,ve=H.key;$(ve);)if(++_===R.length)return Z(ae),!1;return!F(he=ve)&&!L(he)||(i._cmp(ve,R[_][1])===0||i._cmp(ve,R[_][0])===0||Z(function(){S===h?H.continue(R[_][0]):H.continue(R[_][1])}),!1)}),V},dt.prototype.startsWithAnyOf=function(){var r=me.apply(ie,arguments);return r.every(function(a){return typeof a=="string"})?r.length===0?qn(this):this.inAnyRange(r.map(function(a){return[a,a+Sn]})):Nt(this,"startsWithAnyOf() only works with strings")},dt);function dt(){}function Rt(r){return at(function(a){return dr(a),r(a.target.error),!1})}function dr(r){r.stopPropagation&&r.stopPropagation(),r.preventDefault&&r.preventDefault()}var hr="storagemutated",zs="x-storagemutated-1",an=cr(null,hr),Xl=($t.prototype._lock=function(){return O(!Me.global),++this._reculock,this._reculock!==1||Me.global||(Me.lockOwnerFor=this),this},$t.prototype._unlock=function(){if(O(!Me.global),--this._reculock==0)for(Me.global||(Me.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var r=this._blockedFuncs.shift();try{Dn(r[1],r[0])}catch{}}return this},$t.prototype._locked=function(){return this._reculock&&Me.lockOwnerFor!==this},$t.prototype.create=function(r){var a=this;if(!this.mode)return this;var i=this.db.idbdb,c=this.db._state.dbOpenError;if(O(!this.idbtrans),!r&&!i)switch(c&&c.name){case"DatabaseClosedError":throw new ce.DatabaseClosed(c);case"MissingAPIError":throw new ce.MissingAPI(c.message,c);default:throw new ce.OpenFailed(c)}if(!this.active)throw new ce.TransactionInactive;return O(this._completion._state===null),(r=this.idbtrans=r||(this.db.core||i).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=at(function(h){dr(h),a._reject(r.error)}),r.onabort=at(function(h){dr(h),a.active&&a._reject(new ce.Abort(r.error)),a.active=!1,a.on("abort").fire(h)}),r.oncomplete=at(function(){a.active=!1,a._resolve(),"mutatedParts"in r&&an.storagemutated.fire(r.mutatedParts)}),this},$t.prototype._promise=function(r,a,i){var c=this;if(r==="readwrite"&&this.mode!=="readwrite")return it(new ce.ReadOnly("Transaction is readonly"));if(!this.active)return it(new ce.TransactionInactive);if(this._locked())return new ge(function(p,v){c._blockedFuncs.push([function(){c._promise(r,a,i).then(p,v)},Me])});if(i)return tn(function(){var p=new ge(function(v,N){c._lock();var A=a(v,N,c);A&&A.then&&A.then(v,N)});return p.finally(function(){return c._unlock()}),p._lib=!0,p});var h=new ge(function(p,v){var N=a(p,v,c);N&&N.then&&N.then(p,v)});return h._lib=!0,h},$t.prototype._root=function(){return this.parent?this.parent._root():this},$t.prototype.waitFor=function(r){var a,i=this._root(),c=ge.resolve(r);i._waitingFor?i._waitingFor=i._waitingFor.then(function(){return c}):(i._waitingFor=c,i._waitingQueue=[],a=i.idbtrans.objectStore(i.storeNames[0]),function p(){for(++i._spinCount;i._waitingQueue.length;)i._waitingQueue.shift()();i._waitingFor&&(a.get(-1/0).onsuccess=p)}());var h=i._waitingFor;return new ge(function(p,v){c.then(function(N){return i._waitingQueue.push(at(p.bind(null,N)))},function(N){return i._waitingQueue.push(at(v.bind(null,N)))}).finally(function(){i._waitingFor===h&&(i._waitingFor=null)})})},$t.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new ce.Abort))},$t.prototype.table=function(r){var a=this._memoizedTables||(this._memoizedTables={});if(b(a,r))return a[r];var i=this.schema[r];if(!i)throw new ce.NotFound("Table "+r+" not part of transaction");return i=new this.db.Table(r,i,this),i.core=this.db.core.table(r),a[r]=i},$t);function $t(){}function Vs(r,a,i,c,h,p,v,N){return{name:r,keyPath:a,unique:i,multi:c,auto:h,compound:p,src:(i&&!v?"&":"")+(c?"*":"")+(h?"++":"")+wo(a),type:N}}function wo(r){return typeof r=="string"?r:r?"["+[].join.call(r,"+")+"]":""}function Ys(r,a,i){return{name:r,primKey:a,indexes:i,mappedClass:null,idxByName:(c=function(h){return[h.name,h]},i.reduce(function(h,p,v){return v=c(p,v),v&&(h[v[0]]=v[1]),h},{}))};var c}var fr=function(r){try{return r.only([[]]),fr=function(){return[[]]},[[]]}catch{return fr=function(){return Sn},Sn}};function Ks(r){return r==null?function(){}:typeof r=="string"?(a=r).split(".").length===1?function(i){return i[a]}:function(i){return T(i,a)}:function(i){return T(i,r)};var a}function jo(r){return[].slice.call(r)}var Jl=0;function mr(r){return r==null?":id":typeof r=="string"?r:"[".concat(r.join("+"),"]")}function Zl(r,a,A){function c($){if($.type===3)return null;if($.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var _=$.lower,F=$.upper,L=$.lowerOpen,$=$.upperOpen;return _===void 0?F===void 0?null:a.upperBound(F,!!$):F===void 0?a.lowerBound(_,!!L):a.bound(_,F,!!L,!!$)}function h(B){var _,F=B.name;return{name:F,schema:B,mutate:function(L){var $=L.trans,V=L.type,H=L.keys,Z=L.values,ae=L.range;return new Promise(function(he,ve){he=at(he);var ue=$.objectStore(F),pe=ue.keyPath==null,be=V==="put"||V==="add";if(!be&&V!=="delete"&&V!=="deleteRange")throw new Error("Invalid operation type: "+V);var ye,Ne=(H||Z||{length:1}).length;if(H&&Z&&H.length!==Z.length)throw new Error("Given keys array must have same length as given values array.");if(Ne===0)return he({numFailures:0,failures:{},results:[],lastResult:void 0});function $e(wt){++Dt,dr(wt)}var ze=[],Ye=[],Dt=0;if(V==="deleteRange"){if(ae.type===4)return he({numFailures:Dt,failures:Ye,results:[],lastResult:void 0});ae.type===3?ze.push(ye=ue.clear()):ze.push(ye=ue.delete(c(ae)))}else{var pe=be?pe?[Z,H]:[Z,null]:[H,null],Fe=pe[0],yt=pe[1];if(be)for(var xt=0;xt<Ne;++xt)ze.push(ye=yt&&yt[xt]!==void 0?ue[V](Fe[xt],yt[xt]):ue[V](Fe[xt])),ye.onerror=$e;else for(xt=0;xt<Ne;++xt)ze.push(ye=ue[V](Fe[xt])),ye.onerror=$e}function ns(wt){wt=wt.target.result,ze.forEach(function(Pn,la){return Pn.error!=null&&(Ye[la]=Pn.error)}),he({numFailures:Dt,failures:Ye,results:V==="delete"?H:ze.map(function(Pn){return Pn.result}),lastResult:wt})}ye.onerror=function(wt){$e(wt),ns(wt)},ye.onsuccess=ns})},getMany:function(L){var $=L.trans,V=L.keys;return new Promise(function(H,Z){H=at(H);for(var ae,he=$.objectStore(F),ve=V.length,ue=new Array(ve),pe=0,be=0,ye=function(ze){ze=ze.target,ue[ze._pos]=ze.result,++be===pe&&H(ue)},Ne=Rt(Z),$e=0;$e<ve;++$e)V[$e]!=null&&((ae=he.get(V[$e]))._pos=$e,ae.onsuccess=ye,ae.onerror=Ne,++pe);pe===0&&H(ue)})},get:function(L){var $=L.trans,V=L.key;return new Promise(function(H,Z){H=at(H);var ae=$.objectStore(F).get(V);ae.onsuccess=function(he){return H(he.target.result)},ae.onerror=Rt(Z)})},query:(_=E,function(L){return new Promise(function($,V){$=at($);var H,Z,ae,pe=L.trans,he=L.values,ve=L.limit,ye=L.query,ue=ve===1/0?void 0:ve,be=ye.index,ye=ye.range,pe=pe.objectStore(F),be=be.isPrimaryKey?pe:pe.index(be.name),ye=c(ye);if(ve===0)return $({result:[]});_?((ue=he?be.getAll(ye,ue):be.getAllKeys(ye,ue)).onsuccess=function(Ne){return $({result:Ne.target.result})},ue.onerror=Rt(V)):(H=0,Z=!he&&"openKeyCursor"in be?be.openKeyCursor(ye):be.openCursor(ye),ae=[],Z.onsuccess=function(Ne){var $e=Z.result;return $e?(ae.push(he?$e.value:$e.primaryKey),++H===ve?$({result:ae}):void $e.continue()):$({result:ae})},Z.onerror=Rt(V))})}),openCursor:function(L){var $=L.trans,V=L.values,H=L.query,Z=L.reverse,ae=L.unique;return new Promise(function(he,ve){he=at(he);var be=H.index,ue=H.range,pe=$.objectStore(F),pe=be.isPrimaryKey?pe:pe.index(be.name),be=Z?ae?"prevunique":"prev":ae?"nextunique":"next",ye=!V&&"openKeyCursor"in pe?pe.openKeyCursor(c(ue),be):pe.openCursor(c(ue),be);ye.onerror=Rt(ve),ye.onsuccess=at(function(Ne){var $e,ze,Ye,Dt,Fe=ye.result;Fe?(Fe.___id=++Jl,Fe.done=!1,$e=Fe.continue.bind(Fe),ze=(ze=Fe.continuePrimaryKey)&&ze.bind(Fe),Ye=Fe.advance.bind(Fe),Dt=function(){throw new Error("Cursor not stopped")},Fe.trans=$,Fe.stop=Fe.continue=Fe.continuePrimaryKey=Fe.advance=function(){throw new Error("Cursor not started")},Fe.fail=at(ve),Fe.next=function(){var yt=this,xt=1;return this.start(function(){return xt--?yt.continue():yt.stop()}).then(function(){return yt})},Fe.start=function(yt){function xt(){if(ye.result)try{yt()}catch(wt){Fe.fail(wt)}else Fe.done=!0,Fe.start=function(){throw new Error("Cursor behind last entry")},Fe.stop()}var ns=new Promise(function(wt,Pn){wt=at(wt),ye.onerror=Rt(Pn),Fe.fail=Pn,Fe.stop=function(la){Fe.stop=Fe.continue=Fe.continuePrimaryKey=Fe.advance=Dt,wt(la)}});return ye.onsuccess=at(function(wt){ye.onsuccess=xt,xt()}),Fe.continue=$e,Fe.continuePrimaryKey=ze,Fe.advance=Ye,xt(),ns},he(Fe)):he(null)},ve)})},count:function(L){var $=L.query,V=L.trans,H=$.index,Z=$.range;return new Promise(function(ae,he){var ve=V.objectStore(F),ue=H.isPrimaryKey?ve:ve.index(H.name),ve=c(Z),ue=ve?ue.count(ve):ue.count();ue.onsuccess=at(function(pe){return ae(pe.target.result)}),ue.onerror=Rt(he)})}}}var p,v,N,R=(v=A,N=jo((p=r).objectStoreNames),{schema:{name:p.name,tables:N.map(function(B){return v.objectStore(B)}).map(function(B){var _=B.keyPath,$=B.autoIncrement,F=m(_),L={},$={name:B.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:_==null,compound:F,keyPath:_,autoIncrement:$,unique:!0,extractKey:Ks(_)},indexes:jo(B.indexNames).map(function(V){return B.index(V)}).map(function(ae){var H=ae.name,Z=ae.unique,he=ae.multiEntry,ae=ae.keyPath,he={name:H,compound:m(ae),keyPath:ae,unique:Z,multiEntry:he,extractKey:Ks(ae)};return L[mr(ae)]=he}),getIndexByKeyPath:function(V){return L[mr(V)]}};return L[":id"]=$.primaryKey,_!=null&&(L[mr(_)]=$.primaryKey),$})},hasGetAll:0<N.length&&"getAll"in v.objectStore(N[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),A=R.schema,E=R.hasGetAll,R=A.tables.map(h),S={};return R.forEach(function(B){return S[B.name]=B}),{stack:"dbcore",transaction:r.transaction.bind(r),table:function(B){if(!S[B])throw new Error("Table '".concat(B,"' not found"));return S[B]},MIN_KEY:-1/0,MAX_KEY:fr(a),schema:A}}function ec(r,a,i,c){var h=i.IDBKeyRange;return i.indexedDB,{dbcore:(c=Zl(a,h,c),r.dbcore.reduce(function(p,v){return v=v.create,o(o({},p),v(p))},c))}}function Wr(r,c){var i=c.db,c=ec(r._middlewares,i,r._deps,c);r.core=c.dbcore,r.tables.forEach(function(h){var p=h.name;r.core.schema.tables.some(function(v){return v.name===p})&&(h.core=r.core.table(p),r[p]instanceof r.Table&&(r[p].core=h.core))})}function Hr(r,a,i,c){i.forEach(function(h){var p=c[h];a.forEach(function(v){var N=function A(E,R){return k(E,R)||(E=g(E))&&A(E,R)}(v,h);(!N||"value"in N&&N.value===void 0)&&(v===r.Transaction.prototype||v instanceof r.Transaction?j(v,h,{get:function(){return this.table(h)},set:function(A){x(this,h,{value:A,writable:!0,configurable:!0,enumerable:!0})}}):v[h]=new r.Table(h,p))})})}function Ws(r,a){a.forEach(function(i){for(var c in i)i[c]instanceof r.Table&&delete i[c]})}function tc(r,a){return r._cfg.version-a._cfg.version}function nc(r,a,i,c){var h=r._dbSchema;i.objectStoreNames.contains("$meta")&&!h.$meta&&(h.$meta=Ys("$meta",Co("")[0],[]),r._storeNames.push("$meta"));var p=r._createTransaction("readwrite",r._storeNames,h);p.create(i),p._completion.catch(c);var v=p._reject.bind(p),N=Me.transless||Me;tn(function(){return Me.trans=p,Me.transless=N,a!==0?(Wr(r,i),E=a,((A=p).storeNames.includes("$meta")?A.table("$meta").get("version").then(function(R){return R??E}):ge.resolve(E)).then(function(R){return B=R,_=p,F=i,L=[],R=(S=r)._versions,$=S._dbSchema=qr(0,S.idbdb,F),(R=R.filter(function(V){return V._cfg.version>=B})).length!==0?(R.forEach(function(V){L.push(function(){var H=$,Z=V._cfg.dbschema;Gr(S,H,F),Gr(S,Z,F),$=S._dbSchema=Z;var ae=Hs(H,Z);ae.add.forEach(function(be){Us(F,be[0],be[1].primKey,be[1].indexes)}),ae.change.forEach(function(be){if(be.recreate)throw new ce.Upgrade("Not yet support for changing primary key");var ye=F.objectStore(be.name);be.add.forEach(function(Ne){return Ur(ye,Ne)}),be.change.forEach(function(Ne){ye.deleteIndex(Ne.name),Ur(ye,Ne)}),be.del.forEach(function(Ne){return ye.deleteIndex(Ne)})});var he=V._cfg.contentUpgrade;if(he&&V._cfg.version>B){Wr(S,F),_._memoizedTables={};var ve=U(Z);ae.del.forEach(function(be){ve[be]=H[be]}),Ws(S,[S.Transaction.prototype]),Hr(S,[S.Transaction.prototype],d(ve),ve),_.schema=ve;var ue,pe=ke(he);return pe&&Wn(),ae=ge.follow(function(){var be;(ue=he(_))&&pe&&(be=nn.bind(null,null),ue.then(be,be))}),ue&&typeof ue.then=="function"?ge.resolve(ue):ae.then(function(){return ue})}}),L.push(function(H){var Z,ae,he=V._cfg.dbschema;Z=he,ae=H,[].slice.call(ae.db.objectStoreNames).forEach(function(ve){return Z[ve]==null&&ae.db.deleteObjectStore(ve)}),Ws(S,[S.Transaction.prototype]),Hr(S,[S.Transaction.prototype],S._storeNames,S._dbSchema),_.schema=S._dbSchema}),L.push(function(H){S.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(S.idbdb.version/10)===V._cfg.version?(S.idbdb.deleteObjectStore("$meta"),delete S._dbSchema.$meta,S._storeNames=S._storeNames.filter(function(Z){return Z!=="$meta"})):H.objectStore("$meta").put(V._cfg.version,"version"))})}),function V(){return L.length?ge.resolve(L.shift()(_.idbtrans)).then(V):ge.resolve()}().then(function(){ko($,F)})):ge.resolve();var S,B,_,F,L,$}).catch(v)):(d(h).forEach(function(R){Us(i,R,h[R].primKey,h[R].indexes)}),Wr(r,i),void ge.follow(function(){return r.on.populate.fire(p)}).catch(v));var A,E})}function rc(r,a){ko(r._dbSchema,a),a.db.version%10!=0||a.objectStoreNames.contains("$meta")||a.db.createObjectStore("$meta").add(Math.ceil(a.db.version/10-1),"version");var i=qr(0,r.idbdb,a);Gr(r,r._dbSchema,a);for(var c=0,h=Hs(i,r._dbSchema).change;c<h.length;c++){var p=function(v){if(v.change.length||v.recreate)return console.warn("Unable to patch indexes of table ".concat(v.name," because it has changes on the type of index or primary key.")),{value:void 0};var N=a.objectStore(v.name);v.add.forEach(function(A){Re&&console.debug("Dexie upgrade patch: Creating missing index ".concat(v.name,".").concat(A.src)),Ur(N,A)})}(h[c]);if(typeof p=="object")return p.value}}function Hs(r,a){var i,c={del:[],add:[],change:[]};for(i in r)a[i]||c.del.push(i);for(i in a){var h=r[i],p=a[i];if(h){var v={name:i,def:p,recreate:!1,del:[],add:[],change:[]};if(""+(h.primKey.keyPath||"")!=""+(p.primKey.keyPath||"")||h.primKey.auto!==p.primKey.auto)v.recreate=!0,c.change.push(v);else{var N=h.idxByName,A=p.idxByName,E=void 0;for(E in N)A[E]||v.del.push(E);for(E in A){var R=N[E],S=A[E];R?R.src!==S.src&&v.change.push(S):v.add.push(S)}(0<v.del.length||0<v.add.length||0<v.change.length)&&c.change.push(v)}}else c.add.push([i,p])}return c}function Us(r,a,i,c){var h=r.db.createObjectStore(a,i.keyPath?{keyPath:i.keyPath,autoIncrement:i.auto}:{autoIncrement:i.auto});return c.forEach(function(p){return Ur(h,p)}),h}function ko(r,a){d(r).forEach(function(i){a.db.objectStoreNames.contains(i)||(Re&&console.debug("Dexie: Creating missing table",i),Us(a,i,r[i].primKey,r[i].indexes))})}function Ur(r,a){r.createIndex(a.name,a.keyPath,{unique:a.unique,multiEntry:a.multi})}function qr(r,a,i){var c={};return D(a.objectStoreNames,0).forEach(function(h){for(var p=i.objectStore(h),v=Vs(wo(E=p.keyPath),E||"",!0,!1,!!p.autoIncrement,E&&typeof E!="string",!0),N=[],A=0;A<p.indexNames.length;++A){var R=p.index(p.indexNames[A]),E=R.keyPath,R=Vs(R.name,E,!!R.unique,!!R.multiEntry,!1,E&&typeof E!="string",!1);N.push(R)}c[h]=Ys(h,v,N)}),c}function Gr(r,a,i){for(var c=i.db.objectStoreNames,h=0;h<c.length;++h){var p=c[h],v=i.objectStore(p);r._hasGetAll="getAll"in v;for(var N=0;N<v.indexNames.length;++N){var A=v.indexNames[N],E=v.index(A).keyPath,R=typeof E=="string"?E:"["+D(E).join("+")+"]";!a[p]||(E=a[p].idxByName[R])&&(E.name=A,delete a[p].idxByName[R],a[p].idxByName[A]=E)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&u.WorkerGlobalScope&&u instanceof u.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(r._hasGetAll=!1)}function Co(r){return r.split(",").map(function(a,i){var p=a.split(":"),c=(h=p[1])===null||h===void 0?void 0:h.trim(),h=(a=p[0].trim()).replace(/([&*]|\+\+)/g,""),p=/^\[/.test(h)?h.match(/^\[(.*)\]$/)[1].split("+"):h;return Vs(h,p||null,/\&/.test(a),/\*/.test(a),/\+\+/.test(a),m(p),i===0,c)})}var sc=(Gn.prototype._createTableSchema=Ys,Gn.prototype._parseIndexSyntax=Co,Gn.prototype._parseStoresSpec=function(r,a){var i=this;d(r).forEach(function(c){if(r[c]!==null){var h=i._parseIndexSyntax(r[c]),p=h.shift();if(!p)throw new ce.Schema("Invalid schema for table "+c+": "+r[c]);if(p.unique=!0,p.multi)throw new ce.Schema("Primary key cannot be multiEntry*");h.forEach(function(v){if(v.auto)throw new ce.Schema("Only primary key can be marked as autoIncrement (++)");if(!v.keyPath)throw new ce.Schema("Index must have a name and cannot be an empty string")}),h=i._createTableSchema(c,p,h),a[c]=h}})},Gn.prototype.stores=function(i){var a=this.db;this._cfg.storesSource=this._cfg.storesSource?y(this._cfg.storesSource,i):i;var i=a._versions,c={},h={};return i.forEach(function(p){y(c,p._cfg.storesSource),h=p._cfg.dbschema={},p._parseStoresSpec(c,h)}),a._dbSchema=h,Ws(a,[a._allTables,a,a.Transaction.prototype]),Hr(a,[a._allTables,a,a.Transaction.prototype,this._cfg.tables],d(h),h),a._storeNames=d(h),this},Gn.prototype.upgrade=function(r){return this._cfg.contentUpgrade=Ee(this._cfg.contentUpgrade||se,r),this},Gn);function Gn(){}function qs(r,a){var i=r._dbNamesDB;return i||(i=r._dbNamesDB=new Ut($r,{addons:[],indexedDB:r,IDBKeyRange:a})).version(1).stores({dbnames:"name"}),i.table("dbnames")}function Gs(r){return r&&typeof r.databases=="function"}function Qs(r){return tn(function(){return Me.letThrough=!0,r()})}function Xs(r){return!("from"in r)}var gt=function(r,a){if(!this){var i=new gt;return r&&"d"in r&&y(i,r),i}y(this,arguments.length?{d:1,from:r,to:1<arguments.length?a:r}:{d:0})};function pr(r,a,i){var c=Ke(a,i);if(!isNaN(c)){if(0<c)throw RangeError();if(Xs(r))return y(r,{from:a,to:i,d:1});var h=r.l,c=r.r;if(Ke(i,r.from)<0)return h?pr(h,a,i):r.l={from:a,to:i,d:1,l:null,r:null},Do(r);if(0<Ke(a,r.to))return c?pr(c,a,i):r.r={from:a,to:i,d:1,l:null,r:null},Do(r);Ke(a,r.from)<0&&(r.from=a,r.l=null,r.d=c?c.d+1:1),0<Ke(i,r.to)&&(r.to=i,r.r=null,r.d=r.l?r.l.d+1:1),i=!r.r,h&&!r.l&&gr(r,h),c&&i&&gr(r,c)}}function gr(r,a){Xs(a)||function i(c,A){var p=A.from,v=A.to,N=A.l,A=A.r;pr(c,p,v),N&&i(c,N),A&&i(c,A)}(r,a)}function No(r,a){var i=Qr(a),c=i.next();if(c.done)return!1;for(var h=c.value,p=Qr(r),v=p.next(h.from),N=v.value;!c.done&&!v.done;){if(Ke(N.from,h.to)<=0&&0<=Ke(N.to,h.from))return!0;Ke(h.from,N.from)<0?h=(c=i.next(N.from)).value:N=(v=p.next(h.from)).value}return!1}function Qr(r){var a=Xs(r)?null:{s:0,n:r};return{next:function(i){for(var c=0<arguments.length;a;)switch(a.s){case 0:if(a.s=1,c)for(;a.n.l&&Ke(i,a.n.from)<0;)a={up:a,n:a.n.l,s:1};else for(;a.n.l;)a={up:a,n:a.n.l,s:1};case 1:if(a.s=2,!c||Ke(i,a.n.to)<=0)return{value:a.n,done:!1};case 2:if(a.n.r){a.s=3,a={up:a,n:a.n.r,s:0};continue}case 3:a=a.up}return{done:!0}}}}function Do(r){var a,i,c=(((a=r.r)===null||a===void 0?void 0:a.d)||0)-(((i=r.l)===null||i===void 0?void 0:i.d)||0),h=1<c?"r":c<-1?"l":"";h&&(a=h=="r"?"l":"r",i=o({},r),c=r[h],r.from=c.from,r.to=c.to,r[h]=c[h],i[h]=c[a],(r[a]=i).d=So(i)),r.d=So(r)}function So(i){var a=i.r,i=i.l;return(a?i?Math.max(a.d,i.d):a.d:i?i.d:0)+1}function Xr(r,a){return d(a).forEach(function(i){r[i]?gr(r[i],a[i]):r[i]=function c(h){var p,v,N={};for(p in h)b(h,p)&&(v=h[p],N[p]=!v||typeof v!="object"||ne.has(v.constructor)?v:c(v));return N}(a[i])}),r}function Js(r,a){return r.all||a.all||Object.keys(r).some(function(i){return a[i]&&No(a[i],r[i])})}C(gt.prototype,((Pt={add:function(r){return gr(this,r),this},addKey:function(r){return pr(this,r,r),this},addKeys:function(r){var a=this;return r.forEach(function(i){return pr(a,i,i)}),this},hasKey:function(r){var a=Qr(this).next(r).value;return a&&Ke(a.from,r)<=0&&0<=Ke(a.to,r)}})[K]=function(){return Qr(this)},Pt));var Tn={},Zs={},ea=!1;function Jr(r){Xr(Zs,r),ea||(ea=!0,setTimeout(function(){ea=!1,ta(Zs,!(Zs={}))},0))}function ta(r,a){a===void 0&&(a=!1);var i=new Set;if(r.all)for(var c=0,h=Object.values(Tn);c<h.length;c++)Mo(v=h[c],r,i,a);else for(var p in r){var v,N=/^idb\:\/\/(.*)\/(.*)\//.exec(p);N&&(p=N[1],N=N[2],(v=Tn["idb://".concat(p,"/").concat(N)])&&Mo(v,r,i,a))}i.forEach(function(A){return A()})}function Mo(r,a,i,c){for(var h=[],p=0,v=Object.entries(r.queries.query);p<v.length;p++){for(var N=v[p],A=N[0],E=[],R=0,S=N[1];R<S.length;R++){var B=S[R];Js(a,B.obsSet)?B.subscribers.forEach(function($){return i.add($)}):c&&E.push(B)}c&&h.push([A,E])}if(c)for(var _=0,F=h;_<F.length;_++){var L=F[_],A=L[0],E=L[1];r.queries.query[A]=E}}function ac(r){var a=r._state,i=r._deps.indexedDB;if(a.isBeingOpened||r.idbdb)return a.dbReadyPromise.then(function(){return a.dbOpenError?it(a.dbOpenError):r});a.isBeingOpened=!0,a.dbOpenError=null,a.openComplete=!1;var c=a.openCanceller,h=Math.round(10*r.verno),p=!1;function v(){if(a.openCanceller!==c)throw new ce.DatabaseClosed("db.open() was cancelled")}function N(){return new ge(function(B,_){if(v(),!i)throw new ce.MissingAPI;var F=r.name,L=a.autoSchema||!h?i.open(F):i.open(F,h);if(!L)throw new ce.MissingAPI;L.onerror=Rt(_),L.onblocked=at(r._fireOnBlocked),L.onupgradeneeded=at(function($){var V;R=L.transaction,a.autoSchema&&!r._options.allowEmptyDB?(L.onerror=dr,R.abort(),L.result.close(),(V=i.deleteDatabase(F)).onsuccess=V.onerror=at(function(){_(new ce.NoSuchDatabase("Database ".concat(F," doesnt exist")))})):(R.onerror=Rt(_),$=$.oldVersion>Math.pow(2,62)?0:$.oldVersion,S=$<1,r.idbdb=L.result,p&&rc(r,R),nc(r,$/10,R,_))},_),L.onsuccess=at(function(){R=null;var $,V,H,Z,ae,he=r.idbdb=L.result,ve=D(he.objectStoreNames);if(0<ve.length)try{var ue=he.transaction((Z=ve).length===1?Z[0]:Z,"readonly");if(a.autoSchema)V=he,H=ue,($=r).verno=V.version/10,H=$._dbSchema=qr(0,V,H),$._storeNames=D(V.objectStoreNames,0),Hr($,[$._allTables],d(H),H);else if(Gr(r,r._dbSchema,ue),((ae=Hs(qr(0,(ae=r).idbdb,ue),ae._dbSchema)).add.length||ae.change.some(function(pe){return pe.add.length||pe.change.length}))&&!p)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),he.close(),h=he.version+1,p=!0,B(N());Wr(r,ue)}catch{}Hn.push(r),he.onversionchange=at(function(pe){a.vcFired=!0,r.on("versionchange").fire(pe)}),he.onclose=at(function(){r.close({disableAutoOpen:!1})}),S&&(ae=r._deps,ue=F,he=ae.indexedDB,ae=ae.IDBKeyRange,Gs(he)||ue===$r||qs(he,ae).put({name:ue}).catch(se)),B()},_)}).catch(function(B){switch(B==null?void 0:B.name){case"UnknownError":if(0<a.PR1398_maxLoop)return a.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),N();break;case"VersionError":if(0<h)return h=0,N()}return ge.reject(B)})}var A,E=a.dbReadyResolve,R=null,S=!1;return ge.race([c,(typeof navigator>"u"?ge.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(B){function _(){return indexedDB.databases().finally(B)}A=setInterval(_,100),_()}).finally(function(){return clearInterval(A)}):Promise.resolve()).then(N)]).then(function(){return v(),a.onReadyBeingFired=[],ge.resolve(Qs(function(){return r.on.ready.fire(r.vip)})).then(function B(){if(0<a.onReadyBeingFired.length){var _=a.onReadyBeingFired.reduce(Ee,se);return a.onReadyBeingFired=[],ge.resolve(Qs(function(){return _(r.vip)})).then(B)}})}).finally(function(){a.openCanceller===c&&(a.onReadyBeingFired=null,a.isBeingOpened=!1)}).catch(function(B){a.dbOpenError=B;try{R&&R.abort()}catch{}return c===a.openCanceller&&r._close(),it(B)}).finally(function(){a.openComplete=!0,E()}).then(function(){var B;return S&&(B={},r.tables.forEach(function(_){_.schema.indexes.forEach(function(F){F.name&&(B["idb://".concat(r.name,"/").concat(_.name,"/").concat(F.name)]=new gt(-1/0,[[[]]]))}),B["idb://".concat(r.name,"/").concat(_.name,"/")]=B["idb://".concat(r.name,"/").concat(_.name,"/:dels")]=new gt(-1/0,[[[]]])}),an(hr).fire(B),ta(B,!0)),r})}function na(r){function a(p){return r.next(p)}var i=h(a),c=h(function(p){return r.throw(p)});function h(p){return function(A){var N=p(A),A=N.value;return N.done?A:A&&typeof A.then=="function"?A.then(i,c):m(A)?Promise.all(A).then(i,c):i(A)}}return h(a)()}function Zr(r,a,i){for(var c=m(r)?r.slice():[r],h=0;h<i;++h)c.push(a);return c}var oc={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(r){return o(o({},r),{table:function(a){var i=r.table(a),c=i.schema,h={},p=[];function v(S,B,_){var F=mr(S),L=h[F]=h[F]||[],$=S==null?0:typeof S=="string"?1:S.length,V=0<B,V=o(o({},_),{name:V?"".concat(F,"(virtual-from:").concat(_.name,")"):_.name,lowLevelIndex:_,isVirtual:V,keyTail:B,keyLength:$,extractKey:Ks(S),unique:!V&&_.unique});return L.push(V),V.isPrimaryKey||p.push(V),1<$&&v($===2?S[0]:S.slice(0,$-1),B+1,_),L.sort(function(H,Z){return H.keyTail-Z.keyTail}),V}a=v(c.primaryKey.keyPath,0,c.primaryKey),h[":id"]=[a];for(var N=0,A=c.indexes;N<A.length;N++){var E=A[N];v(E.keyPath,0,E)}function R(S){var B,_=S.query.index;return _.isVirtual?o(o({},S),{query:{index:_.lowLevelIndex,range:(B=S.query.range,_=_.keyTail,{type:B.type===1?2:B.type,lower:Zr(B.lower,B.lowerOpen?r.MAX_KEY:r.MIN_KEY,_),lowerOpen:!0,upper:Zr(B.upper,B.upperOpen?r.MIN_KEY:r.MAX_KEY,_),upperOpen:!0})}}):S}return o(o({},i),{schema:o(o({},c),{primaryKey:a,indexes:p,getIndexByKeyPath:function(S){return(S=h[mr(S)])&&S[0]}}),count:function(S){return i.count(R(S))},query:function(S){return i.query(R(S))},openCursor:function(S){var B=S.query.index,_=B.keyTail,F=B.isVirtual,L=B.keyLength;return F?i.openCursor(R(S)).then(function(V){return V&&$(V)}):i.openCursor(S);function $(V){return Object.create(V,{continue:{value:function(H){H!=null?V.continue(Zr(H,S.reverse?r.MAX_KEY:r.MIN_KEY,_)):S.unique?V.continue(V.key.slice(0,L).concat(S.reverse?r.MIN_KEY:r.MAX_KEY,_)):V.continue()}},continuePrimaryKey:{value:function(H,Z){V.continuePrimaryKey(Zr(H,r.MAX_KEY,_),Z)}},primaryKey:{get:function(){return V.primaryKey}},key:{get:function(){var H=V.key;return L===1?H[0]:H.slice(0,L)}},value:{get:function(){return V.value}}})}}})}})}};function ra(r,a,i,c){return i=i||{},c=c||"",d(r).forEach(function(h){var p,v,N;b(a,h)?(p=r[h],v=a[h],typeof p=="object"&&typeof v=="object"&&p&&v?(N=z(p))!==z(v)?i[c+h]=a[h]:N==="Object"?ra(p,v,i,c+h+"."):p!==v&&(i[c+h]=a[h]):p!==v&&(i[c+h]=a[h])):i[c+h]=void 0}),d(a).forEach(function(h){b(r,h)||(i[c+h]=a[h])}),i}function sa(r,a){return a.type==="delete"?a.keys:a.keys||a.values.map(r.extractKey)}var ic={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(r){return o(o({},r),{table:function(a){var i=r.table(a),c=i.schema.primaryKey;return o(o({},i),{mutate:function(h){var p=Me.trans,v=p.table(a).hook,N=v.deleting,A=v.creating,E=v.updating;switch(h.type){case"add":if(A.fire===se)break;return p._promise("readwrite",function(){return R(h)},!0);case"put":if(A.fire===se&&E.fire===se)break;return p._promise("readwrite",function(){return R(h)},!0);case"delete":if(N.fire===se)break;return p._promise("readwrite",function(){return R(h)},!0);case"deleteRange":if(N.fire===se)break;return p._promise("readwrite",function(){return function S(B,_,F){return i.query({trans:B,values:!1,query:{index:c,range:_},limit:F}).then(function(L){var $=L.result;return R({type:"delete",keys:$,trans:B}).then(function(V){return 0<V.numFailures?Promise.reject(V.failures[0]):$.length<F?{failures:[],numFailures:0,lastResult:void 0}:S(B,o(o({},_),{lower:$[$.length-1],lowerOpen:!0}),F)})})}(h.trans,h.range,1e4)},!0)}return i.mutate(h);function R(S){var B,_,F,L=Me.trans,$=S.keys||sa(c,S);if(!$)throw new Error("Keys missing");return(S=S.type==="add"||S.type==="put"?o(o({},S),{keys:$}):o({},S)).type!=="delete"&&(S.values=l([],S.values)),S.keys&&(S.keys=l([],S.keys)),B=i,F=$,((_=S).type==="add"?Promise.resolve([]):B.getMany({trans:_.trans,keys:F,cache:"immutable"})).then(function(V){var H=$.map(function(Z,ae){var he,ve,ue,pe=V[ae],be={onerror:null,onsuccess:null};return S.type==="delete"?N.fire.call(be,Z,pe,L):S.type==="add"||pe===void 0?(he=A.fire.call(be,Z,S.values[ae],L),Z==null&&he!=null&&(S.keys[ae]=Z=he,c.outbound||P(S.values[ae],c.keyPath,Z))):(he=ra(pe,S.values[ae]),(ve=E.fire.call(be,he,Z,pe,L))&&(ue=S.values[ae],Object.keys(ve).forEach(function(ye){b(ue,ye)?ue[ye]=ve[ye]:P(ue,ye,ve[ye])}))),be});return i.mutate(S).then(function(Z){for(var ae=Z.failures,he=Z.results,ve=Z.numFailures,Z=Z.lastResult,ue=0;ue<$.length;++ue){var pe=(he||$)[ue],be=H[ue];pe==null?be.onerror&&be.onerror(ae[ue]):be.onsuccess&&be.onsuccess(S.type==="put"&&V[ue]?S.values[ue]:pe)}return{failures:ae,results:he,numFailures:ve,lastResult:Z}}).catch(function(Z){return H.forEach(function(ae){return ae.onerror&&ae.onerror(Z)}),Promise.reject(Z)})})}}})}})}};function To(r,a,i){try{if(!a||a.keys.length<r.length)return null;for(var c=[],h=0,p=0;h<a.keys.length&&p<r.length;++h)Ke(a.keys[h],r[p])===0&&(c.push(i?oe(a.values[h]):a.values[h]),++p);return c.length===r.length?c:null}catch{return null}}var lc={stack:"dbcore",level:-1,create:function(r){return{table:function(a){var i=r.table(a);return o(o({},i),{getMany:function(c){if(!c.cache)return i.getMany(c);var h=To(c.keys,c.trans._cache,c.cache==="clone");return h?ge.resolve(h):i.getMany(c).then(function(p){return c.trans._cache={keys:c.keys,values:c.cache==="clone"?oe(p):p},p})},mutate:function(c){return c.type!=="add"&&(c.trans._cache=null),i.mutate(c)}})}}}};function Ao(r,a){return r.trans.mode==="readonly"&&!!r.subscr&&!r.trans.explicit&&r.trans.db._options.cache!=="disabled"&&!a.schema.primaryKey.outbound}function Po(r,a){switch(r){case"query":return a.values&&!a.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var cc={stack:"dbcore",level:0,name:"Observability",create:function(r){var a=r.schema.name,i=new gt(r.MIN_KEY,r.MAX_KEY);return o(o({},r),{transaction:function(c,h,p){if(Me.subscr&&h!=="readonly")throw new ce.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(Me.querier));return r.transaction(c,h,p)},table:function(c){var h=r.table(c),p=h.schema,v=p.primaryKey,S=p.indexes,N=v.extractKey,A=v.outbound,E=v.autoIncrement&&S.filter(function(_){return _.compound&&_.keyPath.includes(v.keyPath)}),R=o(o({},h),{mutate:function(_){function F(ye){return ye="idb://".concat(a,"/").concat(c,"/").concat(ye),Z[ye]||(Z[ye]=new gt)}var L,$,V,H=_.trans,Z=_.mutatedParts||(_.mutatedParts={}),ae=F(""),he=F(":dels"),ve=_.type,be=_.type==="deleteRange"?[_.range]:_.type==="delete"?[_.keys]:_.values.length<50?[sa(v,_).filter(function(ye){return ye}),_.values]:[],ue=be[0],pe=be[1],be=_.trans._cache;return m(ue)?(ae.addKeys(ue),(be=ve==="delete"||ue.length===pe.length?To(ue,be):null)||he.addKeys(ue),(be||pe)&&(L=F,$=be,V=pe,p.indexes.forEach(function(ye){var Ne=L(ye.name||"");function $e(Ye){return Ye!=null?ye.extractKey(Ye):null}function ze(Ye){return ye.multiEntry&&m(Ye)?Ye.forEach(function(Dt){return Ne.addKey(Dt)}):Ne.addKey(Ye)}($||V).forEach(function(Ye,yt){var Fe=$&&$e($[yt]),yt=V&&$e(V[yt]);Ke(Fe,yt)!==0&&(Fe!=null&&ze(Fe),yt!=null&&ze(yt))})}))):ue?(pe={from:(pe=ue.lower)!==null&&pe!==void 0?pe:r.MIN_KEY,to:(pe=ue.upper)!==null&&pe!==void 0?pe:r.MAX_KEY},he.add(pe),ae.add(pe)):(ae.add(i),he.add(i),p.indexes.forEach(function(ye){return F(ye.name).add(i)})),h.mutate(_).then(function(ye){return!ue||_.type!=="add"&&_.type!=="put"||(ae.addKeys(ye.results),E&&E.forEach(function(Ne){for(var $e=_.values.map(function(Fe){return Ne.extractKey(Fe)}),ze=Ne.keyPath.findIndex(function(Fe){return Fe===v.keyPath}),Ye=0,Dt=ye.results.length;Ye<Dt;++Ye)$e[Ye][ze]=ye.results[Ye];F(Ne.name).addKeys($e)})),H.mutatedParts=Xr(H.mutatedParts||{},Z),ye})}}),S=function(F){var L=F.query,F=L.index,L=L.range;return[F,new gt((F=L.lower)!==null&&F!==void 0?F:r.MIN_KEY,(L=L.upper)!==null&&L!==void 0?L:r.MAX_KEY)]},B={get:function(_){return[v,new gt(_.key)]},getMany:function(_){return[v,new gt().addKeys(_.keys)]},count:S,query:S,openCursor:S};return d(B).forEach(function(_){R[_]=function(F){var L=Me.subscr,$=!!L,V=Ao(Me,h)&&Po(_,F)?F.obsSet={}:L;if($){var H=function(pe){return pe="idb://".concat(a,"/").concat(c,"/").concat(pe),V[pe]||(V[pe]=new gt)},Z=H(""),ae=H(":dels"),L=B[_](F),$=L[0],L=L[1];if((_==="query"&&$.isPrimaryKey&&!F.values?ae:H($.name||"")).add(L),!$.isPrimaryKey){if(_!=="count"){var he=_==="query"&&A&&F.values&&h.query(o(o({},F),{values:!1}));return h[_].apply(this,arguments).then(function(pe){if(_==="query"){if(A&&F.values)return he.then(function($e){return $e=$e.result,Z.addKeys($e),pe});var be=F.values?pe.result.map(N):pe.result;(F.values?Z:ae).addKeys(be)}else if(_==="openCursor"){var ye=pe,Ne=F.values;return ye&&Object.create(ye,{key:{get:function(){return ae.addKey(ye.primaryKey),ye.key}},primaryKey:{get:function(){var $e=ye.primaryKey;return ae.addKey($e),$e}},value:{get:function(){return Ne&&Z.addKey(ye.primaryKey),ye.value}}})}return pe})}ae.add(i)}}return h[_].apply(this,arguments)}}),R}})}};function Oo(r,a,i){if(i.numFailures===0)return a;if(a.type==="deleteRange")return null;var c=a.keys?a.keys.length:"values"in a&&a.values?a.values.length:1;return i.numFailures===c?null:(a=o({},a),m(a.keys)&&(a.keys=a.keys.filter(function(h,p){return!(p in i.failures)})),"values"in a&&m(a.values)&&(a.values=a.values.filter(function(h,p){return!(p in i.failures)})),a)}function aa(r,a){return i=r,((c=a).lower===void 0||(c.lowerOpen?0<Ke(i,c.lower):0<=Ke(i,c.lower)))&&(r=r,(a=a).upper===void 0||(a.upperOpen?Ke(r,a.upper)<0:Ke(r,a.upper)<=0));var i,c}function Eo(r,a,B,c,h,p){if(!B||B.length===0)return r;var v=a.query.index,N=v.multiEntry,A=a.query.range,E=c.schema.primaryKey.extractKey,R=v.extractKey,S=(v.lowLevelIndex||v).extractKey,B=B.reduce(function(_,F){var L=_,$=[];if(F.type==="add"||F.type==="put")for(var V=new gt,H=F.values.length-1;0<=H;--H){var Z,ae=F.values[H],he=E(ae);V.hasKey(he)||(Z=R(ae),(N&&m(Z)?Z.some(function(ye){return aa(ye,A)}):aa(Z,A))&&(V.addKey(he),$.push(ae)))}switch(F.type){case"add":var ve=new gt().addKeys(a.values?_.map(function(Ne){return E(Ne)}):_),L=_.concat(a.values?$.filter(function(Ne){return Ne=E(Ne),!ve.hasKey(Ne)&&(ve.addKey(Ne),!0)}):$.map(function(Ne){return E(Ne)}).filter(function(Ne){return!ve.hasKey(Ne)&&(ve.addKey(Ne),!0)}));break;case"put":var ue=new gt().addKeys(F.values.map(function(Ne){return E(Ne)}));L=_.filter(function(Ne){return!ue.hasKey(a.values?E(Ne):Ne)}).concat(a.values?$:$.map(function(Ne){return E(Ne)}));break;case"delete":var pe=new gt().addKeys(F.keys);L=_.filter(function(Ne){return!pe.hasKey(a.values?E(Ne):Ne)});break;case"deleteRange":var be=F.range;L=_.filter(function(Ne){return!aa(E(Ne),be)})}return L},r);return B===r?r:(B.sort(function(_,F){return Ke(S(_),S(F))||Ke(E(_),E(F))}),a.limit&&a.limit<1/0&&(B.length>a.limit?B.length=a.limit:r.length===a.limit&&B.length<a.limit&&(h.dirty=!0)),p?Object.freeze(B):B)}function _o(r,a){return Ke(r.lower,a.lower)===0&&Ke(r.upper,a.upper)===0&&!!r.lowerOpen==!!a.lowerOpen&&!!r.upperOpen==!!a.upperOpen}function uc(r,a){return function(i,c,h,p){if(i===void 0)return c!==void 0?-1:0;if(c===void 0)return 1;if((c=Ke(i,c))===0){if(h&&p)return 0;if(h)return 1;if(p)return-1}return c}(r.lower,a.lower,r.lowerOpen,a.lowerOpen)<=0&&0<=function(i,c,h,p){if(i===void 0)return c!==void 0?1:0;if(c===void 0)return-1;if((c=Ke(i,c))===0){if(h&&p)return 0;if(h)return-1;if(p)return 1}return c}(r.upper,a.upper,r.upperOpen,a.upperOpen)}function dc(r,a,i,c){r.subscribers.add(i),c.addEventListener("abort",function(){var h,p;r.subscribers.delete(i),r.subscribers.size===0&&(h=r,p=a,setTimeout(function(){h.subscribers.size===0&&ee(p,h)},3e3))})}var hc={stack:"dbcore",level:0,name:"Cache",create:function(r){var a=r.schema.name;return o(o({},r),{transaction:function(i,c,h){var p,v,N=r.transaction(i,c,h);return c==="readwrite"&&(v=(p=new AbortController).signal,h=function(A){return function(){if(p.abort(),c==="readwrite"){for(var E=new Set,R=0,S=i;R<S.length;R++){var B=S[R],_=Tn["idb://".concat(a,"/").concat(B)];if(_){var F=r.table(B),L=_.optimisticOps.filter(function(Ne){return Ne.trans===N});if(N._explicit&&A&&N.mutatedParts)for(var $=0,V=Object.values(_.queries.query);$<V.length;$++)for(var H=0,Z=(ve=V[$]).slice();H<Z.length;H++)Js((ue=Z[H]).obsSet,N.mutatedParts)&&(ee(ve,ue),ue.subscribers.forEach(function(Ne){return E.add(Ne)}));else if(0<L.length){_.optimisticOps=_.optimisticOps.filter(function(Ne){return Ne.trans!==N});for(var ae=0,he=Object.values(_.queries.query);ae<he.length;ae++)for(var ve,ue,pe,be=0,ye=(ve=he[ae]).slice();be<ye.length;be++)(ue=ye[be]).res!=null&&N.mutatedParts&&(A&&!ue.dirty?(pe=Object.isFrozen(ue.res),pe=Eo(ue.res,ue.req,L,F,ue,pe),ue.dirty?(ee(ve,ue),ue.subscribers.forEach(function(Ne){return E.add(Ne)})):pe!==ue.res&&(ue.res=pe,ue.promise=ge.resolve({result:pe}))):(ue.dirty&&ee(ve,ue),ue.subscribers.forEach(function(Ne){return E.add(Ne)})))}}}E.forEach(function(Ne){return Ne()})}}},N.addEventListener("abort",h(!1),{signal:v}),N.addEventListener("error",h(!1),{signal:v}),N.addEventListener("complete",h(!0),{signal:v})),N},table:function(i){var c=r.table(i),h=c.schema.primaryKey;return o(o({},c),{mutate:function(p){var v=Me.trans;if(h.outbound||v.db._options.cache==="disabled"||v.explicit||v.idbtrans.mode!=="readwrite")return c.mutate(p);var N=Tn["idb://".concat(a,"/").concat(i)];return N?(v=c.mutate(p),p.type!=="add"&&p.type!=="put"||!(50<=p.values.length||sa(h,p).some(function(A){return A==null}))?(N.optimisticOps.push(p),p.mutatedParts&&Jr(p.mutatedParts),v.then(function(A){0<A.numFailures&&(ee(N.optimisticOps,p),(A=Oo(0,p,A))&&N.optimisticOps.push(A),p.mutatedParts&&Jr(p.mutatedParts))}),v.catch(function(){ee(N.optimisticOps,p),p.mutatedParts&&Jr(p.mutatedParts)})):v.then(function(A){var E=Oo(0,o(o({},p),{values:p.values.map(function(R,S){var B;return A.failures[S]?R:(R=(B=h.keyPath)!==null&&B!==void 0&&B.includes(".")?oe(R):o({},R),P(R,h.keyPath,A.results[S]),R)})}),A);N.optimisticOps.push(E),queueMicrotask(function(){return p.mutatedParts&&Jr(p.mutatedParts)})}),v):c.mutate(p)},query:function(p){if(!Ao(Me,c)||!Po("query",p))return c.query(p);var v=((E=Me.trans)===null||E===void 0?void 0:E.db._options.cache)==="immutable",S=Me,N=S.requery,A=S.signal,E=function(F,L,$,V){var H=Tn["idb://".concat(F,"/").concat(L)];if(!H)return[];if(!(L=H.queries[$]))return[null,!1,H,null];var Z=L[(V.query?V.query.index.name:null)||""];if(!Z)return[null,!1,H,null];switch($){case"query":var ae=Z.find(function(he){return he.req.limit===V.limit&&he.req.values===V.values&&_o(he.req.query.range,V.query.range)});return ae?[ae,!0,H,Z]:[Z.find(function(he){return("limit"in he.req?he.req.limit:1/0)>=V.limit&&(!V.values||he.req.values)&&uc(he.req.query.range,V.query.range)}),!1,H,Z];case"count":return ae=Z.find(function(he){return _o(he.req.query.range,V.query.range)}),[ae,!!ae,H,Z]}}(a,i,"query",p),R=E[0],S=E[1],B=E[2],_=E[3];return R&&S?R.obsSet=p.obsSet:(S=c.query(p).then(function(F){var L=F.result;if(R&&(R.res=L),v){for(var $=0,V=L.length;$<V;++$)Object.freeze(L[$]);Object.freeze(L)}else F.result=oe(L);return F}).catch(function(F){return _&&R&&ee(_,R),Promise.reject(F)}),R={obsSet:p.obsSet,promise:S,subscribers:new Set,type:"query",req:p,dirty:!1},_?_.push(R):(_=[R],(B=B||(Tn["idb://".concat(a,"/").concat(i)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[p.query.index.name||""]=_)),dc(R,_,N,A),R.promise.then(function(F){return{result:Eo(F.result,p,B==null?void 0:B.optimisticOps,c,R,v)}})}})}})}};function es(r,a){return new Proxy(r,{get:function(i,c,h){return c==="db"?a:Reflect.get(i,c,h)}})}var Ut=(lt.prototype.version=function(r){if(isNaN(r)||r<.1)throw new ce.Type("Given version is not a positive number");if(r=Math.round(10*r)/10,this.idbdb||this._state.isBeingOpened)throw new ce.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,r);var a=this._versions,i=a.filter(function(c){return c._cfg.version===r})[0];return i||(i=new this.Version(r),a.push(i),a.sort(tc),i.stores({}),this._state.autoSchema=!1,i)},lt.prototype._whenReady=function(r){var a=this;return this.idbdb&&(this._state.openComplete||Me.letThrough||this._vip)?r():new ge(function(i,c){if(a._state.openComplete)return c(new ce.DatabaseClosed(a._state.dbOpenError));if(!a._state.isBeingOpened){if(!a._state.autoOpen)return void c(new ce.DatabaseClosed);a.open().catch(se)}a._state.dbReadyPromise.then(i,c)}).then(r)},lt.prototype.use=function(r){var a=r.stack,i=r.create,c=r.level,h=r.name;return h&&this.unuse({stack:a,name:h}),r=this._middlewares[a]||(this._middlewares[a]=[]),r.push({stack:a,create:i,level:c??10,name:h}),r.sort(function(p,v){return p.level-v.level}),this},lt.prototype.unuse=function(r){var a=r.stack,i=r.name,c=r.create;return a&&this._middlewares[a]&&(this._middlewares[a]=this._middlewares[a].filter(function(h){return c?h.create!==c:!!i&&h.name!==i})),this},lt.prototype.open=function(){var r=this;return Dn(At,function(){return ac(r)})},lt.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var r=this._state,a=Hn.indexOf(this);if(0<=a&&Hn.splice(a,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}r.isBeingOpened||(r.dbReadyPromise=new ge(function(i){r.dbReadyResolve=i}),r.openCanceller=new ge(function(i,c){r.cancelOpen=c}))},lt.prototype.close=function(i){var a=(i===void 0?{disableAutoOpen:!0}:i).disableAutoOpen,i=this._state;a?(i.isBeingOpened&&i.cancelOpen(new ce.DatabaseClosed),this._close(),i.autoOpen=!1,i.dbOpenError=new ce.DatabaseClosed):(this._close(),i.autoOpen=this._options.autoOpen||i.isBeingOpened,i.openComplete=!1,i.dbOpenError=null)},lt.prototype.delete=function(r){var a=this;r===void 0&&(r={disableAutoOpen:!0});var i=0<arguments.length&&typeof arguments[0]!="object",c=this._state;return new ge(function(h,p){function v(){a.close(r);var N=a._deps.indexedDB.deleteDatabase(a.name);N.onsuccess=at(function(){var A,E,R;A=a._deps,E=a.name,R=A.indexedDB,A=A.IDBKeyRange,Gs(R)||E===$r||qs(R,A).delete(E).catch(se),h()}),N.onerror=Rt(p),N.onblocked=a._fireOnBlocked}if(i)throw new ce.InvalidArgument("Invalid closeOptions argument to db.delete()");c.isBeingOpened?c.dbReadyPromise.then(v):v()})},lt.prototype.backendDB=function(){return this.idbdb},lt.prototype.isOpen=function(){return this.idbdb!==null},lt.prototype.hasBeenClosed=function(){var r=this._state.dbOpenError;return r&&r.name==="DatabaseClosed"},lt.prototype.hasFailed=function(){return this._state.dbOpenError!==null},lt.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(lt.prototype,"tables",{get:function(){var r=this;return d(this._allTables).map(function(a){return r._allTables[a]})},enumerable:!1,configurable:!0}),lt.prototype.transaction=function(){var r=(function(a,i,c){var h=arguments.length;if(h<2)throw new ce.InvalidArgument("Too few arguments");for(var p=new Array(h-1);--h;)p[h-1]=arguments[h];return c=p.pop(),[a,J(p),c]}).apply(this,arguments);return this._transaction.apply(this,r)},lt.prototype._transaction=function(r,a,i){var c=this,h=Me.trans;h&&h.db===this&&r.indexOf("!")===-1||(h=null);var p,v,N=r.indexOf("?")!==-1;r=r.replace("!","").replace("?","");try{if(v=a.map(function(E){if(E=E instanceof c.Table?E.name:E,typeof E!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return E}),r=="r"||r===Ls)p=Ls;else{if(r!="rw"&&r!=Rs)throw new ce.InvalidArgument("Invalid transaction mode: "+r);p=Rs}if(h){if(h.mode===Ls&&p===Rs){if(!N)throw new ce.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");h=null}h&&v.forEach(function(E){if(h&&h.storeNames.indexOf(E)===-1){if(!N)throw new ce.SubTransaction("Table "+E+" not included in parent transaction.");h=null}}),N&&h&&!h.active&&(h=null)}}catch(E){return h?h._promise(null,function(R,S){S(E)}):it(E)}var A=(function E(R,S,B,_,F){return ge.resolve().then(function(){var L=Me.transless||Me,$=R._createTransaction(S,B,R._dbSchema,_);if($.explicit=!0,L={trans:$,transless:L},_)$.idbtrans=_.idbtrans;else try{$.create(),$.idbtrans._explicit=!0,R._state.PR1398_maxLoop=3}catch(Z){return Z.name===Ve.InvalidState&&R.isOpen()&&0<--R._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),R.close({disableAutoOpen:!1}),R.open().then(function(){return E(R,S,B,null,F)})):it(Z)}var V,H=ke(F);return H&&Wn(),L=ge.follow(function(){var Z;(V=F.call($,$))&&(H?(Z=nn.bind(null,null),V.then(Z,Z)):typeof V.next=="function"&&typeof V.throw=="function"&&(V=na(V)))},L),(V&&typeof V.then=="function"?ge.resolve(V).then(function(Z){return $.active?Z:it(new ce.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):L.then(function(){return V})).then(function(Z){return _&&$._resolve(),$._completion.then(function(){return Z})}).catch(function(Z){return $._reject(Z),it(Z)})})}).bind(null,this,p,v,h,i);return h?h._promise(p,A,"lock"):Me.trans?Dn(Me.transless,function(){return c._whenReady(A)}):this._whenReady(A)},lt.prototype.table=function(r){if(!b(this._allTables,r))throw new ce.InvalidTable("Table ".concat(r," does not exist"));return this._allTables[r]},lt);function lt(r,a){var i=this;this._middlewares={},this.verno=0;var c=lt.dependencies;this._options=a=o({addons:lt.addons,autoOpen:!0,indexedDB:c.indexedDB,IDBKeyRange:c.IDBKeyRange,cache:"cloned"},a),this._deps={indexedDB:a.indexedDB,IDBKeyRange:a.IDBKeyRange},c=a.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var h,p,v,N,A,E={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:se,dbReadyPromise:null,cancelOpen:se,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:a.autoOpen};E.dbReadyPromise=new ge(function(S){E.dbReadyResolve=S}),E.openCanceller=new ge(function(S,B){E.cancelOpen=B}),this._state=E,this.name=r,this.on=cr(this,"populate","blocked","versionchange","close",{ready:[Ee,se]}),this.once=function(S,B){var _=function(){for(var F=[],L=0;L<arguments.length;L++)F[L]=arguments[L];i.on(S).unsubscribe(_),B.apply(i,F)};return i.on(S,_)},this.on.ready.subscribe=q(this.on.ready.subscribe,function(S){return function(B,_){lt.vip(function(){var F,L=i._state;L.openComplete?(L.dbOpenError||ge.resolve().then(B),_&&S(B)):L.onReadyBeingFired?(L.onReadyBeingFired.push(B),_&&S(B)):(S(B),F=i,_||S(function $(){F.on.ready.unsubscribe(B),F.on.ready.unsubscribe($)}))})}}),this.Collection=(h=this,ur(ql.prototype,function(V,$){this.db=h;var _=lo,F=null;if($)try{_=$()}catch(H){F=H}var L=V._ctx,$=L.table,V=$.hook.reading.fire;this._ctx={table:$,index:L.index,isPrimKey:!L.index||$.schema.primKey.keyPath&&L.index===$.schema.primKey.name,range:_,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:F,or:L.or,valueMapper:V!==Ce?V:null}})),this.Table=(p=this,ur(po.prototype,function(S,B,_){this.db=p,this._tx=_,this.name=S,this.schema=B,this.hook=p._allTables[S]?p._allTables[S].hook:cr(null,{creating:[Pe,se],reading:[we,Ce],updating:[Ze,se],deleting:[qe,se]})})),this.Transaction=(v=this,ur(Xl.prototype,function(S,B,_,F,L){var $=this;S!=="readonly"&&B.forEach(function(V){V=(V=_[V])===null||V===void 0?void 0:V.yProps,V&&(B=B.concat(V.map(function(H){return H.updatesTable})))}),this.db=v,this.mode=S,this.storeNames=B,this.schema=_,this.chromeTransactionDurability=F,this.idbtrans=null,this.on=cr(this,"complete","error","abort"),this.parent=L||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new ge(function(V,H){$._resolve=V,$._reject=H}),this._completion.then(function(){$.active=!1,$.on.complete.fire()},function(V){var H=$.active;return $.active=!1,$.on.error.fire(V),$.parent?$.parent._reject(V):H&&$.idbtrans&&$.idbtrans.abort(),it(V)})})),this.Version=(N=this,ur(sc.prototype,function(S){this.db=N,this._cfg={version:S,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(A=this,ur(bo.prototype,function(S,B,_){if(this.db=A,this._ctx={table:S,index:B===":id"?null:B,or:_},this._cmp=this._ascending=Ke,this._descending=function(F,L){return Ke(L,F)},this._max=function(F,L){return 0<Ke(F,L)?F:L},this._min=function(F,L){return Ke(F,L)<0?F:L},this._IDBKeyRange=A._deps.IDBKeyRange,!this._IDBKeyRange)throw new ce.MissingAPI})),this.on("versionchange",function(S){0<S.newVersion?console.warn("Another connection wants to upgrade database '".concat(i.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(i.name,"'. Closing db now to resume the delete request.")),i.close({disableAutoOpen:!1})}),this.on("blocked",function(S){!S.newVersion||S.newVersion<S.oldVersion?console.warn("Dexie.delete('".concat(i.name,"') was blocked")):console.warn("Upgrade '".concat(i.name,"' blocked by other connection holding version ").concat(S.oldVersion/10))}),this._maxKey=fr(a.IDBKeyRange),this._createTransaction=function(S,B,_,F){return new i.Transaction(S,B,_,i._options.chromeTransactionDurability,F)},this._fireOnBlocked=function(S){i.on("blocked").fire(S),Hn.filter(function(B){return B.name===i.name&&B!==i&&!B._state.vcFired}).map(function(B){return B.on("versionchange").fire(S)})},this.use(lc),this.use(hc),this.use(cc),this.use(oc),this.use(ic);var R=new Proxy(this,{get:function(S,B,_){if(B==="_vip")return!0;if(B==="table")return function(L){return es(i.table(L),R)};var F=Reflect.get(S,B,_);return F instanceof po?es(F,R):B==="tables"?F.map(function(L){return es(L,R)}):B==="_createTransaction"?function(){return es(F.apply(this,arguments),R)}:F}});this.vip=R,c.forEach(function(S){return S(i)})}var ts,Pt=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",fc=(oa.prototype.subscribe=function(r,a,i){return this._subscribe(r&&typeof r!="function"?r:{next:r,error:a,complete:i})},oa.prototype[Pt]=function(){return this},oa);function oa(r){this._subscribe=r}try{ts={indexedDB:u.indexedDB||u.mozIndexedDB||u.webkitIndexedDB||u.msIndexedDB,IDBKeyRange:u.IDBKeyRange||u.webkitIDBKeyRange}}catch{ts={indexedDB:null,IDBKeyRange:null}}function Io(r){var a,i=!1,c=new fc(function(h){var p=ke(r),v,N=!1,A={},E={},R={get closed(){return N},unsubscribe:function(){N||(N=!0,v&&v.abort(),S&&an.storagemutated.unsubscribe(_))}};h.start&&h.start(R);var S=!1,B=function(){return Fs(F)},_=function(L){Xr(A,L),Js(E,A)&&B()},F=function(){var L,$,V;!N&&ts.indexedDB&&(A={},L={},v&&v.abort(),v=new AbortController,V=function(H){var Z=Yn();try{p&&Wn();var ae=tn(r,H);return ae=p?ae.finally(nn):ae}finally{Z&&Kn()}}($={subscr:L,signal:v.signal,requery:B,querier:r,trans:null}),Promise.resolve(V).then(function(H){i=!0,a=H,N||$.signal.aborted||(A={},function(Z){for(var ae in Z)if(b(Z,ae))return;return 1}(E=L)||S||(an(hr,_),S=!0),Fs(function(){return!N&&h.next&&h.next(H)}))},function(H){i=!1,["DatabaseClosedError","AbortError"].includes(H==null?void 0:H.name)||N||Fs(function(){N||h.error&&h.error(H)})}))};return setTimeout(B,0),R});return c.hasValue=function(){return i},c.getValue=function(){return a},c}var An=Ut;function ia(r){var a=on;try{on=!0,an.storagemutated.fire(r),ta(r,!0)}finally{on=a}}C(An,o(o({},X),{delete:function(r){return new An(r,{addons:[]}).delete()},exists:function(r){return new An(r,{addons:[]}).open().then(function(a){return a.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(r){try{return a=An.dependencies,i=a.indexedDB,a=a.IDBKeyRange,(Gs(i)?Promise.resolve(i.databases()).then(function(c){return c.map(function(h){return h.name}).filter(function(h){return h!==$r})}):qs(i,a).toCollection().primaryKeys()).then(r)}catch{return it(new ce.MissingAPI)}var a,i},defineClass:function(){return function(r){y(this,r)}},ignoreTransaction:function(r){return Me.trans?Dn(Me.transless,r):r()},vip:Qs,async:function(r){return function(){try{var a=na(r.apply(this,arguments));return a&&typeof a.then=="function"?a:ge.resolve(a)}catch(i){return it(i)}}},spawn:function(r,a,i){try{var c=na(r.apply(i,a||[]));return c&&typeof c.then=="function"?c:ge.resolve(c)}catch(h){return it(h)}},currentTransaction:{get:function(){return Me.trans||null}},waitFor:function(r,a){return a=ge.resolve(typeof r=="function"?An.ignoreTransaction(r):r).timeout(a||6e4),Me.trans?Me.trans.waitFor(a):a},Promise:ge,debug:{get:function(){return Re},set:function(r){kt(r)}},derive:I,extend:y,props:C,override:q,Events:cr,on:an,liveQuery:Io,extendObservabilitySet:Xr,getByKeyPath:T,setByKeyPath:P,delByKeyPath:function(r,a){typeof a=="string"?P(r,a,void 0):"length"in a&&[].map.call(a,function(i){P(r,i,void 0)})},shallowClone:U,deepClone:oe,getObjectDiff:ra,cmp:Ke,asap:Q,minKey:-1/0,addons:[],connections:Hn,errnames:Ve,dependencies:ts,cache:Tn,semVer:"4.2.1",version:"4.2.1".split(".").map(function(r){return parseInt(r)}).reduce(function(r,a,i){return r+a/Math.pow(10,2*i)})})),An.maxKey=fr(An.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(an(hr,function(r){on||(r=new CustomEvent(zs,{detail:r}),on=!0,dispatchEvent(r),on=!1)}),addEventListener(zs,function(r){r=r.detail,on||ia(r)}));var Qn,on=!1,Fo=function(){};return typeof BroadcastChannel<"u"&&((Fo=function(){(Qn=new BroadcastChannel(zs)).onmessage=function(r){return r.data&&ia(r.data)}})(),typeof Qn.unref=="function"&&Qn.unref(),an(hr,function(r){on||Qn.postMessage(r)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(r){if(!Ut.disableBfCache&&r.persisted){Re&&console.debug("Dexie: handling persisted pagehide"),Qn!=null&&Qn.close();for(var a=0,i=Hn;a<i.length;a++)i[a].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(r){!Ut.disableBfCache&&r.persisted&&(Re&&console.debug("Dexie: handling persisted pageshow"),Fo(),ia({all:new gt(-1/0,[[]])}))})),ge.rejectionMapper=function(r,a){return!r||r instanceof Ae||r instanceof TypeError||r instanceof SyntaxError||!r.name||!Ie[r.name]?r:(a=new Ie[r.name](a||r.message,r),"stack"in r&&j(a,"stack",{get:function(){return this.inner.stack}}),a)},kt(Re),o(Ut,Object.freeze({__proto__:null,Dexie:Ut,liveQuery:Io,Entity:co,cmp:Ke,PropModification:lr,replacePrefix:function(r,a){return new lr({replacePrefix:[r,a]})},add:function(r){return new lr({add:r})},remove:function(r){return new lr({remove:r})},default:Ut,RangeSet:gt,mergeRanges:gr,rangesOverlap:No}),{default:Ut}),Ut})})(zi);var Fu=zi.exports;const Fa=zn(Fu),Bo=Symbol.for("Dexie"),ps=globalThis[Bo]||(globalThis[Bo]=Fa);if(Fa.semVer!==ps.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${Fa.semVer} and ${ps.semVer}`);const{liveQuery:ng,mergeRanges:rg,rangesOverlap:sg,RangeSet:ag,cmp:og,Entity:ig,PropModification:lg,replacePrefix:cg,add:ug,remove:dg,DexieYProvider:hg}=ps;class Lu extends ps{constructor(){super("VibeNotesDB");xe(this,"notes");xe(this,"syncQueue");xe(this,"noteVersions");xe(this,"colorLabels");xe(this,"noteColorLabels");xe(this,"colorLabelSyncQueue");xe(this,"folders");this.version(3).stores({notes:"id, userId, isPinned, isArchived, deletedAt, updatedAt, *tags",syncQueue:"++id, noteId, timestamp",noteVersions:"++id, noteId, version, createdAt, userId"}),this.version(4).stores({notes:"id, userId, isPinned, isArchived, deletedAt, updatedAt, *tags",syncQueue:"++id, noteId, timestamp",noteVersions:"++id, noteId, version, createdAt, userId",colorLabels:"id, userId, name, updatedAt",noteColorLabels:"[noteId+colorLabelId], noteId, colorLabelId",colorLabelSyncQueue:"++id, colorLabelId, noteId, timestamp"}),this.version(5).stores({notes:"id, userId, folderId, isPinned, isArchived, deletedAt, updatedAt, *tags",syncQueue:"++id, noteId, timestamp",noteVersions:"++id, noteId, version, createdAt, userId",colorLabels:"id, userId, name, updatedAt",noteColorLabels:"[noteId+colorLabelId], noteId, colorLabelId",colorLabelSyncQueue:"++id, colorLabelId, noteId, timestamp",folders:"id, userId, parentId, name, updatedAt"})}}const je=new Lu,zt={async getAll(){return je.colorLabels.orderBy("name").toArray()},async getById(e){return je.colorLabels.get(e)},async create(e){const n={...e,id:crypto.randomUUID(),createdAt:new Date,updatedAt:new Date};return await je.colorLabels.add(n),await this.addToSyncQueue("CREATE",n.id,n),n},async update(e,n){const s=await je.colorLabels.get(e);if(!s)return;const o={...s,...n,updatedAt:new Date};return await je.colorLabels.put(o),await this.addToSyncQueue("UPDATE",e,n),o},async delete(e){await je.noteColorLabels.where("colorLabelId").equals(e).delete(),await je.colorLabels.delete(e),await this.addToSyncQueue("DELETE",e)},async getLabelsForNote(e){const s=(await je.noteColorLabels.where("noteId").equals(e).toArray()).map(l=>l.colorLabelId);return(await je.colorLabels.bulkGet(s)).filter(l=>l!==void 0)},async getNotesWithLabel(e){return(await je.noteColorLabels.where("colorLabelId").equals(e).toArray()).map(s=>s.noteId)},async assignLabelToNote(e,n){if(await je.noteColorLabels.get([e,n]))return;const o={noteId:e,colorLabelId:n,assignedAt:new Date};await je.noteColorLabels.add(o),await this.addToSyncQueue("ASSIGN",n,void 0,e)},async removeLabelFromNote(e,n){await je.noteColorLabels.delete([e,n]),await this.addToSyncQueue("UNASSIGN",n,void 0,e)},async updateNoteLabels(e,n){await je.transaction("rw",je.noteColorLabels,async()=>{await je.noteColorLabels.where("noteId").equals(e).delete();const s=n.map(o=>({noteId:e,colorLabelId:o,assignedAt:new Date}));await je.noteColorLabels.bulkAdd(s)});for(const s of n)await this.addToSyncQueue("ASSIGN",s,void 0,e)},async syncFromServer(e){await je.transaction("rw",je.colorLabels,async()=>{for(const n of e){const s=await je.colorLabels.get(n.id);(!s||new Date(n.updatedAt)>new Date(s.updatedAt))&&await je.colorLabels.put({...n,syncedAt:new Date})}})},async syncNoteLabelsFromServer(e,n){await je.transaction("rw",je.noteColorLabels,async()=>{await je.noteColorLabels.where("noteId").equals(e).delete();const s=n.map(o=>({noteId:e,colorLabelId:o,assignedAt:new Date}));await je.noteColorLabels.bulkAdd(s)})},async addToSyncQueue(e,n,s,o){await je.colorLabelSyncQueue.add({action:e,colorLabelId:n,noteId:o,data:s,timestamp:new Date,retryCount:0})},async getSyncQueue(){return je.colorLabelSyncQueue.orderBy("timestamp").toArray()},async removeSyncQueueItem(e){await je.colorLabelSyncQueue.delete(e)},async clear(){await je.colorLabels.clear(),await je.noteColorLabels.clear(),await je.colorLabelSyncQueue.clear()},async fetchAndSync(){try{const e=await He.get("/api/color-labels");return await this.syncFromServer(e.data),e.data}catch{return this.getAll()}},async syncLabelToServer(e){await He.post("/api/color-labels",{name:e.name,color:e.color})},async updateLabelOnServer(e,n){await He.put(`/api/color-labels/${e}`,n)},async deleteLabelFromServer(e){await He.delete(`/api/color-labels/${e}`)}},Ru=["#EF4444","#F97316","#EAB308","#22C55E","#14B8A6","#3B82F6","#8B5CF6","#EC4899","#6B7280"];function Ha(){const[e,n]=f.useState([]),[s,o]=f.useState(!0),[l,u]=f.useState(null),d=f.useCallback(async()=>{try{o(!0);const b=await zt.fetchAndSync();n(b),u(null)}catch(b){const C=b instanceof Error?b.message:"Failed to load color labels";u(C);const x=await zt.getAll();n(x)}finally{o(!1)}},[]);f.useEffect(()=>{d()},[d]);const m=f.useCallback(async(b,C)=>{try{const x=or.getUser();if(!(x!=null&&x.id))throw new Error("User not authenticated");const j=await zt.create({userId:x.id,name:b,color:C});return n(I=>[...I,j].sort((k,M)=>k.name.localeCompare(M.name))),u(null),j}catch(x){const j=x instanceof Error?x.message:"Failed to create label";throw u(j),new Error(j)}},[]),y=f.useCallback(async(b,C)=>{try{const x=await zt.update(b,C);return x&&n(j=>j.map(I=>I.id===b?x:I).sort((I,k)=>I.name.localeCompare(k.name))),u(null),x}catch(x){const j=x instanceof Error?x.message:"Failed to update label";throw u(j),new Error(j)}},[]),g=f.useCallback(async b=>{try{await zt.delete(b),n(C=>C.filter(x=>x.id!==b)),u(null)}catch(C){const x=C instanceof Error?C.message:"Failed to delete label";throw u(x),new Error(x)}},[]),w=f.useCallback(b=>e.find(C=>C.id===b),[e]);return{labels:e,isLoading:s,error:l,createLabel:m,updateLabel:y,deleteLabel:g,getLabelById:w,refresh:d,defaultColors:Ru}}function $u(e){const[n,s]=f.useState([]),[o,l]=f.useState(!1),[u,d]=f.useState(null),m=f.useCallback(async()=>{if(!e){s([]);return}try{l(!0);const x=await zt.getLabelsForNote(e);s(x),d(null)}catch(x){const j=x instanceof Error?x.message:"Failed to load note labels";d(j)}finally{l(!1)}},[e]);f.useEffect(()=>{m()},[m]);const y=f.useCallback(async x=>{if(e)try{await zt.assignLabelToNote(e,x),await m(),d(null)}catch(j){const I=j instanceof Error?j.message:"Failed to assign label";throw d(I),new Error(I)}},[e,m]),g=f.useCallback(async x=>{if(e)try{await zt.removeLabelFromNote(e,x),s(j=>j.filter(I=>I.id!==x)),d(null)}catch(j){const I=j instanceof Error?j.message:"Failed to remove label";throw d(I),new Error(I)}},[e]),w=f.useCallback(async x=>{if(e)try{await zt.updateNoteLabels(e,x),await m(),d(null)}catch(j){const I=j instanceof Error?j.message:"Failed to update labels";throw d(I),new Error(I)}},[e,m]),b=f.useCallback(x=>n.some(j=>j.id===x),[n]),C=f.useCallback(async x=>{b(x)?await g(x):await y(x)},[b,y,g]);return{noteLabels:n,isLoading:o,error:u,assignLabel:y,removeLabel:g,updateLabels:w,hasLabel:b,toggleLabel:C,refresh:m}}function Bu({noteId:e,onError:n}){const{labels:s,createLabel:o,defaultColors:l}=Ha(),{noteLabels:u,toggleLabel:d,hasLabel:m}=$u(e),[y,g]=f.useState(!1),[w,b]=f.useState(!1),[C,x]=f.useState(""),[j,I]=f.useState(l[0]),k=async D=>{try{await d(D)}catch(q){n==null||n(q instanceof Error?q.message:"Failed to toggle label")}},M=async()=>{if(C.trim())try{const D=await o(C.trim(),j);await d(D.id),x(""),b(!1)}catch(D){n==null||n(D instanceof Error?D.message:"Failed to create label")}};return t.jsxs(Ia,{open:y,onOpenChange:g,children:[t.jsx(fs,{asChild:!0,children:t.jsxs(le,{variant:"ghost",size:"sm",className:"h-8 gap-1 text-muted-foreground hover:text-foreground",children:[t.jsx(rr,{className:"h-4 w-4"}),t.jsx("span",{className:"sr-only md:not-sr-only md:inline",children:"Labels"}),u.length>0&&t.jsxs("span",{className:"ml-1 flex gap-0.5",children:[u.slice(0,3).map(D=>t.jsx("span",{className:"h-2 w-2 rounded-full",style:{backgroundColor:D.color}},D.id)),u.length>3&&t.jsxs("span",{className:"text-xs",children:["+",u.length-3]})]})]})}),t.jsx(ms,{className:"w-64 p-2",align:"start",children:t.jsxs("div",{className:"space-y-2",children:[t.jsx("div",{className:"px-2 py-1.5 text-sm font-medium",children:"Labels"}),t.jsxs("div",{className:"max-h-48 overflow-y-auto space-y-1",children:[s.length===0&&!w&&t.jsx("div",{className:"px-2 py-4 text-center text-sm text-muted-foreground",children:"No labels yet. Create one below."}),s.map(D=>t.jsxs("button",{onClick:()=>k(D.id),className:Oe("flex w-full items-center gap-2 rounded-md px-2 py-1.5 text-sm hover:bg-accent",m(D.id)&&"bg-accent"),children:[t.jsx("span",{className:"h-3 w-3 rounded-full flex-shrink-0",style:{backgroundColor:D.color}}),t.jsx("span",{className:"flex-1 text-left truncate",children:D.name}),m(D.id)&&t.jsx(fn,{className:"h-4 w-4 flex-shrink-0"})]},D.id))]}),w?t.jsxs("div",{className:"border-t pt-2 space-y-2",children:[t.jsx(vt,{placeholder:"Label name",value:C,onChange:D=>x(D.target.value),onKeyDown:D=>{D.key==="Enter"&&M(),D.key==="Escape"&&b(!1)},autoFocus:!0,className:"h-8"}),t.jsx("div",{className:"flex flex-wrap gap-1",children:l.map(D=>t.jsx("button",{onClick:()=>I(D),className:Oe("h-6 w-6 rounded-full border-2 transition-transform hover:scale-110",j===D?"border-foreground scale-110":"border-transparent"),style:{backgroundColor:D}},D))}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(le,{size:"sm",onClick:M,disabled:!C.trim(),className:"flex-1",children:"Create"}),t.jsx(le,{size:"sm",variant:"ghost",onClick:()=>{b(!1),x("")},children:"Cancel"})]})]}):t.jsxs("button",{onClick:()=>b(!0),className:"flex w-full items-center gap-2 rounded-md px-2 py-1.5 text-sm text-muted-foreground hover:bg-accent hover:text-foreground border-t",children:[t.jsx(Cn,{className:"h-4 w-4"}),"Create new label"]})]})})]})}function zu({labels:e,max:n=3}){if(e.length===0)return null;const s=e.slice(0,n),o=e.length-n;return t.jsxs("div",{className:"flex items-center gap-0.5",children:[s.map(l=>t.jsx("span",{className:"h-2 w-2 rounded-full",style:{backgroundColor:l.color},title:l.name},l.id)),o>0&&t.jsxs("span",{className:"text-xs text-muted-foreground ml-0.5",children:["+",o]})]})}function Vu(e){const n=/^[\s]*[-*]\s+\[\s\]/gm,s=/^[\s]*[-*]\s+\[[xX]\]/gm,o=e.match(n)||[],l=e.match(s)||[],u=o.length,d=l.length,m=u+d;return{total:m,checked:d,percentage:m>0?Math.round(d/m*100):0}}function Yu(e){return/^[\s]*[-*]\s+\[[\sxX]\]/m.test(e)}function Ku({note:e,onSelect:n,onDelete:s,onTogglePin:o,onToggleArchive:l,isSelected:u,colorLabels:d=[]}){const m=C=>new Date(C).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),y=f.useMemo(()=>!e.content||!Yu(e.content)?null:Vu(e.content),[e.content]),g=C=>{C.stopPropagation(),s(e.id)},w=C=>{C.stopPropagation(),o(e.id,!e.isPinned)},b=C=>{C.stopPropagation(),l(e.id,!e.isArchived)};return t.jsxs(cn,{className:`cursor-pointer transition-colors hover:bg-accent/50 ${u?"border-primary":""}`,onClick:()=>n(e),children:[t.jsx(Da,{className:"pb-3",children:t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsx(Sa,{className:"text-lg line-clamp-1",children:e.title||"Untitled"}),t.jsxs("div",{className:"flex gap-1",children:[t.jsx(le,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:w,"aria-label":e.isPinned?"Unpin note":"Pin note",children:t.jsx(Ii,{className:`h-4 w-4 ${e.isPinned?"fill-current":""}`})}),t.jsx(le,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:b,"aria-label":e.isArchived?"Unarchive note":"Archive note",children:e.isArchived?t.jsx(nu,{className:"h-4 w-4"}):t.jsx(ks,{className:"h-4 w-4"})}),t.jsx(le,{variant:"ghost",size:"icon",className:"h-8 w-8 text-destructive",onClick:g,"aria-label":"Delete note",children:t.jsx(Yt,{className:"h-4 w-4"})})]})]})}),t.jsxs(un,{children:[t.jsx("p",{className:"text-sm text-muted-foreground line-clamp-2 mb-2",children:e.content||"No content"}),y&&y.total>0&&t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx(Di,{className:"h-3 w-3 text-muted-foreground flex-shrink-0"}),t.jsx(Ss,{value:y.percentage,className:"h-1.5 flex-1"}),t.jsxs("span",{className:"text-[10px] text-muted-foreground whitespace-nowrap",children:[y.checked,"/",y.total]})]}),t.jsxs("div",{className:"flex items-center justify-between text-xs text-muted-foreground",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{children:m(e.updatedAt)}),d.length>0&&t.jsx(zu,{labels:d,max:4})]}),e.tags.length>0&&t.jsxs("div",{className:"flex gap-1 flex-wrap justify-end",children:[e.tags.slice(0,3).map(C=>t.jsx(Ds,{variant:"secondary",className:"text-[10px] px-1.5 h-5",children:C},C)),e.tags.length>3&&t.jsxs("span",{className:"text-[10px] text-muted-foreground",children:["+",e.tags.length-3]})]})]})]})]})}const Vi=f.createContext(null);function Ua(){const e=f.useContext(Vi);if(!e)throw new Error("Dialog components must be used within a Dialog");return e}const Fn=({children:e,open:n,onOpenChange:s,defaultOpen:o=!1})=>{const[l,u]=f.useState(o),d=n!==void 0,m=d?n:l,y=f.useCallback(g=>{d||u(g),s==null||s(g)},[d,s]);return t.jsx(Vi.Provider,{value:{open:m,setOpen:y},children:e})},qa=f.forwardRef(({children:e,asChild:n,onClick:s,...o},l)=>{const{setOpen:u}=Ua(),d=m=>{s==null||s(m),u(!0)};return n&&f.isValidElement(e)?f.cloneElement(e,{onClick:d,ref:l}):t.jsx("button",{ref:l,onClick:d,...o,children:e})});qa.displayName="DialogTrigger";const Wu=f.forwardRef(({className:e,...n},s)=>t.jsx("div",{ref:s,className:Oe("hidden",e),...n}));Wu.displayName="DialogOverlay";const Hu=f.forwardRef(({children:e,asChild:n,onClick:s,...o},l)=>{const{setOpen:u}=Ua(),d=m=>{s==null||s(m),u(!1)};return n&&f.isValidElement(e)?f.cloneElement(e,{onClick:d,ref:l}):t.jsx("button",{ref:l,onClick:d,...o,children:e})});Hu.displayName="DialogClose";const dn=f.forwardRef(({className:e,children:n,onPointerDownOutside:s,onEscapeKeyDown:o,...l},u)=>{const{open:d,setOpen:m}=Ua(),y=(g,w)=>{if(w==="backdropClick"&&s){const b=new Event("pointerdown");s(b);return}if(w==="escapeKeyDown"&&o){const b=new KeyboardEvent("keydown",{key:"Escape"});o(b);return}m(!1)};return t.jsxs(li,{open:d,onClose:y,maxWidth:"sm",fullWidth:!0,PaperProps:{ref:u,className:Oe("!bg-background !text-foreground",e),sx:{borderRadius:"0.5rem",backgroundImage:"none"},...l},children:[n,t.jsx(_n,{"aria-label":"close",onClick:()=>m(!1),sx:{position:"absolute",right:8,top:8,color:"text.secondary",opacity:.7,"&:hover":{opacity:1}},children:t.jsx(Tt,{className:"h-4 w-4"})})]})});dn.displayName="DialogContent";const Gt=({className:e,...n})=>t.jsx(Qe,{className:Oe("flex flex-col space-y-1.5 text-center sm:text-left px-6 pt-6",e),...n});Gt.displayName="DialogHeader";const Ln=({className:e,...n})=>t.jsx(ui,{className:Oe("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2 px-6 pb-6",e),sx:{padding:"0 24px 24px 24px"},...n});Ln.displayName="DialogFooter";const Qt=f.forwardRef(({className:e,children:n,...s},o)=>t.jsx(ci,{ref:o,className:Oe("!p-0 !text-lg !font-semibold !leading-none !tracking-tight",e),...s,children:n}));Qt.displayName="DialogTitle";const mn=f.forwardRef(({className:e,children:n,...s},o)=>t.jsx(St,{ref:o,variant:"body2",className:Oe("text-muted-foreground",e),component:"p",...s,children:n}));mn.displayName="DialogDescription";const Yi=f.createContext(null);function Ms(){const e=f.useContext(Yi);if(!e)throw new Error("AlertDialog components must be used within an AlertDialog");return e}const Rn=({children:e,open:n,onOpenChange:s,defaultOpen:o=!1})=>{const[l,u]=f.useState(o),d=n!==void 0,m=d?n:l,y=f.useCallback(g=>{d||u(g),s==null||s(g)},[d,s]);return t.jsx(Yi.Provider,{value:{open:m,setOpen:y},children:e})},Uu=f.forwardRef(({children:e,asChild:n,onClick:s,...o},l)=>{const{setOpen:u}=Ms(),d=m=>{s==null||s(m),u(!0)};return n&&f.isValidElement(e)?f.cloneElement(e,{onClick:d,ref:l}):t.jsx("button",{ref:l,onClick:d,...o,children:e})});Uu.displayName="AlertDialogTrigger";const qu=f.forwardRef(({className:e,...n},s)=>t.jsx("div",{ref:s,className:Oe("hidden",e),...n}));qu.displayName="AlertDialogOverlay";const pn=f.forwardRef(({className:e,children:n,...s},o)=>{const{open:l}=Ms();return t.jsx(li,{open:l,maxWidth:"sm",fullWidth:!0,disableEscapeKeyDown:!0,PaperProps:{ref:o,className:Oe("!bg-background !text-foreground",e),sx:{borderRadius:"0.5rem",backgroundImage:"none"},...s},slotProps:{backdrop:{onClick:u=>u.stopPropagation()}},children:n})});pn.displayName="AlertDialogContent";const gn=({className:e,...n})=>t.jsx(Qe,{className:Oe("flex flex-col space-y-2 text-center sm:text-left px-6 pt-6",e),...n});gn.displayName="AlertDialogHeader";const yn=({className:e,...n})=>t.jsx(ui,{className:Oe("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2 px-6 pb-6",e),sx:{padding:"0 24px 24px 24px"},...n});yn.displayName="AlertDialogFooter";const xn=f.forwardRef(({className:e,children:n,...s},o)=>t.jsx(ci,{ref:o,className:Oe("!p-0 !text-lg !font-semibold",e),...s,children:n}));xn.displayName="AlertDialogTitle";const vn=f.forwardRef(({className:e,children:n,...s},o)=>t.jsx(St,{ref:o,variant:"body2",className:Oe("text-muted-foreground",e),component:"p",...s,children:n}));vn.displayName="AlertDialogDescription";const bn=f.forwardRef(({className:e,children:n,onClick:s,asChild:o},l)=>{const{setOpen:u}=Ms(),d=m=>{s==null||s(m),u(!1)};return o&&f.isValidElement(n)?f.cloneElement(n,{onClick:d,ref:l}):t.jsx(di,{ref:l,variant:"contained",onClick:d,className:Oe(vi(),e),children:n})});bn.displayName="AlertDialogAction";const wn=f.forwardRef(({className:e,children:n,onClick:s,asChild:o},l)=>{const{setOpen:u}=Ms(),d=m=>{s==null||s(m),u(!1)};return o&&f.isValidElement(n)?f.cloneElement(n,{onClick:d,ref:l}):t.jsx(di,{ref:l,variant:"outlined",onClick:d,className:Oe(vi({variant:"outline"}),"mt-2 sm:mt-0",e),children:n})});wn.displayName="AlertDialogCancel";function Gu({onError:e}){const{labels:n,createLabel:s,updateLabel:o,deleteLabel:l,defaultColors:u,isLoading:d}=Ha(),[m,y]=f.useState(!1),[g,w]=f.useState(null),[b,C]=f.useState(null),[x,j]=f.useState(""),[I,k]=f.useState(u[0]),[M,D]=f.useState(!1),q=async()=>{if(x.trim())try{await s(x.trim(),I),j(""),k(u[0]),D(!1)}catch(T){e==null||e(T instanceof Error?T.message:"Failed to create label")}},O=async()=>{if(!(!g||!g.name.trim()))try{await o(g.id,{name:g.name.trim(),color:g.color}),w(null)}catch(T){e==null||e(T instanceof Error?T.message:"Failed to update label")}},Q=async()=>{if(b)try{await l(b.id),C(null)}catch(T){e==null||e(T instanceof Error?T.message:"Failed to delete label")}};return t.jsxs(t.Fragment,{children:[t.jsxs(Fn,{open:m,onOpenChange:y,children:[t.jsx(qa,{asChild:!0,children:t.jsxs(le,{variant:"outline",size:"sm",className:"gap-2",children:[t.jsx(rr,{className:"h-4 w-4"}),"Manage Labels"]})}),t.jsxs(dn,{className:"sm:max-w-md",children:[t.jsxs(Gt,{children:[t.jsx(Qt,{children:"Manage Color Labels"}),t.jsx(mn,{children:"Create and organize color labels for your notes."})]}),t.jsxs("div",{className:"space-y-4 py-4",children:[t.jsxs("div",{className:"max-h-64 overflow-y-auto space-y-2",children:[d&&t.jsx("div",{className:"text-center py-4 text-muted-foreground",children:"Loading labels..."}),!d&&n.length===0&&!M&&t.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[t.jsx(rr,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),t.jsx("p",{children:"No labels created yet."}),t.jsx("p",{className:"text-sm",children:"Create your first label below."})]}),n.map(T=>t.jsx("div",{className:"flex items-center gap-2 p-2 rounded-md border",children:(g==null?void 0:g.id)===T.id?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"flex flex-wrap gap-1",children:u.map(P=>t.jsx("button",{onClick:()=>w({...g,color:P}),className:Oe("h-5 w-5 rounded-full border-2 transition-transform hover:scale-110",g.color===P?"border-foreground scale-110":"border-transparent"),style:{backgroundColor:P},"aria-label":`Select color ${P}`,"aria-pressed":g.color===P},P))}),t.jsx(vt,{value:g.name,onChange:P=>w({...g,name:P.target.value}),onKeyDown:P=>{P.key==="Enter"&&O(),P.key==="Escape"&&w(null)},className:"flex-1 h-8",autoFocus:!0}),t.jsx(le,{size:"icon",variant:"ghost",className:"h-8 w-8",onClick:O,"aria-label":"Save label changes",children:t.jsx(fn,{className:"h-4 w-4"})}),t.jsx(le,{size:"icon",variant:"ghost",className:"h-8 w-8",onClick:()=>w(null),"aria-label":"Cancel editing",children:t.jsx(Tt,{className:"h-4 w-4"})})]}):t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"h-4 w-4 rounded-full flex-shrink-0",style:{backgroundColor:T.color}}),t.jsx("span",{className:"flex-1 truncate",children:T.name}),t.jsx(le,{size:"icon",variant:"ghost",className:"h-8 w-8",onClick:()=>w({...T}),"aria-label":`Edit label: ${T.name}`,children:t.jsx(Pr,{className:"h-4 w-4"})}),t.jsx(le,{size:"icon",variant:"ghost",className:"h-8 w-8 text-destructive hover:text-destructive",onClick:()=>C(T),"aria-label":`Delete label: ${T.name}`,children:t.jsx(Yt,{className:"h-4 w-4"})})]})},T.id))]}),M?t.jsxs("div",{className:"border-t pt-4 space-y-3",children:[t.jsx(vt,{placeholder:"Label name",value:x,onChange:T=>j(T.target.value),onKeyDown:T=>{T.key==="Enter"&&q(),T.key==="Escape"&&(D(!1),j(""))},autoFocus:!0}),t.jsx("div",{className:"flex flex-wrap gap-1.5",children:u.map(T=>t.jsx("button",{onClick:()=>k(T),className:Oe("h-7 w-7 rounded-full border-2 transition-transform hover:scale-110",I===T?"border-foreground scale-110":"border-transparent"),style:{backgroundColor:T},"aria-label":`Select color ${T}`,"aria-pressed":I===T},T))}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(le,{onClick:q,disabled:!x.trim(),className:"flex-1",children:"Create Label"}),t.jsx(le,{variant:"outline",onClick:()=>{D(!1),j("")},children:"Cancel"})]})]}):t.jsxs(le,{variant:"outline",className:"w-full gap-2",onClick:()=>D(!0),children:[t.jsx(Cn,{className:"h-4 w-4"}),"Create New Label"]})]})]})]}),t.jsx(Rn,{open:!!b,onOpenChange:T=>!T&&C(null),children:t.jsxs(pn,{children:[t.jsxs(gn,{children:[t.jsx(xn,{children:"Delete Label"}),t.jsxs(vn,{children:['Are you sure you want to delete the label "',b==null?void 0:b.name,'"? This will remove the label from all notes. This action cannot be undone.']})]}),t.jsxs(yn,{children:[t.jsx(wn,{children:"Cancel"}),t.jsx(bn,{onClick:Q,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Delete"})]})]})})]})}function Qu({notes:e,selectedNote:n,onSelectNote:s,onCreateNote:o,onDeleteNote:l,onTogglePin:u,onToggleArchive:d,onSearch:m,showArchived:y,onToggleShowArchived:g,templateSelector:w}){const[b,C]=f.useState(""),[x,j]=f.useState([]),[I,k]=f.useState({}),M=f.useCallback(async()=>{const P={};for(const U of e)try{const Y=await zt.getLabelsForNote(U.id);P[U.id]=Y}catch{P[U.id]=[]}k(P)},[e]);f.useEffect(()=>{M()},[M]);const D=f.useMemo(()=>{const P=new Set;return e.forEach(U=>{U.tags.forEach(Y=>P.add(Y))}),Array.from(P).sort()},[e]),q=P=>{C(P),m(P)},O=P=>{j(U=>U.includes(P)?U.filter(Y=>Y!==P):[...U,P])},Q=()=>{j([])},T=f.useMemo(()=>x.length===0?e:e.filter(P=>x.every(U=>P.tags.includes(U))),[e,x]);return t.jsxs("div",{className:"flex flex-col h-full border-r bg-card",children:[t.jsxs("div",{className:"p-4 border-b space-y-4",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("h2",{className:"text-xl font-bold",children:y?"Archived Notes":"Notes"}),t.jsxs("div",{className:"flex gap-1",children:[t.jsx(le,{variant:y?"secondary":"ghost",size:"icon",onClick:g,"aria-label":y?"Show active notes":"Show archived notes",title:y?"Show active notes":"Show archived notes",children:y?t.jsx(Pi,{className:"h-4 w-4"}):t.jsx(ks,{className:"h-4 w-4"})}),!y&&t.jsx(le,{onClick:o,size:"icon","aria-label":"Create new note",children:t.jsx(Cn,{className:"h-4 w-4"})})]})]}),t.jsxs("div",{className:"flex gap-2",children:[w&&t.jsx("div",{className:"flex-1",children:w}),t.jsx(Gu,{})]}),t.jsxs("div",{className:"relative",children:[t.jsx(ws,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),t.jsx(vt,{placeholder:"Search notes...",value:b,onChange:P=>q(P.target.value),className:"pl-10"})]}),D.length>0&&t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-xs text-muted-foreground",children:"Filter by tags:"}),x.length>0&&t.jsxs(le,{variant:"ghost",size:"sm",onClick:Q,className:"h-6 px-2 text-xs",children:["Clear (",x.length,")"]})]}),t.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2 scrollbar-hide",children:D.map(P=>t.jsx(Ds,{variant:x.includes(P)?"default":"outline",className:"cursor-pointer whitespace-nowrap",onClick:()=>O(P),children:P},P))})]})]}),t.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-2",children:T.length===0?t.jsxs("div",{className:"text-center text-muted-foreground py-8",children:[t.jsx("p",{children:"No notes found"}),e.length===0&&t.jsx("p",{className:"text-sm",children:"Click + to create your first note"})]}):T.map(P=>t.jsx(Ku,{note:P,onSelect:s,onDelete:l,onTogglePin:u,onToggleArchive:d,isSelected:(n==null?void 0:n.id)===P.id,colorLabels:I[P.id]||[]},P.id))})]})}function ga(e,n){const[s,o]=f.useState(e);return f.useEffect(()=>{const l=setTimeout(()=>{o(e)},n);return()=>{clearTimeout(l)}},[e,n]),s}function Xu({tags:e,onChange:n}){const[s,o]=f.useState(""),[l,u]=f.useState(!1),d=w=>{o(w.target.value)},m=w=>{w.key==="Enter"?(w.preventDefault(),y()):w.key==="Escape"&&(u(!1),o(""))},y=()=>{const w=s.trim();w&&!e.includes(w)&&(n([...e,w]),o(""))},g=w=>{n(e.filter(b=>b!==w))};return t.jsxs("div",{className:"flex flex-wrap gap-2 items-center",children:[e.map(w=>t.jsxs(Ds,{variant:"secondary",className:"gap-1 pr-1",children:[w,t.jsx("button",{onClick:()=>g(w),className:"hover:bg-secondary-foreground/20 rounded-full p-0.5 focus:outline-none","aria-label":`Remove ${w} tag`,children:t.jsx(Tt,{className:"h-3 w-3"})})]},w)),l?t.jsx("div",{className:"flex items-center gap-2",children:t.jsx(vt,{type:"text",value:s,onChange:d,onKeyDown:m,onBlur:y,className:"h-7 w-32 text-xs",placeholder:"Add tag...",autoFocus:!0})}):t.jsxs(le,{variant:"ghost",size:"sm",className:"h-7 px-2 text-xs text-muted-foreground hover:text-foreground",onClick:()=>u(!0),children:[t.jsx(Cn,{className:"h-3 w-3 mr-1"}),"Add Tag"]})]})}const Ju=[{id:"h1",label:"Heading 1",icon:t.jsx(fu,{className:"h-4 w-4"}),description:"Big section heading"},{id:"h2",label:"Heading 2",icon:t.jsx(mu,{className:"h-4 w-4"}),description:"Medium section heading"},{id:"h3",label:"Heading 3",icon:t.jsx(pu,{className:"h-4 w-4"}),description:"Small section heading"},{id:"bullet",label:"Bullet List",icon:t.jsx(xu,{className:"h-4 w-4"}),description:"Create a simple bulleted list"},{id:"number",label:"Numbered List",icon:t.jsx(yu,{className:"h-4 w-4"}),description:"Create a numbered list"},{id:"check",label:"To-do List",icon:t.jsx(Di,{className:"h-4 w-4"}),description:"Track tasks with a to-do list"},{id:"code",label:"Code Block",icon:t.jsx(iu,{className:"h-4 w-4"}),description:"Capture a code snippet"},{id:"quote",label:"Quote",icon:t.jsx(Du,{className:"h-4 w-4"}),description:"Capture a quote"},{id:"divider",label:"Divider",icon:t.jsx(wu,{className:"h-4 w-4"}),description:"Visually divide blocks"},{id:"table",label:"Table",icon:t.jsx(Ou,{className:"h-4 w-4"}),description:"Insert a simple table"}];function Zu({position:e,onSelect:n,onClose:s,filter:o}){const[l,u]=f.useState(0),d=f.useRef(null),m=Ju.filter(y=>y.label.toLowerCase().includes(o.toLowerCase())||y.description.toLowerCase().includes(o.toLowerCase()));return f.useEffect(()=>{u(0)},[o]),f.useEffect(()=>{const y=g=>{if(m.length!==0)switch(g.key){case"ArrowDown":g.preventDefault(),u(w=>(w+1)%m.length);break;case"ArrowUp":g.preventDefault(),u(w=>(w-1+m.length)%m.length);break;case"Enter":g.preventDefault(),n(m[l].id);break;case"Escape":g.preventDefault(),s();break}};return document.addEventListener("keydown",y),()=>document.removeEventListener("keydown",y)},[m,l,n,s]),f.useEffect(()=>{const y=g=>{d.current&&!d.current.contains(g.target)&&s()};return document.addEventListener("mousedown",y),()=>document.removeEventListener("mousedown",y)},[s]),m.length===0?null:t.jsx("div",{ref:d,className:"fixed z-50 w-72 bg-popover rounded-md border shadow-md overflow-hidden animate-in fade-in zoom-in-95 duration-100",style:{top:e.top,left:e.left},children:t.jsx("div",{className:"p-1 max-h-[300px] overflow-y-auto",children:m.map((y,g)=>t.jsxs("button",{className:Oe("w-full flex items-center gap-2 px-2 py-1.5 text-sm rounded-sm text-left transition-colors",g===l?"bg-accent text-accent-foreground":"hover:bg-accent hover:text-accent-foreground"),onClick:()=>n(y.id),onMouseEnter:()=>u(g),children:[t.jsx("div",{className:"flex items-center justify-center w-5 h-5 border rounded bg-background text-muted-foreground",children:y.icon}),t.jsxs("div",{className:"flex flex-col flex-1 min-w-0",children:[t.jsx("span",{className:"font-medium truncate",children:y.label}),t.jsx("span",{className:"text-xs text-muted-foreground truncate",children:y.description})]})]},y.id))})})}const ya={AUTO_SAVE_DELAY_MS:1e3};function zo({note:e,onSave:n,onError:s}){const[o,l]=f.useState(""),[u,d]=f.useState(""),[m,y]=f.useState([]),[g,w]=f.useState(!1),[b,C]=f.useState(null),[x,j]=f.useState("edit"),[I,k]=f.useState(!1),[M,D]=f.useState(!1),[q,O]=f.useState({top:0,left:0}),[Q,T]=f.useState(""),P=f.useRef(null),U=f.useRef(u),Y=f.useRef(o),J=f.useRef(m),ne=f.useRef(e),G=f.useRef(null),oe=f.useRef(!1),te=f.useRef(!1),[z,K]=f.useState(!1),W=f.useRef(null),ee=f.useRef(n),ie=f.useRef(s);f.useEffect(()=>{ee.current=n,ie.current=s},[n,s]),f.useEffect(()=>{U.current=u,Y.current=o,J.current=m,ne.current=e},[u,o,m,e]),f.useEffect(()=>{if(e){const X=o!==e.title||u!==e.content||JSON.stringify(m)!==JSON.stringify(e.tags);K(X)}else K(!1)},[o,u,m,e]);const me=ga(u,ya.AUTO_SAVE_DELAY_MS),ke=ga(o,ya.AUTO_SAVE_DELAY_MS),Te=ga(m,ya.AUTO_SAVE_DELAY_MS);f.useEffect(()=>{G.current&&(G.current.abort(),G.current=null),oe.current=!1,te.current=!1,e?(W.current={id:e.id,title:e.title,content:e.content,tags:e.tags||[]},l(e.title),d(e.content),y(e.tags||[]),D(!1),C(null),K(!1)):(W.current=null,l(""),d(""),y([]))},[e==null?void 0:e.id]);const Ae=f.useCallback(async()=>{var Ce;const X=ne.current;if(!X)return;if(oe.current){te.current=!0;return}const se=new AbortController;G.current=se,oe.current=!0,w(!0);try{const we={title:Y.current,content:U.current,tags:J.current};if(se.signal.aborted)return;await ee.current(X.id,we),se.signal.aborted||(W.current&&W.current.id===X.id&&(W.current={id:X.id,title:we.title,content:we.content,tags:we.tags}),C(new Date),K(!1))}catch(we){if(se.signal.aborted)return;const re=we instanceof Error?we.message:"Failed to save note";(Ce=ie.current)==null||Ce.call(ie,re)}finally{oe.current=!1,w(!1),te.current&&!se.signal.aborted&&(te.current=!1,setTimeout(()=>Ae(),0))}},[]);f.useEffect(()=>{const X=W.current;X&&(ke!==X.title||me!==X.content||JSON.stringify(Te)!==JSON.stringify(X.tags))&&Ae()},[ke,me,Te,Ae]);const Be=async()=>{try{await navigator.clipboard.writeText(u),k(!0),setTimeout(()=>k(!1),2e3)}catch{s==null||s("Failed to copy to clipboard. Please try again or use Ctrl+C.")}},de=()=>{if(!P.current)return;const X=P.current,{selectionStart:se}=X,Ce=document.createElement("div"),we=window.getComputedStyle(X);Array.from(we).forEach(Ee=>{Ce.style.setProperty(Ee,we.getPropertyValue(Ee))}),Ce.style.position="absolute",Ce.style.visibility="hidden",Ce.style.whiteSpace="pre-wrap",Ce.style.top="0",Ce.style.left="0",Ce.style.height="auto",Ce.style.width=we.width;const re=X.value.substring(0,se);Ce.textContent=re;const Pe=document.createElement("span");Pe.textContent="|",Ce.appendChild(Pe),document.body.appendChild(Ce);const{offsetLeft:qe,offsetTop:Ze}=Pe,st=X.getBoundingClientRect();document.body.removeChild(Ce),O({top:st.top+Ze-X.scrollTop+30,left:st.left+qe-X.scrollLeft})},Le=(X,se="")=>{if(!P.current)return;const Ce=P.current,we=Ce.selectionStart,re=Ce.selectionEnd,Pe=Ce.value,qe=Pe.substring(we,re),Ze=Pe.substring(0,we)+X+qe+se+Pe.substring(re);d(Ze),setTimeout(()=>{Ce.focus(),Ce.setSelectionRange(we+X.length,re+X.length)},0)},Ve=X=>{if(!P.current)return;const se=P.current,Ce=se.selectionStart,we=se.value,re=we.lastIndexOf("/",Ce);if(re===-1)return;let Pe="",qe=0;switch(X){case"h1":Pe="# ";break;case"h2":Pe="## ";break;case"h3":Pe="### ";break;case"bullet":Pe="- ";break;case"number":Pe="1. ";break;case"check":Pe="- [ ] ";break;case"code":Pe="```\n\n```",qe=4;break;case"quote":Pe="> ";break;case"divider":Pe=`---
`;break;case"table":Pe=`| Col 1 | Col 2 |
|---|---|
| Val 1 | Val 2 |`;break}const Ze=we.substring(0,re)+Pe+we.substring(Ce);d(Ze),D(!1),setTimeout(()=>{se.focus();const st=re+Pe.length-(qe||0);se.setSelectionRange(st,st)},0)},tt=X=>{if((X.ctrlKey||X.metaKey)&&X.key==="b"){X.preventDefault(),Le("**","**");return}if((X.ctrlKey||X.metaKey)&&X.key==="i"){X.preventDefault(),Le("*","*");return}if((X.ctrlKey||X.metaKey)&&X.key==="k"){X.preventDefault(),Le("[","](url)");return}if((X.ctrlKey||X.metaKey)&&X.key==="s"){X.preventDefault(),Ae();return}if(M){if(X.key==="Escape"){D(!1);return}if(["ArrowUp","ArrowDown","Enter"].includes(X.key)){X.key==="Enter"&&X.preventDefault();return}X.key.length===1?T(se=>se+X.key):X.key==="Backspace"&&(T(se=>se.slice(0,-1)),Q.length===0&&D(!1))}else X.key==="/"&&(de(),D(!0),T(""))};f.useEffect(()=>{const X=se=>{(se.ctrlKey||se.metaKey)&&se.key==="s"&&(se.preventDefault(),Ae()),(se.ctrlKey||se.metaKey)&&se.shiftKey&&se.key==="C"&&(se.preventDefault(),navigator.clipboard.writeText(U.current).then(()=>{k(!0),setTimeout(()=>k(!1),2e3)}).catch(()=>{s==null||s("Failed to copy to clipboard. Please try again or use Ctrl+C.")}))};return window.addEventListener("keydown",X),()=>window.removeEventListener("keydown",X)},[Ae]);const ce=f.useMemo(()=>u.trim().split(/\s+/).filter(Boolean).length,[u]),Ie=u.length;return e?t.jsxs("div",{className:"flex flex-col h-full relative",children:[M&&t.jsx(Zu,{position:q,onSelect:Ve,onClose:()=>D(!1),filter:Q}),t.jsxs("div",{className:"p-4 border-b space-y-4",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx(vt,{value:o,onChange:X=>l(X.target.value),placeholder:"Note title...",className:"text-2xl font-bold border-none shadow-none focus-visible:ring-0 px-0 h-auto py-0"}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground whitespace-nowrap mr-4",children:[g&&t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx(Li,{className:"h-4 w-4 animate-pulse"}),"Saving..."]}),!g&&z&&t.jsxs("span",{className:"flex items-center gap-1 text-amber-600 dark:text-amber-400",children:[t.jsx(Mi,{className:"h-2 w-2 fill-current"}),"Unsaved changes"]}),!g&&!z&&b&&t.jsxs("span",{className:"flex items-center gap-1 text-emerald-600 dark:text-emerald-400",children:[t.jsx(fn,{className:"h-3 w-3"}),"Saved ",b.toLocaleTimeString()]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(le,{variant:"ghost",size:"sm",onClick:Be,className:"h-7 px-2 text-muted-foreground hover:text-foreground",title:"Copy content (Ctrl+Shift+C)",children:I?t.jsx(fn,{className:"h-4 w-4 text-green-500"}):t.jsx(lu,{className:"h-4 w-4"})}),t.jsxs("div",{className:"flex bg-muted rounded-md p-1",children:[t.jsxs(le,{variant:x==="edit"?"secondary":"ghost",size:"sm",onClick:()=>j("edit"),className:"h-7 px-2","aria-label":"Edit mode",children:[t.jsx(Ns,{className:"h-4 w-4 mr-1"}),"Edit"]}),t.jsxs(le,{variant:x==="preview"?"secondary":"ghost",size:"sm",onClick:()=>j("preview"),className:"h-7 px-2","aria-label":"Preview mode",children:[t.jsx(Cs,{className:"h-4 w-4 mr-1"}),"Preview"]})]})]})]})]}),t.jsx(Xu,{tags:m,onChange:y})]}),t.jsx("div",{className:"flex-1 overflow-hidden relative",children:x==="edit"?t.jsx("textarea",{ref:P,value:u,onChange:X=>d(X.target.value),onKeyDown:tt,placeholder:"Start writing (Markdown supported)... Type '/' for commands",className:"w-full h-full p-4 resize-none bg-transparent border-none outline-none text-foreground placeholder:text-muted-foreground font-mono leading-relaxed"}):t.jsx("div",{className:"h-full overflow-y-auto p-4 prose prose-sm dark:prose-invert max-w-none",children:u?t.jsx(Lc,{remarkPlugins:[$c],rehypePlugins:[Rc],children:u}):t.jsx("p",{className:"text-muted-foreground italic",children:"Nothing to preview"})})}),t.jsx("div",{className:"h-8 border-t flex items-center justify-end px-4 text-xs text-muted-foreground bg-muted/30 select-none",children:t.jsxs("div",{className:"flex gap-4",children:[t.jsxs("span",{children:[ce," words"]}),t.jsxs("span",{children:[Ie," characters"]})]})})]}):t.jsx("div",{className:"flex items-center justify-center h-full text-muted-foreground",children:t.jsx("p",{children:"Select a note to edit or create a new one"})})}const Ki=f.createContext(null);function Or(){const e=f.useContext(Ki);if(!e)throw new Error("DropdownMenu components must be used within a DropdownMenu");return e}const gs=({children:e,open:n,onOpenChange:s,defaultOpen:o=!1})=>{const[l,u]=f.useState(o),[d,m]=f.useState(null),y=n!==void 0,g=y?n:l,w=f.useCallback(b=>{y||u(b),s==null||s(b)},[y,s]);return t.jsx(Ki.Provider,{value:{open:g,setOpen:w,anchorEl:d,setAnchorEl:m},children:e})},Nr=f.forwardRef(({children:e,asChild:n,onClick:s,...o},l)=>{const{setOpen:u,setAnchorEl:d}=Or(),m=y=>{s==null||s(y),d(y.currentTarget),u(!0)};return n&&f.isValidElement(e)?f.cloneElement(e,{onClick:m,ref:l}):t.jsx("button",{ref:l,onClick:m,...o,children:e})});Nr.displayName="DropdownMenuTrigger";const Wi=f.createContext(null),ed=f.createContext(null),td=f.forwardRef(({className:e,inset:n,children:s,...o},l)=>{const u=f.useContext(Wi),d=y=>{u==null||u.setAnchorEl(y.currentTarget),u==null||u.setOpen(!0)},m=()=>{u==null||u.setOpen(!1)};return t.jsxs(ar,{ref:l,className:Oe("flex cursor-default select-none items-center gap-2 rounded-sm text-sm",n&&"pl-8",e),onMouseEnter:d,onMouseLeave:m,sx:{minHeight:"auto",py:.75,px:1,"&:hover":{backgroundColor:"action.hover"}},...o,children:[s,t.jsx(Si,{className:"ml-auto h-4 w-4"})]})});td.displayName="DropdownMenuSubTrigger";const nd=f.forwardRef(({className:e,children:n,...s},o)=>{const l=f.useContext(Wi);return t.jsx(hi,{open:(l==null?void 0:l.open)??!1,anchorEl:l==null?void 0:l.anchorEl,onClose:()=>l==null?void 0:l.setOpen(!1),anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"left"},slotProps:{paper:{ref:o,className:Oe("min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg",e),sx:{backgroundImage:"none"},...s}},children:n})});nd.displayName="DropdownMenuSubContent";const Dr=f.forwardRef(({className:e,sideOffset:n=4,align:s="start",side:o="bottom",children:l,...u},d)=>{const{open:m,setOpen:y,anchorEl:g}=Or(),w=()=>({vertical:o==="top"?"top":"bottom",horizontal:s==="start"?"left":s==="end"?"right":"center"}),b=()=>({vertical:o==="top"?"bottom":"top",horizontal:s==="start"?"left":s==="end"?"right":"center"});return t.jsx(hi,{open:m&&!!g,anchorEl:g,onClose:()=>y(!1),anchorOrigin:w(),transformOrigin:b(),slotProps:{paper:{ref:d,className:Oe("min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md",e),sx:{marginTop:o==="bottom"?`${n}px`:void 0,marginBottom:o==="top"?`${n}px`:void 0,backgroundImage:"none"},...u}},children:l})});Dr.displayName="DropdownMenuContent";const ht=f.forwardRef(({className:e,inset:n,disabled:s,onSelect:o,onClick:l,children:u,...d},m)=>{const{setOpen:y}=Or(),g=w=>{l==null||l(w),o==null||o(),y(!1)};return t.jsx(ar,{ref:m,disabled:s,onClick:g,className:Oe("relative flex cursor-default select-none items-center gap-2 rounded-sm text-sm outline-none transition-colors",n&&"pl-8",e),sx:{minHeight:"auto",py:.75,px:1,borderRadius:"0.125rem","&:hover":{backgroundColor:"action.hover"},"&:focus":{backgroundColor:"action.hover"}},...d,children:u})});ht.displayName="DropdownMenuItem";const rd=f.forwardRef(({className:e,children:n,checked:s,onCheckedChange:o,disabled:l,...u},d)=>{const{setOpen:m}=Or(),y=()=>{o==null||o(!s),m(!1)};return t.jsxs(ar,{ref:d,disabled:l,onClick:y,className:Oe("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors",e),sx:{minHeight:"auto",py:.75,pl:4,pr:1,"&:hover":{backgroundColor:"action.hover"}},...u,children:[t.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:s&&t.jsx(fn,{className:"h-4 w-4"})}),n]})});rd.displayName="DropdownMenuCheckboxItem";const sd=f.forwardRef(({className:e,children:n,value:s,disabled:o,...l},u)=>{const d=f.useContext(ed),{setOpen:m}=Or(),y=(d==null?void 0:d.value)===s,g=()=>{d==null||d.onValueChange(s),m(!1)};return t.jsxs(ar,{ref:u,disabled:o,onClick:g,className:Oe("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors",e),sx:{minHeight:"auto",py:.75,pl:4,pr:1,"&:hover":{backgroundColor:"action.hover"}},...l,children:[t.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:y&&t.jsx(Mi,{className:"h-2 w-2 fill-current"})}),n]})});sd.displayName="DropdownMenuRadioItem";const ad=f.forwardRef(({className:e,inset:n,...s},o)=>t.jsx(St,{ref:o,variant:"body2",className:Oe("px-2 py-1.5 text-sm font-semibold",n&&"pl-8",e),component:"div",sx:{px:1,py:.75},...s}));ad.displayName="DropdownMenuLabel";const Sr=f.forwardRef(({className:e,...n},s)=>t.jsx(us,{ref:s,className:Oe("-mx-1 my-1",e),...n}));Sr.displayName="DropdownMenuSeparator";function Hi(e){var s;const n=`# ${e.title}

${e.content}

---

Tags: ${((s=e.tags)==null?void 0:s.join(", "))||"None"}
Created: ${new Date(e.createdAt).toLocaleDateString()}
Updated: ${new Date(e.updatedAt).toLocaleDateString()}`;Ga(n,`${id(e.title)}.md`,"text/markdown")}function Ui(e){const n=e.map(s=>{var o;return`# ${s.title}

${s.content}

---

Tags: ${((o=s.tags)==null?void 0:o.join(", "))||"None"}
Created: ${new Date(s.createdAt).toLocaleDateString()}

`}).join(`

`);Ga(n,`vibenotes-export-${new Date().toISOString().split("T")[0]}.md`,"text/markdown")}function qi(e){const n={version:"1.0",exportDate:new Date().toISOString(),notes:e.map(s=>({id:s.id,title:s.title,content:s.content,tags:s.tags,isPinned:s.isPinned,createdAt:s.createdAt,updatedAt:s.updatedAt}))};Ga(JSON.stringify(n,null,2),`vibenotes-backup-${new Date().toISOString().split("T")[0]}.json`,"application/json")}function Gi(e){const n=od(e.content);return`
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>${xa(e.title)}</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            max-width: 800px;
            margin: 40px auto;
            padding: 20px;
            line-height: 1.6;
            color: #333;
        }
        h1 {
            border-bottom: 2px solid #4f46e5;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        .metadata {
            color: #666;
            font-size: 0.9em;
            margin-bottom: 30px;
        }
        .tag {
            display: inline-block;
            background: #e0e7ff;
            color: #4f46e5;
            padding: 2px 8px;
            border-radius: 4px;
            margin-right: 5px;
            font-size: 0.85em;
        }
        code {
            background: #f3f4f6;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
        }
        pre {
            background: #1f2937;
            color: #f9fafb;
            padding: 15px;
            border-radius: 6px;
            overflow-x: auto;
        }
        pre code {
            background: none;
            color: inherit;
        }
        blockquote {
            border-left: 4px solid #4f46e5;
            margin-left: 0;
            padding-left: 20px;
            color: #555;
        }
    </style>
</head>
<body>
    <h1>${xa(e.title)}</h1>
    <div class="metadata">
        <div>
            ${e.tags&&e.tags.length>0?e.tags.map(s=>`<span class="tag">${xa(s)}</span>`).join(""):'<span class="tag">No tags</span>'}
        </div>
        <div>Created: ${new Date(e.createdAt).toLocaleDateString()}</div>
        <div>Updated: ${new Date(e.updatedAt).toLocaleDateString()}</div>
    </div>
    <div class="content">
        ${n}
    </div>
</body>
</html>
    `.trim()}function Qi(e){const n=Gi(e),s=window.open("","_blank");if(!s)throw new Error("Could not open print window. Please allow popups.");s.document.write(n),s.document.close(),s.onload=()=>{s.focus(),s.print()}}function od(e){let n=e;return n=n.replace(/^### (.*$)/gim,"<h3>$1</h3>"),n=n.replace(/^## (.*$)/gim,"<h2>$1</h2>"),n=n.replace(/^# (.*$)/gim,"<h1>$1</h1>"),n=n.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>"),n=n.replace(/__(.*?)__/g,"<strong>$1</strong>"),n=n.replace(/\*(.*?)\*/g,"<em>$1</em>"),n=n.replace(/_(.*?)_/g,"<em>$1</em>"),n=n.replace(/```([\s\S]*?)```/g,"<pre><code>$1</code></pre>"),n=n.replace(/`(.*?)`/g,"<code>$1</code>"),n=n.replace(/\[([^\]]+)\]\(([^)]+)\)/g,'<a href="$2">$1</a>'),n=n.replace(/\n\n/g,"</p><p>"),n=n.replace(/\n/g,"<br>"),n=`<p>${n}</p>`,n}function id(e){return e.replace(/[^a-z0-9]/gi,"-").replace(/-+/g,"-").replace(/^-|-$/g,"").toLowerCase().substring(0,100)}function xa(e){const n=document.createElement("div");return n.textContent=e,n.innerHTML}function Ga(e,n,s){const o=new Blob([e],{type:s}),l=URL.createObjectURL(o),u=document.createElement("a");u.href=l,u.download=n,u.style.display="none";const d=()=>{u.parentNode&&document.body.removeChild(u),URL.revokeObjectURL(l)};u.onclick=()=>{requestAnimationFrame(()=>{requestAnimationFrame(d)})},document.body.appendChild(u),u.click(),setTimeout(d,1e3)}async function ld(e){return new Promise((n,s)=>{const o=new FileReader;o.onload=l=>{var u;try{const d=(u=l.target)==null?void 0:u.result,m=JSON.parse(d);if(!m.notes||!Array.isArray(m.notes))throw new Error("Invalid backup file format");const y=m.notes.map(g=>({title:g.title||"Untitled",content:g.content||"",tags:g.tags||[],isPinned:g.isPinned||!1}));n(y)}catch{s(new Error("Failed to parse backup file"))}},o.onerror=()=>{s(new Error("Failed to read file"))},o.readAsText(e)})}const cd=Object.freeze(Object.defineProperty({__proto__:null,exportNoteAsHTML:Gi,exportNoteAsMarkdown:Hi,exportNoteAsPDF:Qi,exportNotesAsJSON:qi,exportNotesAsMarkdown:Ui,importNotesFromJSON:ld},Symbol.toStringTag,{value:"Module"}));function ud({note:e,notes:n,onImport:s,onError:o}){const[l,u]=f.useState(!1),d=()=>{try{if(!e){o==null||o("No note selected");return}Hi(e)}catch(b){const C=b instanceof Error?b.message:"Export failed";o==null||o(C)}},m=()=>{try{if(n.length===0){o==null||o("No notes to export");return}Ui(n)}catch(b){const C=b instanceof Error?b.message:"Export failed";o==null||o(C)}},y=()=>{try{if(n.length===0){o==null||o("No notes to export");return}qi(n)}catch(b){const C=b instanceof Error?b.message:"Export failed";o==null||o(C)}},g=()=>{try{if(!e){o==null||o("No note selected");return}Qi(e)}catch(b){const C=b instanceof Error?b.message:"Export failed";o==null||o(C)}},w=async b=>{var x;const C=(x=b.target.files)==null?void 0:x[0];if(C){u(!0);try{const{importNotesFromJSON:j}=await Ec(async()=>{const{importNotesFromJSON:k}=await Promise.resolve().then(()=>cd);return{importNotesFromJSON:k}},void 0),I=await j(C);s&&await s(I)}catch(j){const I=j instanceof Error?j.message:"Import failed";o==null||o(I)}finally{u(!1),b.target.value=""}}};return t.jsxs(gs,{children:[t.jsx(Nr,{asChild:!0,children:t.jsx(le,{variant:"ghost",size:"icon","aria-label":"Export options",title:"Export & Import",children:t.jsx(bi,{className:"h-4 w-4"})})}),t.jsxs(Dr,{align:"end",className:"w-56",children:[t.jsx("div",{className:"px-2 py-1.5 text-sm font-semibold",children:"Export Current Note"}),t.jsxs(ht,{onClick:d,disabled:!e,children:[t.jsx(_t,{className:"mr-2 h-4 w-4"}),"Export as Markdown"]}),t.jsxs(ht,{onClick:g,disabled:!e,children:[t.jsx(Nu,{className:"mr-2 h-4 w-4"}),"Export as PDF"]}),t.jsx(Sr,{}),t.jsx("div",{className:"px-2 py-1.5 text-sm font-semibold",children:"Export All Notes"}),t.jsxs(ht,{onClick:m,disabled:n.length===0,children:[t.jsx(_t,{className:"mr-2 h-4 w-4"}),"All Notes as Markdown"]}),t.jsxs(ht,{onClick:y,disabled:n.length===0,children:[t.jsx(uu,{className:"mr-2 h-4 w-4"}),"Backup as JSON"]}),t.jsx(Sr,{}),t.jsxs(ht,{onClick:()=>{var b;return(b=document.getElementById("import-json-input"))==null?void 0:b.click()},children:[t.jsx(Ri,{className:"mr-2 h-4 w-4"}),l?"Importing...":"Import from JSON",t.jsx("input",{id:"import-json-input",type:"file",accept:".json",onChange:w,disabled:l,className:"hidden"})]})]})]})}const ss="http://localhost:3001";class Et{static async uploadAttachment(n,s,o){const l=new FormData;return l.append("file",s),l.append("noteId",n),(await rs.post(`${ss}/api/attachments/upload`,l,{headers:{Authorization:`Bearer ${o}`,"Content-Type":"multipart/form-data"}})).data}static async getAttachmentsByNoteId(n,s){return(await rs.get(`${ss}/api/attachments/note/${n}`,{headers:{Authorization:`Bearer ${s}`}})).data.attachments}static async deleteAttachment(n,s){await rs.delete(`${ss}/api/attachments/${n}`,{headers:{Authorization:`Bearer ${s}`}})}static async getStorageUsage(n){return(await rs.get(`${ss}/api/attachments/storage/usage`,{headers:{Authorization:`Bearer ${n}`}})).data}static formatFileSize(n){if(n===0)return"0 Bytes";if(n<0)return"Invalid size";const s=1024,o=["Bytes","KB","MB","GB","TB"],l=Math.min(Math.floor(Math.log(n)/Math.log(s)),o.length-1);return Math.round(n/Math.pow(s,l)*100)/100+" "+o[l]}static isValidFileType(n){return["image/jpeg","image/jpg","image/png","image/gif","image/webp","application/pdf"].includes(n.type)}static isValidFileSize(n,s=10){const o=s*1024*1024;return n.size<=o}static getFileTypeIcon(n){var o;switch((o=n.split(".").pop())==null?void 0:o.toLowerCase()){case"jpg":case"jpeg":case"png":case"gif":case"webp":return"ð¼ï¸";case"pdf":return"ð";default:return"ð"}}static isImage(n){var o;const s=(o=n.split(".").pop())==null?void 0:o.toLowerCase();return["jpg","jpeg","png","gif","webp"].includes(s||"")}}function dd({noteId:e,onUploadComplete:n,onError:s}){const[o,l]=f.useState(!1),[u,d]=f.useState(0),[m,y]=f.useState(null),[g,w]=f.useState(!1),b=f.useRef(null),C=D=>{D.preventDefault(),D.stopPropagation(),D.type==="dragenter"||D.type==="dragover"?w(!0):D.type==="dragleave"&&w(!1)},x=D=>{D.preventDefault(),D.stopPropagation(),w(!1),D.dataTransfer.files&&D.dataTransfer.files[0]&&j(D.dataTransfer.files[0])},j=D=>{if(!Et.isValidFileType(D)){s("Invalid file type. Only images (JPEG, PNG, GIF, WebP) and PDFs are allowed.");return}if(!Et.isValidFileSize(D)){s("File size exceeds 10MB limit.");return}y(D)},I=D=>{D.target.files&&D.target.files[0]&&j(D.target.files[0])},k=async()=>{if(!m)return;l(!0),d(0);let D=null;try{const q=localStorage.getItem("vibenote-token");if(!q)throw new Error("Not authenticated");D=setInterval(()=>{d(Q=>Q>=90?(D&&clearInterval(D),90):Q+10)},200);const O=await Et.uploadAttachment(e,m,q);D&&clearInterval(D),d(100),setTimeout(()=>{n(O.attachment),y(null),d(0),l(!1)},500)}catch(q){D&&clearInterval(D),l(!1),d(0);const O=q instanceof Error?q.message:"Failed to upload file";s(O)}},M=()=>{y(null),d(0),b.current&&(b.current.value="")};return t.jsx(cn,{className:"mb-4",children:t.jsx(un,{className:"pt-6",children:m?t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex items-center gap-3 p-3 bg-muted rounded-lg",children:[Et.isImage(m.name)?t.jsx(gu,{className:"h-8 w-8 text-primary"}):t.jsx(_t,{className:"h-8 w-8 text-primary"}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("p",{className:"text-sm font-medium truncate",children:m.name}),t.jsx("p",{className:"text-xs text-muted-foreground",children:Et.formatFileSize(m.size)})]}),!o&&t.jsx(le,{variant:"ghost",size:"icon",onClick:M,children:t.jsx(Tt,{className:"h-4 w-4"})})]}),o&&t.jsxs("div",{className:"space-y-2",children:[t.jsx(Ss,{value:u}),t.jsxs("p",{className:"text-xs text-center text-muted-foreground",children:["Uploading... ",u,"%"]})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(le,{onClick:k,disabled:o,className:"flex-1",children:o?"Uploading...":"Upload"}),!o&&t.jsx(le,{variant:"outline",onClick:M,children:"Cancel"})]})]}):t.jsxs("div",{className:`border-2 border-dashed rounded-lg p-8 text-center transition-colors ${g?"border-primary bg-primary/5":"border-muted-foreground/25 hover:border-primary/50"}`,onDragEnter:C,onDragLeave:C,onDragOver:C,onDrop:x,children:[t.jsx(Ri,{className:"mx-auto h-12 w-12 text-muted-foreground mb-4"}),t.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Drag and drop a file here, or click to select"}),t.jsx("p",{className:"text-xs text-muted-foreground mb-4",children:"Supported: Images (JPEG, PNG, GIF, WebP) and PDFs â¢ Max 10MB"}),t.jsx(le,{variant:"outline",onClick:()=>{var D;return(D=b.current)==null?void 0:D.click()},children:"Select File"}),t.jsx("input",{ref:b,type:"file",className:"hidden",accept:"image/jpeg,image/jpg,image/png,image/gif,image/webp,application/pdf",onChange:I})]})})})}function hd({attachments:e,onDelete:n}){const[s,o]=f.useState(!1),[l,u]=f.useState(null),d=g=>{u(g),o(!0)},m=()=>{l&&(n(l),u(null)),o(!1)},y=g=>{window.open(g.url,"_blank")};return e.length===0?null:t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"space-y-2",children:[t.jsxs("h3",{className:"text-sm font-medium text-muted-foreground",children:["Attachments (",e.length,")"]}),t.jsx("div",{className:"space-y-2",children:e.map(g=>t.jsx(cn,{children:t.jsxs(un,{className:"p-3",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[Et.isImage(g.fileName)?t.jsx("div",{className:"relative w-16 h-16 flex-shrink-0 rounded overflow-hidden bg-muted",children:t.jsx("img",{src:g.url,alt:g.fileName,className:"w-full h-full object-cover",loading:"lazy"})}):t.jsx("div",{className:"w-16 h-16 flex-shrink-0 rounded bg-muted flex items-center justify-center text-2xl",children:Et.getFileTypeIcon(g.fileName)}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("p",{className:"text-sm font-medium truncate",children:g.fileName}),t.jsx("p",{className:"text-xs text-muted-foreground",children:Et.formatFileSize(g.size)})]}),t.jsxs("div",{className:"flex gap-1",children:[t.jsx(le,{variant:"ghost",size:"icon",onClick:()=>window.open(g.url,"_blank"),title:"Open in new tab","aria-label":`Open ${g.fileName} in new tab`,children:t.jsx(cu,{className:"h-4 w-4"})}),t.jsx(le,{variant:"ghost",size:"icon",onClick:()=>y(g),title:"Download","aria-label":`Download ${g.fileName}`,children:t.jsx(bi,{className:"h-4 w-4"})}),t.jsx(le,{variant:"ghost",size:"icon",onClick:()=>d(g.id),title:"Delete","aria-label":`Delete ${g.fileName}`,children:t.jsx(Yt,{className:"h-4 w-4 text-destructive"})})]})]}),Et.isImage(g.fileName)&&t.jsx("div",{className:"mt-3 rounded overflow-hidden",children:t.jsx("img",{src:g.url,alt:g.fileName,className:"w-full h-auto max-h-96 object-contain bg-muted",loading:"lazy"})})]})},g.id))})]}),t.jsx(Rn,{open:s,onOpenChange:o,children:t.jsxs(pn,{children:[t.jsxs(gn,{children:[t.jsx(xn,{children:"Delete Attachment"}),t.jsx(vn,{children:"Are you sure you want to delete this attachment? This action cannot be undone."})]}),t.jsxs(yn,{children:[t.jsx(wn,{children:"Cancel"}),t.jsx(bn,{onClick:m,children:"Delete"})]})]})})]})}function fd({noteId:e,onError:n}){const[s,o]=f.useState([]),[l,u]=f.useState(!1),[d,m]=f.useState(!1),[y,g]=f.useState(!0);f.useEffect(()=>{w()},[e]);const w=async()=>{u(!0);try{const x=localStorage.getItem("vibenote-token");if(!x)return;const j=await Et.getAttachmentsByNoteId(e,x);o(j)}catch(x){const j=x instanceof Error?x.message:"Failed to load attachments";n(j)}finally{u(!1)}},b=x=>{o(j=>[...j,x]),m(!1),n("")},C=async x=>{try{const j=localStorage.getItem("vibenote-token");if(!j)return;await Et.deleteAttachment(x,j),o(I=>I.filter(k=>k.id!==x))}catch(j){const I=j instanceof Error?j.message:"Failed to delete attachment";n(I)}};return t.jsxs("div",{className:"border-t pt-4 space-y-3",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs(le,{variant:"ghost",size:"sm",onClick:()=>g(!y),className:"gap-2 px-2 -ml-2",children:[t.jsx(ku,{className:"h-4 w-4"}),t.jsxs("span",{className:"font-medium",children:["Attachments (",s.length,")"]}),y?t.jsx(su,{className:"h-4 w-4"}):t.jsx(Ka,{className:"h-4 w-4"})]}),y&&t.jsx(le,{variant:d?"secondary":"outline",size:"sm",className:"h-8 px-2",onClick:()=>m(!d),title:d?"Cancel upload":"Add attachment",children:d?t.jsxs(t.Fragment,{children:[t.jsx(Tt,{className:"h-4 w-4 mr-1"}),"Cancel"]}):t.jsxs(t.Fragment,{children:[t.jsx(Cn,{className:"h-4 w-4 mr-1"}),"Add"]})})]}),y&&t.jsxs("div",{className:"space-y-3",children:[d&&t.jsx(dd,{noteId:e,onUploadComplete:b,onError:n}),l?t.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"Loading attachments..."}):t.jsx(hd,{attachments:s,onDelete:C})]})]})}function md(){const[e,n]=f.useState(null),[s,o]=f.useState(!0),[l,u]=f.useState(null);f.useEffect(()=>{d()},[]);const d=async()=>{try{const g=localStorage.getItem("vibenote-token");if(!g)throw new Error("Not authenticated");const w=await Et.getStorageUsage(g);n(w),u(null)}catch(g){const w=g instanceof Error?g.message:"Failed to load storage usage";u(w)}finally{o(!1)}};if(s)return t.jsx(cn,{className:"mb-4",children:t.jsx(un,{className:"pt-6",children:t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(pa,{className:"h-4 w-4 text-muted-foreground"}),t.jsx("span",{className:"text-sm font-medium",children:"Storage Usage"})]}),t.jsx("div",{className:"h-2 bg-muted rounded animate-pulse"}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Loading..."})]})})});if(l)return t.jsx(cn,{className:"mb-4",children:t.jsx(un,{className:"pt-6",children:t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(pa,{className:"h-4 w-4 text-muted-foreground"}),t.jsx("span",{className:"text-sm font-medium",children:"Storage Usage"})]}),t.jsxs("div",{className:"flex items-start gap-2 p-2 bg-destructive/10 rounded text-destructive text-xs",children:[t.jsx(Pa,{className:"h-4 w-4 flex-shrink-0 mt-0.5"}),t.jsxs("div",{children:[t.jsx("p",{children:"Failed to load storage information."}),t.jsx("button",{onClick:d,className:"underline hover:no-underline mt-1",children:"Try again"})]})]})]})})});if(!e)return null;const m=e.usage.totalBytes/e.limit.totalBytes*100,y=m>=80;return t.jsx(cn,{className:"mb-4",children:t.jsx(un,{className:"pt-6",children:t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(pa,{className:"h-4 w-4 text-muted-foreground"}),t.jsx("span",{className:"text-sm font-medium",children:"Storage Usage"})]}),t.jsxs("span",{className:"text-sm text-muted-foreground",children:[e.usage.totalMB.toFixed(2)," MB / ",e.limit.totalMB," MB"]})]}),t.jsx(Ss,{value:m,className:y?"bg-destructive/20":""}),y&&t.jsxs("div",{className:"flex items-start gap-2 p-2 bg-destructive/10 rounded text-destructive text-xs",children:[t.jsx(Pa,{className:"h-4 w-4 flex-shrink-0 mt-0.5"}),t.jsx("p",{children:"You're running low on storage space. Consider deleting some attachments or upgrading your plan."})]})]})})})}const pd=new Set;function gd(e){pd.forEach(n=>{try{n(e)}catch(s){console.error("Error in conflict listener:",s)}})}const ft={async getAll(e=!1){return e?je.notes.filter(n=>!n.deletedAt).reverse().sortBy("updatedAt"):je.notes.filter(n=>!n.isArchived&&!n.deletedAt).reverse().sortBy("updatedAt")},async getArchived(){return je.notes.filter(e=>e.isArchived&&!e.deletedAt).reverse().sortBy("updatedAt")},async getDeleted(){return je.notes.filter(e=>!!e.deletedAt).reverse().sortBy("updatedAt")},async getById(e){return je.notes.get(e)},async create(e){const n={...e,id:crypto.randomUUID(),version:1,createdAt:new Date,updatedAt:new Date};return await je.notes.add(n),await this.addToSyncQueue("CREATE",n.id,n),n},async update(e,n){const s=await je.notes.get(e);if(!s)return;const o={...s,...n,version:s.version+1,updatedAt:new Date};return await je.notes.put(o),await this.addToSyncQueue("UPDATE",e,n),o},async softDelete(e){const n=await je.notes.get(e);if(!n)return;const s={...n,deletedAt:new Date,updatedAt:new Date};return await je.notes.put(s),await this.addToSyncQueue("UPDATE",e,{deletedAt:s.deletedAt}),s},async restore(e){const n=await je.notes.get(e);if(!n)return;const s={...n,deletedAt:null,updatedAt:new Date};return await je.notes.put(s),await this.addToSyncQueue("UPDATE",e,{deletedAt:null}),s},async permanentDelete(e){await je.notes.delete(e),await this.addToSyncQueue("DELETE",e)},async search(e){const n=e.toLowerCase();return je.notes.filter(s=>!s.deletedAt&&(s.title.toLowerCase().includes(n)||s.content.toLowerCase().includes(n))).toArray()},async filterByTag(e){return je.notes.filter(n=>n.tags.includes(e)).toArray()},async syncFromServer(e){const n=[];return await je.transaction("rw",je.notes,async()=>{for(const s of e){const o=await je.notes.get(s.id);if(!o)await je.notes.put({...s,syncedAt:new Date});else if(s.version>o.version){if(!o.syncedAt||o.updatedAt>o.syncedAt){const u={noteId:s.id,localVersion:o.version,serverVersion:s.version,resolution:"server_wins"};n.push(u),gd(u)}await je.notes.put({...s,syncedAt:new Date})}}}),n},async addToSyncQueue(e,n,s){await je.syncQueue.add({action:e,noteId:n,data:s,timestamp:new Date,retryCount:0})},async getSyncQueue(){return je.syncQueue.orderBy("timestamp").toArray()},async removeSyncQueueItem(e){await je.syncQueue.delete(e)},async clear(){await je.notes.clear(),await je.syncQueue.clear()}};function yd(){const[e,n]=f.useState([]),[s,o]=f.useState([]),[l,u]=f.useState([]),[d,m]=f.useState(!0),[y,g]=f.useState(null),w=async()=>{try{m(!0);const T=await ft.getAll();n(T),g(null)}catch(T){const P=T instanceof Error?T.message:"Failed to load notes";g(P)}finally{m(!1)}},b=async()=>{try{const T=await ft.getArchived();o(T),g(null)}catch(T){const P=T instanceof Error?T.message:"Failed to load archived notes";g(P)}};return f.useEffect(()=>{w()},[]),{notes:e,archivedNotes:s,trashedNotes:l,isLoading:d,error:y,createNote:async(T,P,U=[])=>{try{const Y=or.getUser();if(!(Y!=null&&Y.id))throw new Error("User not authenticated");const J=await ft.create({userId:Y.id,title:T,content:P,tags:U,isPinned:!1,isArchived:!1});return n(ne=>[J,...ne]),g(null),J}catch(Y){const J=Y instanceof Error?Y.message:"Failed to create note";throw g(J),new Error(J)}},updateNote:async(T,P)=>{try{const U=await ft.getById(T);if(!U)return;const Y={...U,...P,id:T,version:U.version+1,updatedAt:new Date};return await ft.update(T,P),n(J=>J.map(ne=>ne.id===T?Y:ne)),g(null),Y}catch(U){const Y=U instanceof Error?U.message:"Failed to update note";throw g(Y),new Error(Y)}},deleteNote:async T=>{try{await ft.softDelete(T),n(P=>P.filter(U=>U.id!==T)),o(P=>P.filter(U=>U.id!==T)),g(null)}catch(P){const U=P instanceof Error?P.message:"Failed to delete note";throw g(U),new Error(U)}},searchNotes:async T=>{try{const P=await ft.search(T);n(P),g(null)}catch(P){const U=P instanceof Error?P.message:"Failed to search notes";g(U)}},filterByTag:async T=>{try{const P=await ft.filterByTag(T);n(P),g(null)}catch(P){const U=P instanceof Error?P.message:"Failed to filter notes";g(U)}},filterNotes:async T=>{try{let P=await ft.getAll();if(T.searchQuery&&T.searchQuery.trim()){const U=T.searchQuery.toLowerCase();P=P.filter(Y=>Y.title.toLowerCase().includes(U)||Y.content.toLowerCase().includes(U))}if(T.tags&&T.tags.length>0&&(P=P.filter(U=>T.tags.every(Y=>U.tags.includes(Y)))),T.dateRange){const{from:U,to:Y}=T.dateRange;P=P.filter(J=>{const ne=new Date(J.updatedAt);return ne>=U&&ne<=Y})}n(P),g(null)}catch(P){const U=P instanceof Error?P.message:"Failed to filter notes";g(U)}},getAllTags:()=>{const T=new Set;return e.forEach(P=>{P.tags.forEach(U=>T.add(U))}),Array.from(T).sort()},refresh:w,fetchArchivedNotes:b,fetchTrashedNotes:async()=>{try{const T=await ft.getDeleted();u(T),g(null)}catch(T){const P=T instanceof Error?T.message:"Failed to load trashed notes";g(P)}},restoreNote:async T=>{try{const P=await ft.restore(T);P&&(u(U=>U.filter(Y=>Y.id!==T)),n(U=>[P,...U])),g(null)}catch(P){const U=P instanceof Error?P.message:"Failed to restore note";throw g(U),new Error(U)}},permanentDeleteNote:async T=>{try{await ft.permanentDelete(T),u(P=>P.filter(U=>U.id!==T)),g(null)}catch(P){const U=P instanceof Error?P.message:"Failed to permanently delete note";throw g(U),new Error(U)}}}}const kr={MAX_RETRIES:5,BASE_DELAY_MS:1e3,MAX_DELAY_MS:32e3,JITTER_FACTOR:.1};function xd(e){const n=kr.BASE_DELAY_MS*Math.pow(2,e),s=Math.min(n,kr.MAX_DELAY_MS),o=s*kr.JITTER_FACTOR*(Math.random()-.5)*2;return Math.round(s+o)}const vd=new Set;function Vo(e,n,s){vd.forEach(o=>{try{o(e,n,s)}catch(l){console.error("Error in sync failure listener:",l)}})}const Yo={isOnline(){return navigator.onLine},async syncToServer(){var s;if(!this.isOnline())return{success:!1,errors:["Device is offline"]};const e=await ft.getSyncQueue(),n=[];for(const o of e)try{switch(o.action){case"CREATE":await He.post("/notes",o.data);break;case"UPDATE":await He.put(`/notes/${o.noteId}`,o.data);break;case"DELETE":await He.delete(`/notes/${o.noteId}`);break}o.id&&await ft.removeSyncQueueItem(o.id)}catch(l){if((l&&typeof l=="object"&&"response"in l?(s=l.response)==null?void 0:s.status:void 0)===404){o.id&&await ft.removeSyncQueueItem(o.id);continue}const d=l instanceof Error?l.message:"Unknown error";if(n.push(`Failed to sync ${o.action} for note ${o.noteId}: ${d}`),o.id)if(o.retryCount<kr.MAX_RETRIES){const y=xd(o.retryCount),g=new Date(Date.now()+y);await je.syncQueue.update(o.id,{retryCount:o.retryCount+1,timestamp:g}),Vo(o.noteId,d,!0)}else await ft.removeSyncQueueItem(o.id),n.push(`Max retries exceeded for ${o.action} on note ${o.noteId}, removed from queue`),Vo(o.noteId,`Sync permanently failed after ${kr.MAX_RETRIES} attempts`,!1)}return{success:n.length===0,errors:n}},async syncFromServer(){var e,n,s;if(!this.isOnline())return{success:!1,error:"Device is offline"};try{const o=await He.get("/notes");return{success:!0,conflicts:await ft.syncFromServer(o.data)}}catch(o){return{success:!1,error:o&&typeof o=="object"&&"response"in o&&((s=(n=(e=o.response)==null?void 0:e.data)==null?void 0:n.error)==null?void 0:s.message)||"Failed to sync from server"}}},async fullSync(){const e=await this.syncToServer(),n=await this.syncFromServer(),s=[...e.errors];return n.error&&s.push(n.error),{success:s.length===0,errors:s}},setupAutoSync(e){const n=async()=>{const s=await this.fullSync();e==null||e(s)};return window.addEventListener("online",n),()=>{window.removeEventListener("online",n)}}};function bd(){const[e,n]=f.useState(navigator.onLine);return f.useEffect(()=>{const s=()=>n(!0),o=()=>n(!1);return window.addEventListener("online",s),window.addEventListener("offline",o),()=>{window.removeEventListener("online",s),window.removeEventListener("offline",o)}},[]),e}function wd(){const[e,n]=f.useState(!1),[s,o]=f.useState(null),[l,u]=f.useState([]),d=bd(),m=async()=>{if(!d)return;n(!0),u([]);const y=await Yo.fullSync();n(!1),o(new Date),u(y.errors)};return f.useEffect(()=>Yo.setupAutoSync(g=>{o(new Date),u(g.errors)}),[]),{isOnline:d,isSyncing:e,lastSyncTime:s,syncErrors:l,sync:m}}const La=[{id:"blank",name:"Blank Note",description:"Start with an empty note",content:"",tags:[],icon:"ð"},{id:"meeting",name:"Meeting Notes",description:"Template for meeting notes",content:`# Meeting Notes

## Date
${new Date().toLocaleDateString()}

## Attendees
- 

## Agenda
1. 

## Discussion Points
- 

## Action Items
- [ ] 

## Next Steps
`,tags:["meeting"],icon:"ð¥"},{id:"daily",name:"Daily Note",description:"Daily journal template",content:`# Daily Note - ${new Date().toLocaleDateString()}

## Today's Goals
- [ ] 
- [ ] 
- [ ] 

## Notes
- 

## Reflections
- 

## Tomorrow's Priorities
- 
`,tags:["daily"],icon:"ð"},{id:"todo",name:"To-Do List",description:"Task list template",content:`# To-Do List

## High Priority
- [ ] 

## Medium Priority
- [ ] 

## Low Priority
- [ ] 

## Completed
- [x] 
`,tags:["todo"],icon:"â"},{id:"project",name:"Project Planning",description:"Template for project planning",content:`# Project: [Project Name]

## Overview
Brief description of the project

## Goals
- 

## Timeline
- Start Date: 
- End Date: 
- Milestones:
  - [ ] 

## Resources
- 

## Risks & Challenges
- 

## Success Metrics
- 
`,tags:["project","planning"],icon:"ð¯"},{id:"brainstorm",name:"Brainstorming",description:"Template for brainstorming sessions",content:`# Brainstorming Session

## Topic
[Topic Name]

## Ideas
1. 
2. 
3. 

## Pros & Cons
### Pros
- 

### Cons
- 

## Next Actions
- [ ] 
`,tags:["brainstorm","ideas"],icon:"ð¡"},{id:"research",name:"Research Notes",description:"Template for research and study notes",content:`# Research: [Topic]

## Source
- Title: 
- Author: 
- Date: 
- URL: 

## Key Points
- 

## Quotes
> 

## My Thoughts
- 

## References
1. 
`,tags:["research"],icon:"ð"},{id:"retrospective",name:"Retrospective",description:"Template for team retrospectives",content:`# Retrospective - ${new Date().toLocaleDateString()}

## What Went Well ð
- 

## What Could Be Improved ð§
- 

## Action Items ð
- [ ] 

## Appreciation ð
- 
`,tags:["retrospective","team"],icon:"ð"}];class Bt{static getAllTemplates(){const n=this.getCustomTemplates();return[...La,...n]}static getCustomTemplates(){try{const n=localStorage.getItem(this.CUSTOM_TEMPLATES_KEY);return n?JSON.parse(n):[]}catch{return[]}}static saveCustomTemplate(n){const s=this.getCustomTemplates(),o={...n,id:`custom_${Date.now()}_${Math.random().toString(36).substr(2,9)}`};return s.push(o),localStorage.setItem(this.CUSTOM_TEMPLATES_KEY,JSON.stringify(s)),o}static deleteCustomTemplate(n){const o=this.getCustomTemplates().filter(l=>l.id!==n);localStorage.setItem(this.CUSTOM_TEMPLATES_KEY,JSON.stringify(o))}static updateCustomTemplate(n,s){const o=this.getCustomTemplates(),l=o.findIndex(d=>d.id===n);if(l===-1)return null;const u={...o[l],...s};return o[l]=u,localStorage.setItem(this.CUSTOM_TEMPLATES_KEY,JSON.stringify(o)),u}static getTemplateById(n){return this.getAllTemplates().find(s=>s.id===n)}static createNoteFromTemplate(n){return{title:n.name,content:n.content,tags:[...n.tags]}}static getDailyNoteTitle(n=new Date){return`Daily Note - ${n.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}`}static getDailyNoteContent(n=new Date){return`# ${n.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}

## Today's Focus
- [ ] 
- [ ] 
- [ ] 

## Notes & Thoughts
- 

## Wins ð
- 

## Challenges ð¤
- 

## Gratitude ð
- 

## Tomorrow's Priorities
- 
`}static createDailyNote(n=new Date){return{title:this.getDailyNoteTitle(n),content:this.getDailyNoteContent(n),tags:["daily",n.toISOString().split("T")[0]]}}static isDailyNote(n,s=new Date){var l,u;const o=s.toISOString().split("T")[0];return((l=n.tags)==null?void 0:l.includes("daily"))&&((u=n.tags)==null?void 0:u.includes(o))}}xe(Bt,"CUSTOM_TEMPLATES_KEY","vibenotes_custom_templates");const sr=f.forwardRef(({className:e,onChange:n,...s},o)=>{const l=u=>{n==null||n(u)};return t.jsx(fi,{multiline:!0,minRows:3,inputRef:o,onChange:l,className:Oe("w-full",e),variant:"outlined",size:"small",slotProps:{input:{className:"!text-sm"}},sx:{"& .MuiOutlinedInput-root":{minHeight:"80px",alignItems:"flex-start",padding:"8px 12px","& fieldset":{borderColor:"divider"},"&:hover fieldset":{borderColor:"divider"},"&.Mui-focused fieldset":{borderColor:"primary.main",borderWidth:"2px"},"&.Mui-disabled":{opacity:.5,cursor:"not-allowed"}},"& .MuiInputBase-input":{padding:0,"&::placeholder":{color:"text.secondary",opacity:1}}},...s})});sr.displayName="Textarea";var Ts="Tabs",[jd]=Hc(Ts,[wi]),Xi=wi(),[kd,Qa]=jd(Ts),Ji=f.forwardRef((e,n)=>{const{__scopeTabs:s,value:o,onValueChange:l,defaultValue:u,orientation:d="horizontal",dir:m,activationMode:y="automatic",...g}=e,w=Bc(m),[b,C]=zc({prop:o,onChange:l,defaultProp:u??"",caller:Ts});return t.jsx(kd,{scope:s,baseId:Vc(),value:b,onValueChange:C,orientation:d,dir:w,activationMode:y,children:t.jsx(js.div,{dir:w,"data-orientation":d,...g,ref:n})})});Ji.displayName=Ts;var Zi="TabsList",el=f.forwardRef((e,n)=>{const{__scopeTabs:s,loop:o=!0,...l}=e,u=Qa(Zi,s),d=Xi(s);return t.jsx(Yc,{asChild:!0,...d,orientation:u.orientation,dir:u.dir,loop:o,children:t.jsx(js.div,{role:"tablist","aria-orientation":u.orientation,...l,ref:n})})});el.displayName=Zi;var tl="TabsTrigger",nl=f.forwardRef((e,n)=>{const{__scopeTabs:s,value:o,disabled:l=!1,...u}=e,d=Qa(tl,s),m=Xi(s),y=al(d.baseId,o),g=ol(d.baseId,o),w=o===d.value;return t.jsx(Kc,{asChild:!0,...m,focusable:!l,active:w,children:t.jsx(js.button,{type:"button",role:"tab","aria-selected":w,"aria-controls":g,"data-state":w?"active":"inactive","data-disabled":l?"":void 0,disabled:l,id:y,...u,ref:n,onMouseDown:ma(e.onMouseDown,b=>{!l&&b.button===0&&b.ctrlKey===!1?d.onValueChange(o):b.preventDefault()}),onKeyDown:ma(e.onKeyDown,b=>{[" ","Enter"].includes(b.key)&&d.onValueChange(o)}),onFocus:ma(e.onFocus,()=>{const b=d.activationMode!=="manual";!w&&!l&&b&&d.onValueChange(o)})})})});nl.displayName=tl;var rl="TabsContent",sl=f.forwardRef((e,n)=>{const{__scopeTabs:s,value:o,forceMount:l,children:u,...d}=e,m=Qa(rl,s),y=al(m.baseId,o),g=ol(m.baseId,o),w=o===m.value,b=f.useRef(w);return f.useEffect(()=>{const C=requestAnimationFrame(()=>b.current=!1);return()=>cancelAnimationFrame(C)},[]),t.jsx(Wc,{present:l||w,children:({present:C})=>t.jsx(js.div,{"data-state":w?"active":"inactive","data-orientation":m.orientation,role:"tabpanel","aria-labelledby":y,hidden:!C,id:g,tabIndex:0,...d,ref:n,style:{...e.style,animationDuration:b.current?"0s":void 0},children:C&&u})})});sl.displayName=rl;function al(e,n){return`${e}-trigger-${n}`}function ol(e,n){return`${e}-content-${n}`}var Cd=Ji,il=el,ll=nl,cl=sl;const Nd=Cd,ul=f.forwardRef(({className:e,...n},s)=>t.jsx(il,{ref:s,className:Oe("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e),...n}));ul.displayName=il.displayName;const Ra=f.forwardRef(({className:e,...n},s)=>t.jsx(ll,{ref:s,className:Oe("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",e),...n}));Ra.displayName=ll.displayName;const $a=f.forwardRef(({className:e,...n},s)=>t.jsx(cl,{ref:s,className:Oe("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...n}));$a.displayName=cl.displayName;const Dd=["ð","ð","ð","ð","ð","âï¸","ðï¸","ð","ð","ð","ð","ð"];function Sd({onSelectTemplate:e,onCreateDailyNote:n}){const[s,o]=f.useState(!1),[l,u]=f.useState("builtin"),[d,m]=f.useState(null),[y,g]=f.useState(!1),[w,b]=f.useState(!1),[C,x]=f.useState(null),[j,I]=f.useState(""),[k,M]=f.useState(""),[D,q]=f.useState(""),[O,Q]=f.useState(""),[T,P]=f.useState("ð"),[U,Y]=f.useState(!1),[J,ne]=f.useState(null),[G,oe]=f.useState(Bt.getCustomTemplates()),te=de=>{e(de),o(!1),m(null)},z=(de,Le)=>{Le.stopPropagation(),m(de)},K=()=>{g(!1),b(!1),x(null),I(""),M(""),q(""),Q(""),P("ð")},W=()=>{j.trim()&&(Bt.saveCustomTemplate({name:j,description:k,content:D,tags:O.split(",").map(de=>de.trim()).filter(Boolean),icon:T}),oe(Bt.getCustomTemplates()),K())},ee=()=>{!j.trim()||!C||(Bt.updateCustomTemplate(C,{name:j,description:k,content:D,tags:O.split(",").map(de=>de.trim()).filter(Boolean),icon:T}),oe(Bt.getCustomTemplates()),K())},ie=(de,Le)=>{Le.stopPropagation(),b(!0),g(!0),x(de.id),I(de.name),M(de.description),q(de.content),Q(de.tags.join(", ")),P(de.icon||"ð"),u("custom")},me=(de,Le)=>{Le.stopPropagation(),ne(de),Y(!0)},ke=()=>{J&&(Bt.deleteCustomTemplate(J.id),oe(Bt.getCustomTemplates()),(d==null?void 0:d.id)===J.id&&m(null)),Y(!1),ne(null)},Te=()=>{n(),o(!1)},Ae=(de,Le=!1)=>t.jsxs(cn,{className:`cursor-pointer hover:border-primary transition-all ${(d==null?void 0:d.id)===de.id?"border-primary ring-2 ring-primary/20":""}`,onClick:()=>te(de),children:[t.jsxs(Da,{className:"pb-2",children:[t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"text-2xl",children:de.icon}),t.jsx(Sa,{className:"text-base",children:de.name})]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(le,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:Ve=>z(de,Ve),title:"Preview",children:t.jsx(Cs,{className:"h-3.5 w-3.5"})}),Le&&t.jsxs(t.Fragment,{children:[t.jsx(le,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:Ve=>ie(de,Ve),title:"Edit",children:t.jsx(Ns,{className:"h-3.5 w-3.5"})}),t.jsx(le,{variant:"ghost",size:"icon",className:"h-7 w-7 text-destructive hover:text-destructive",onClick:Ve=>me(de,Ve),title:"Delete",children:t.jsx(Yt,{className:"h-3.5 w-3.5"})})]})]})]}),t.jsx(Oc,{className:"text-xs line-clamp-2",children:de.description})]}),t.jsx(un,{className:"pb-3",children:t.jsxs("div",{className:"flex flex-wrap gap-1",children:[de.tags.slice(0,3).map(Ve=>t.jsx("span",{className:"text-xs px-2 py-0.5 bg-primary/10 text-primary rounded-full",children:Ve},Ve)),de.tags.length>3&&t.jsxs("span",{className:"text-xs px-2 py-0.5 bg-muted text-muted-foreground rounded-full",children:["+",de.tags.length-3]})]})})]},de.id),Be=()=>t.jsxs(cn,{children:[t.jsx(Da,{children:t.jsx(Sa,{className:"text-base",children:w?"Edit Template":"Create Custom Template"})}),t.jsxs(un,{className:"space-y-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(yr,{children:"Icon"}),t.jsx("div",{className:"flex flex-wrap gap-2",children:Dd.map(de=>t.jsx("button",{type:"button",className:`text-2xl p-2 rounded-md transition-colors ${T===de?"bg-primary/20 ring-2 ring-primary":"hover:bg-muted"}`,onClick:()=>P(de),children:de},de))})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(yr,{htmlFor:"template-name",children:"Template Name"}),t.jsx(vt,{id:"template-name",value:j,onChange:de=>I(de.target.value),placeholder:"My Custom Template"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(yr,{htmlFor:"template-description",children:"Description"}),t.jsx(vt,{id:"template-description",value:k,onChange:de=>M(de.target.value),placeholder:"Brief description of this template"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(yr,{htmlFor:"template-content",children:"Content"}),t.jsx(sr,{id:"template-content",value:D,onChange:de=>q(de.target.value),placeholder:"Template content (Markdown supported)",rows:8,className:"font-mono text-sm"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(yr,{htmlFor:"template-tags",children:"Tags (comma-separated)"}),t.jsx(vt,{id:"template-tags",value:O,onChange:de=>Q(de.target.value),placeholder:"tag1, tag2, tag3"})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs(le,{onClick:w?ee:W,disabled:!j.trim(),className:"gap-2",children:[t.jsx(fn,{className:"h-4 w-4"}),w?"Update Template":"Save Template"]}),t.jsxs(le,{variant:"outline",onClick:K,className:"gap-2",children:[t.jsx(Tt,{className:"h-4 w-4"}),"Cancel"]})]})]})]});return t.jsxs(t.Fragment,{children:[t.jsxs(Fn,{open:s,onOpenChange:de=>{o(de),de||(m(null),K())},children:[t.jsx(qa,{asChild:!0,children:t.jsxs(le,{variant:"outline",size:"sm",className:"gap-2",children:[t.jsx(_t,{className:"h-4 w-4"}),"Templates"]})}),t.jsxs(dn,{className:"max-w-5xl max-h-[85vh] overflow-hidden flex flex-col",children:[t.jsxs(Gt,{children:[t.jsx(Qt,{children:"Choose a Template"}),t.jsx(mn,{children:"Start with a pre-made template or create your own"})]}),t.jsx("div",{className:"mb-4",children:t.jsxs(le,{onClick:Te,className:"w-full gap-2",variant:"default",children:[t.jsx(Oa,{className:"h-4 w-4"}),"Create Today's Daily Note"]})}),t.jsxs("div",{className:"flex gap-4 flex-1 min-h-0",children:[t.jsx("div",{className:"flex-1 flex flex-col min-h-0",children:t.jsxs(Nd,{value:l,onValueChange:de=>u(de),className:"flex-1 flex flex-col min-h-0",children:[t.jsxs(ul,{className:"grid w-full grid-cols-2 mb-4",children:[t.jsxs(Ra,{value:"builtin",children:["Built-in (",La.length,")"]}),t.jsxs(Ra,{value:"custom",children:["Custom (",G.length,")"]})]}),t.jsx($a,{value:"builtin",className:"flex-1 overflow-y-auto mt-0",children:t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:La.map(de=>Ae(de))})}),t.jsx($a,{value:"custom",className:"flex-1 overflow-y-auto mt-0",children:y?Be():t.jsxs(t.Fragment,{children:[G.length>0?t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 mb-4",children:G.map(de=>Ae(de,!0))}):t.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[t.jsx(_t,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),t.jsx("p",{children:"No custom templates yet"}),t.jsx("p",{className:"text-sm",children:"Create your first custom template below"})]}),t.jsxs(le,{variant:"outline",className:"w-full gap-2",onClick:()=>g(!0),children:[t.jsx(Cn,{className:"h-4 w-4"}),"Create Custom Template"]})]})})]})}),d&&t.jsxs("div",{className:"w-80 border-l pl-4 flex flex-col min-h-0",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsxs("h3",{className:"font-semibold flex items-center gap-2",children:[t.jsx("span",{className:"text-xl",children:d.icon}),d.name]}),t.jsx(le,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:()=>m(null),children:t.jsx(Tt,{className:"h-4 w-4"})})]}),t.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:d.description}),t.jsx("div",{className:"flex flex-wrap gap-1 mb-3",children:d.tags.map(de=>t.jsx("span",{className:"text-xs px-2 py-0.5 bg-primary/10 text-primary rounded-full",children:de},de))}),t.jsx("div",{className:"flex-1 overflow-y-auto bg-muted/50 rounded-md p-3",children:t.jsx("pre",{className:"text-xs font-mono whitespace-pre-wrap text-muted-foreground",children:d.content||"(Empty template)"})}),t.jsx(le,{className:"mt-3 w-full",onClick:()=>te(d),children:"Use This Template"})]})]})]})]}),t.jsx(Rn,{open:U,onOpenChange:Y,children:t.jsxs(pn,{children:[t.jsxs(gn,{children:[t.jsx(xn,{children:"Delete Template"}),t.jsxs(vn,{children:['Are you sure you want to delete "',J==null?void 0:J.name,'"? This action cannot be undone.']})]}),t.jsxs(yn,{children:[t.jsx(wn,{children:"Cancel"}),t.jsx(bn,{onClick:ke,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Delete"})]})]})})]})}function Md({open:e,onClose:n,onCreateSampleNotes:s}){const[o,l]=f.useState(0),u=[{icon:_t,title:"Offline First",description:"All your notes are stored locally and sync when online. Work anywhere, anytime."},{icon:ws,title:"Powerful Search",description:"Find anything instantly with full-text search and multi-tag filtering."},{icon:rr,title:"Smart Organization",description:"Use tags, templates, and pinning to keep your notes organized."},{icon:_c,title:"Lightning Fast",description:"Markdown editor with slash commands, auto-save, and keyboard shortcuts."},{icon:Ic,title:"Privacy Focused",description:"Your data stays yours. No tracking, no ads, just secure note-taking."}],d=()=>{o<u.length&&l(o+1)},m=()=>{o>0&&l(o-1)},y=()=>{s(),n()},g=()=>{n()};return f.useEffect(()=>{e&&l(0)},[e]),t.jsx(Fn,{open:e,onOpenChange:n,children:t.jsx(dn,{className:"sm:max-w-[600px]",children:o===0?t.jsxs(t.Fragment,{children:[t.jsxs(Gt,{children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx(Au,{className:"h-6 w-6 text-primary"}),t.jsx(Qt,{className:"text-2xl",children:"Welcome to VibeNotes!"})]}),t.jsx(mn,{className:"text-base",children:"Your offline-first, privacy-focused note-taking app. Let's get you started!"})]}),t.jsx("div",{className:"py-6",children:t.jsx("div",{className:"grid gap-4",children:u.map((w,b)=>{const C=w.icon;return t.jsxs("div",{className:"flex gap-4 items-start",children:[t.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-lg bg-primary/10 flex items-center justify-center",children:t.jsx(C,{className:"h-5 w-5 text-primary"})}),t.jsxs("div",{children:[t.jsx("h4",{className:"font-semibold mb-1",children:w.title}),t.jsx("p",{className:"text-sm text-muted-foreground",children:w.description})]})]},b)})})}),t.jsxs(Ln,{className:"flex justify-between sm:justify-between",children:[t.jsx(le,{variant:"ghost",onClick:g,children:"Skip"}),t.jsx(le,{onClick:y,children:"Get Started with Sample Notes"})]})]}):t.jsxs(t.Fragment,{children:[t.jsxs(Gt,{children:[t.jsx(Qt,{children:u[o-1].title}),t.jsx(mn,{children:u[o-1].description})]}),t.jsx("div",{className:"py-8 flex justify-center",children:(()=>{const w=u[o-1].icon;return t.jsx(w,{className:"h-24 w-24 text-primary"})})()}),t.jsxs(Ln,{className:"flex justify-between sm:justify-between",children:[t.jsxs("div",{className:"flex gap-2",children:[t.jsx(le,{variant:"ghost",onClick:g,children:"Skip Tour"}),o>1&&t.jsx(le,{variant:"outline",onClick:m,children:"Previous"})]}),t.jsxs("div",{className:"flex gap-2 items-center",children:[t.jsxs("span",{className:"text-sm text-muted-foreground",children:[o," / ",u.length]}),o<u.length?t.jsx(le,{onClick:d,children:"Next"}):t.jsx(le,{onClick:y,children:"Finish"})]})]})]})})})}const va="vibenotes_onboarding_completed",ba="vibenotes_sample_notes_created",Jn={hasCompletedOnboarding(){return localStorage.getItem(va)==="true"},completeOnboarding(){localStorage.setItem(va,"true")},resetOnboarding(){localStorage.removeItem(va),localStorage.removeItem(ba)},hasSampleNotes(){return localStorage.getItem(ba)==="true"},markSampleNotesCreated(){localStorage.setItem(ba,"true")},isFirstVisit(){return!this.hasCompletedOnboarding()}},Td=[{title:"ð Welcome to VibeNotes!",content:`# Welcome to VibeNotes!

Thank you for choosing VibeNotes - your offline-first, privacy-focused note-taking app.

## â¨ Key Features

- **Offline First**: All your notes are stored locally and sync when you're online
- **Markdown Support**: Write with full markdown formatting
- **Tags**: Organize notes with tags for easy filtering
- **Search**: Powerful full-text search across all your notes
- **Templates**: Quick-start with built-in templates
- **Attachments**: Add images and files to your notes
- **Dark Mode**: Easy on the eyes, day or night

## ð Getting Started

1. **Create a note**: Click the "New Note" button
2. **Use templates**: Click "Templates" for quick starts
3. **Add tags**: Organize with tags like #work #personal
4. **Search**: Use Ctrl+K to search anytime
5. **Pin important notes**: Keep them at the top

## ð¡ Pro Tips

- Use **Ctrl+S** to save manually
- **Slash commands** (/) for quick formatting
- **Multi-tag filter** to find notes with specific tags
- Check the **word count** at the bottom of the editor

## ð Your Privacy

- All notes stored locally in your browser
- End-to-end sync with your account
- No tracking, no ads, just notes

Happy note-taking! ð`,tags:["welcome","getting-started"],isPinned:!0,isArchived:!1},{title:"â¨ï¸ Keyboard Shortcuts",content:`# Keyboard Shortcuts

Master VibeNotes with these handy shortcuts!

## Essential Shortcuts

| Shortcut | Action |
|----------|--------|
| **Ctrl + S** | Save current note |
| **Ctrl + K** | Open search |
| **Ctrl + N** | Create new note |
| **Ctrl + /** | Toggle preview mode |

## Editor Shortcuts

| Shortcut | Action |
|----------|--------|
| **Ctrl + B** | Bold text |
| **Ctrl + I** | Italic text |
| **Ctrl + K** | Insert link |
| **/** | Slash commands menu |

## Navigation

| Shortcut | Action |
|----------|--------|
| **â/â** | Navigate note list |
| **Enter** | Open selected note |
| **Esc** | Close dialogs |

## Slash Commands

Type **/** in the editor to access:

- **/h1**, **/h2**, **/h3** - Headings
- **/bullet** - Bullet list
- **/numbered** - Numbered list
- **/code** - Code block
- **/quote** - Blockquote
- **/divider** - Horizontal rule
- **/table** - Insert table

## Tips

- Shortcuts work in both edit and preview modes
- Use slash commands for faster formatting
- Combine shortcuts for maximum productivity

*Bookmark this note for quick reference!*`,tags:["reference","shortcuts","tips"],isPinned:!1,isArchived:!1},{title:"ð Quick Start Guide",content:`# Quick Start Guide

Get up and running with VibeNotes in minutes!

## Step 1: Create Your First Note

1. Click **"New Note"** button (top left)
2. Give it a title
3. Start writing in markdown
4. Notes auto-save every second

## Step 2: Organize with Tags

Tags help you find notes quickly:

\`\`\`
Add tags like: #work #ideas #todo
\`\`\`

- Click any tag to filter notes
- Select multiple tags for AND filtering
- Clear filters to see all notes

## Step 3: Use Templates

Save time with templates:

1. Click **"Templates"** button
2. Choose from 8 built-in templates
3. Or create your own custom template

Popular templates:
- ð Daily Note
- ð¥ Meeting Notes
- â To-Do List
- ð¯ Project Planning

## Step 4: Search Everything

Find any note instantly:

- Press **Ctrl + K** to search
- Search in titles and content
- Filter by tags
- Combine search + tags

## Step 5: Attach Files

Add context to your notes:

- Drag and drop images
- Attach PDFs and documents
- 10MB limit per file
- Secure cloud storage

## Next Steps

- Explore slash commands (type **/*)
- Try dark mode (top right)
- Pin important notes
- Export notes (Markdown, JSON, PDF)

*Delete these sample notes when you're ready!*`,tags:["guide","getting-started"],isPinned:!1,isArchived:!1}],Ad={async saveVersion(e,n,s,o,l){try{const u=await je.noteVersions.where("noteId").equals(e).toArray(),d=u.length+1;if(await je.noteVersions.add({noteId:e,version:d,title:n,content:s,tags:o,createdAt:new Date,userId:l}),u.length>=50){const m=u.sort((y,g)=>y.version-g.version).slice(0,u.length-49);for(const y of m)y.id&&await je.noteVersions.delete(y.id)}}catch(u){throw u}},async getVersions(e){try{return await je.noteVersions.where("noteId").equals(e).reverse().sortBy("version")}catch{return[]}},async getVersion(e,n){try{return await je.noteVersions.where(["noteId","version"]).equals([e,n]).first()||null}catch{return null}},async deleteVersions(e){try{await je.noteVersions.where("noteId").equals(e).delete()}catch(n){throw n}},async getVersionCount(e){try{return await je.noteVersions.where("noteId").equals(e).count()}catch{return 0}}},$n=f.forwardRef(({className:e,children:n,orientation:s="vertical",...o},l)=>t.jsx(Qe,{ref:l,className:Oe("relative",e),sx:{overflow:s==="both"?"auto":s==="horizontal"?"hidden auto":"auto hidden",height:"100%",width:"100%","&::-webkit-scrollbar":{width:"10px",height:"10px"},"&::-webkit-scrollbar-track":{background:"transparent"},"&::-webkit-scrollbar-thumb":{backgroundColor:"rgba(155, 155, 155, 0.5)",borderRadius:"20px",border:"3px solid transparent",backgroundClip:"content-box"},"&::-webkit-scrollbar-thumb:hover":{backgroundColor:"rgba(155, 155, 155, 0.7)"},scrollbarWidth:"thin",scrollbarColor:"rgba(155, 155, 155, 0.5) transparent"},...o,children:n}));$n.displayName="ScrollArea";const Pd=f.forwardRef(({className:e,orientation:n="vertical",...s},o)=>t.jsx("div",{ref:o,className:Oe("hidden",e),...s}));Pd.displayName="ScrollBar";function et(e){const n=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&n==="[object Date]"?new e.constructor(+e):typeof e=="number"||n==="[object Number]"||typeof e=="string"||n==="[object String]"?new Date(e):new Date(NaN)}function jn(e,n){return e instanceof Date?new e.constructor(n):new Date(n)}const dl=6048e5,Od=864e5,as=43200,Ko=1440;let Ed={};function Er(){return Ed}function Mr(e,n){var m,y,g,w;const s=Er(),o=(n==null?void 0:n.weekStartsOn)??((y=(m=n==null?void 0:n.locale)==null?void 0:m.options)==null?void 0:y.weekStartsOn)??s.weekStartsOn??((w=(g=s.locale)==null?void 0:g.options)==null?void 0:w.weekStartsOn)??0,l=et(e),u=l.getDay(),d=(u<o?7:0)+u-o;return l.setDate(l.getDate()-d),l.setHours(0,0,0,0),l}function ys(e){return Mr(e,{weekStartsOn:1})}function hl(e){const n=et(e),s=n.getFullYear(),o=jn(e,0);o.setFullYear(s+1,0,4),o.setHours(0,0,0,0);const l=ys(o),u=jn(e,0);u.setFullYear(s,0,4),u.setHours(0,0,0,0);const d=ys(u);return n.getTime()>=l.getTime()?s+1:n.getTime()>=d.getTime()?s:s-1}function Wo(e){const n=et(e);return n.setHours(0,0,0,0),n}function xs(e){const n=et(e),s=new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds()));return s.setUTCFullYear(n.getFullYear()),+e-+s}function _d(e,n){const s=Wo(e),o=Wo(n),l=+s-xs(s),u=+o-xs(o);return Math.round((l-u)/Od)}function Id(e){const n=hl(e),s=jn(e,0);return s.setFullYear(n,0,4),s.setHours(0,0,0,0),ys(s)}function ls(e,n){const s=et(e),o=et(n),l=s.getTime()-o.getTime();return l<0?-1:l>0?1:l}function Fd(e){return jn(e,Date.now())}function Ld(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function Rd(e){if(!Ld(e)&&typeof e!="number")return!1;const n=et(e);return!isNaN(Number(n))}function $d(e,n){const s=et(e),o=et(n),l=s.getFullYear()-o.getFullYear(),u=s.getMonth()-o.getMonth();return l*12+u}function Bd(e){return n=>{const o=(e?Math[e]:Math.trunc)(n);return o===0?0:o}}function zd(e,n){return+et(e)-+et(n)}function Vd(e){const n=et(e);return n.setHours(23,59,59,999),n}function Yd(e){const n=et(e),s=n.getMonth();return n.setFullYear(n.getFullYear(),s+1,0),n.setHours(23,59,59,999),n}function Kd(e){const n=et(e);return+Vd(n)==+Yd(n)}function Wd(e,n){const s=et(e),o=et(n),l=ls(s,o),u=Math.abs($d(s,o));let d;if(u<1)d=0;else{s.getMonth()===1&&s.getDate()>27&&s.setDate(30),s.setMonth(s.getMonth()-l*u);let m=ls(s,o)===-l;Kd(et(e))&&u===1&&ls(e,o)===1&&(m=!1),d=l*(u-Number(m))}return d===0?0:d}function Hd(e,n,s){const o=zd(e,n)/1e3;return Bd(s==null?void 0:s.roundingMethod)(o)}function Ud(e){const n=et(e),s=jn(e,0);return s.setFullYear(n.getFullYear(),0,1),s.setHours(0,0,0,0),s}const qd={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},Gd=(e,n,s)=>{let o;const l=qd[e];return typeof l=="string"?o=l:n===1?o=l.one:o=l.other.replace("{{count}}",n.toString()),s!=null&&s.addSuffix?s.comparison&&s.comparison>0?"in "+o:o+" ago":o};function wa(e){return(n={})=>{const s=n.width?String(n.width):e.defaultWidth;return e.formats[s]||e.formats[e.defaultWidth]}}const Qd={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},Xd={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},Jd={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},Zd={date:wa({formats:Qd,defaultWidth:"full"}),time:wa({formats:Xd,defaultWidth:"full"}),dateTime:wa({formats:Jd,defaultWidth:"full"})},eh={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},th=(e,n,s,o)=>eh[e];function xr(e){return(n,s)=>{const o=s!=null&&s.context?String(s.context):"standalone";let l;if(o==="formatting"&&e.formattingValues){const d=e.defaultFormattingWidth||e.defaultWidth,m=s!=null&&s.width?String(s.width):d;l=e.formattingValues[m]||e.formattingValues[d]}else{const d=e.defaultWidth,m=s!=null&&s.width?String(s.width):e.defaultWidth;l=e.values[m]||e.values[d]}const u=e.argumentCallback?e.argumentCallback(n):n;return l[u]}}const nh={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},rh={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},sh={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},ah={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},oh={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},ih={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},lh=(e,n)=>{const s=Number(e),o=s%100;if(o>20||o<10)switch(o%10){case 1:return s+"st";case 2:return s+"nd";case 3:return s+"rd"}return s+"th"},ch={ordinalNumber:lh,era:xr({values:nh,defaultWidth:"wide"}),quarter:xr({values:rh,defaultWidth:"wide",argumentCallback:e=>e-1}),month:xr({values:sh,defaultWidth:"wide"}),day:xr({values:ah,defaultWidth:"wide"}),dayPeriod:xr({values:oh,defaultWidth:"wide",formattingValues:ih,defaultFormattingWidth:"wide"})};function vr(e){return(n,s={})=>{const o=s.width,l=o&&e.matchPatterns[o]||e.matchPatterns[e.defaultMatchWidth],u=n.match(l);if(!u)return null;const d=u[0],m=o&&e.parsePatterns[o]||e.parsePatterns[e.defaultParseWidth],y=Array.isArray(m)?dh(m,b=>b.test(d)):uh(m,b=>b.test(d));let g;g=e.valueCallback?e.valueCallback(y):y,g=s.valueCallback?s.valueCallback(g):g;const w=n.slice(d.length);return{value:g,rest:w}}}function uh(e,n){for(const s in e)if(Object.prototype.hasOwnProperty.call(e,s)&&n(e[s]))return s}function dh(e,n){for(let s=0;s<e.length;s++)if(n(e[s]))return s}function hh(e){return(n,s={})=>{const o=n.match(e.matchPattern);if(!o)return null;const l=o[0],u=n.match(e.parsePattern);if(!u)return null;let d=e.valueCallback?e.valueCallback(u[0]):u[0];d=s.valueCallback?s.valueCallback(d):d;const m=n.slice(l.length);return{value:d,rest:m}}}const fh=/^(\d+)(th|st|nd|rd)?/i,mh=/\d+/i,ph={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},gh={any:[/^b/i,/^(a|c)/i]},yh={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},xh={any:[/1/i,/2/i,/3/i,/4/i]},vh={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},bh={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},wh={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},jh={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},kh={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},Ch={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},Nh={ordinalNumber:hh({matchPattern:fh,parsePattern:mh,valueCallback:e=>parseInt(e,10)}),era:vr({matchPatterns:ph,defaultMatchWidth:"wide",parsePatterns:gh,defaultParseWidth:"any"}),quarter:vr({matchPatterns:yh,defaultMatchWidth:"wide",parsePatterns:xh,defaultParseWidth:"any",valueCallback:e=>e+1}),month:vr({matchPatterns:vh,defaultMatchWidth:"wide",parsePatterns:bh,defaultParseWidth:"any"}),day:vr({matchPatterns:wh,defaultMatchWidth:"wide",parsePatterns:jh,defaultParseWidth:"any"}),dayPeriod:vr({matchPatterns:kh,defaultMatchWidth:"any",parsePatterns:Ch,defaultParseWidth:"any"})},fl={code:"en-US",formatDistance:Gd,formatLong:Zd,formatRelative:th,localize:ch,match:Nh,options:{weekStartsOn:0,firstWeekContainsDate:1}};function Dh(e){const n=et(e);return _d(n,Ud(n))+1}function Sh(e){const n=et(e),s=+ys(n)-+Id(n);return Math.round(s/dl)+1}function ml(e,n){var w,b,C,x;const s=et(e),o=s.getFullYear(),l=Er(),u=(n==null?void 0:n.firstWeekContainsDate)??((b=(w=n==null?void 0:n.locale)==null?void 0:w.options)==null?void 0:b.firstWeekContainsDate)??l.firstWeekContainsDate??((x=(C=l.locale)==null?void 0:C.options)==null?void 0:x.firstWeekContainsDate)??1,d=jn(e,0);d.setFullYear(o+1,0,u),d.setHours(0,0,0,0);const m=Mr(d,n),y=jn(e,0);y.setFullYear(o,0,u),y.setHours(0,0,0,0);const g=Mr(y,n);return s.getTime()>=m.getTime()?o+1:s.getTime()>=g.getTime()?o:o-1}function Mh(e,n){var m,y,g,w;const s=Er(),o=(n==null?void 0:n.firstWeekContainsDate)??((y=(m=n==null?void 0:n.locale)==null?void 0:m.options)==null?void 0:y.firstWeekContainsDate)??s.firstWeekContainsDate??((w=(g=s.locale)==null?void 0:g.options)==null?void 0:w.firstWeekContainsDate)??1,l=ml(e,n),u=jn(e,0);return u.setFullYear(l,0,o),u.setHours(0,0,0,0),Mr(u,n)}function Th(e,n){const s=et(e),o=+Mr(s,n)-+Mh(s,n);return Math.round(o/dl)+1}function Xe(e,n){const s=e<0?"-":"",o=Math.abs(e).toString().padStart(n,"0");return s+o}const ln={y(e,n){const s=e.getFullYear(),o=s>0?s:1-s;return Xe(n==="yy"?o%100:o,n.length)},M(e,n){const s=e.getMonth();return n==="M"?String(s+1):Xe(s+1,2)},d(e,n){return Xe(e.getDate(),n.length)},a(e,n){const s=e.getHours()/12>=1?"pm":"am";switch(n){case"a":case"aa":return s.toUpperCase();case"aaa":return s;case"aaaaa":return s[0];case"aaaa":default:return s==="am"?"a.m.":"p.m."}},h(e,n){return Xe(e.getHours()%12||12,n.length)},H(e,n){return Xe(e.getHours(),n.length)},m(e,n){return Xe(e.getMinutes(),n.length)},s(e,n){return Xe(e.getSeconds(),n.length)},S(e,n){const s=n.length,o=e.getMilliseconds(),l=Math.trunc(o*Math.pow(10,s-3));return Xe(l,n.length)}},Zn={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Ho={G:function(e,n,s){const o=e.getFullYear()>0?1:0;switch(n){case"G":case"GG":case"GGG":return s.era(o,{width:"abbreviated"});case"GGGGG":return s.era(o,{width:"narrow"});case"GGGG":default:return s.era(o,{width:"wide"})}},y:function(e,n,s){if(n==="yo"){const o=e.getFullYear(),l=o>0?o:1-o;return s.ordinalNumber(l,{unit:"year"})}return ln.y(e,n)},Y:function(e,n,s,o){const l=ml(e,o),u=l>0?l:1-l;if(n==="YY"){const d=u%100;return Xe(d,2)}return n==="Yo"?s.ordinalNumber(u,{unit:"year"}):Xe(u,n.length)},R:function(e,n){const s=hl(e);return Xe(s,n.length)},u:function(e,n){const s=e.getFullYear();return Xe(s,n.length)},Q:function(e,n,s){const o=Math.ceil((e.getMonth()+1)/3);switch(n){case"Q":return String(o);case"QQ":return Xe(o,2);case"Qo":return s.ordinalNumber(o,{unit:"quarter"});case"QQQ":return s.quarter(o,{width:"abbreviated",context:"formatting"});case"QQQQQ":return s.quarter(o,{width:"narrow",context:"formatting"});case"QQQQ":default:return s.quarter(o,{width:"wide",context:"formatting"})}},q:function(e,n,s){const o=Math.ceil((e.getMonth()+1)/3);switch(n){case"q":return String(o);case"qq":return Xe(o,2);case"qo":return s.ordinalNumber(o,{unit:"quarter"});case"qqq":return s.quarter(o,{width:"abbreviated",context:"standalone"});case"qqqqq":return s.quarter(o,{width:"narrow",context:"standalone"});case"qqqq":default:return s.quarter(o,{width:"wide",context:"standalone"})}},M:function(e,n,s){const o=e.getMonth();switch(n){case"M":case"MM":return ln.M(e,n);case"Mo":return s.ordinalNumber(o+1,{unit:"month"});case"MMM":return s.month(o,{width:"abbreviated",context:"formatting"});case"MMMMM":return s.month(o,{width:"narrow",context:"formatting"});case"MMMM":default:return s.month(o,{width:"wide",context:"formatting"})}},L:function(e,n,s){const o=e.getMonth();switch(n){case"L":return String(o+1);case"LL":return Xe(o+1,2);case"Lo":return s.ordinalNumber(o+1,{unit:"month"});case"LLL":return s.month(o,{width:"abbreviated",context:"standalone"});case"LLLLL":return s.month(o,{width:"narrow",context:"standalone"});case"LLLL":default:return s.month(o,{width:"wide",context:"standalone"})}},w:function(e,n,s,o){const l=Th(e,o);return n==="wo"?s.ordinalNumber(l,{unit:"week"}):Xe(l,n.length)},I:function(e,n,s){const o=Sh(e);return n==="Io"?s.ordinalNumber(o,{unit:"week"}):Xe(o,n.length)},d:function(e,n,s){return n==="do"?s.ordinalNumber(e.getDate(),{unit:"date"}):ln.d(e,n)},D:function(e,n,s){const o=Dh(e);return n==="Do"?s.ordinalNumber(o,{unit:"dayOfYear"}):Xe(o,n.length)},E:function(e,n,s){const o=e.getDay();switch(n){case"E":case"EE":case"EEE":return s.day(o,{width:"abbreviated",context:"formatting"});case"EEEEE":return s.day(o,{width:"narrow",context:"formatting"});case"EEEEEE":return s.day(o,{width:"short",context:"formatting"});case"EEEE":default:return s.day(o,{width:"wide",context:"formatting"})}},e:function(e,n,s,o){const l=e.getDay(),u=(l-o.weekStartsOn+8)%7||7;switch(n){case"e":return String(u);case"ee":return Xe(u,2);case"eo":return s.ordinalNumber(u,{unit:"day"});case"eee":return s.day(l,{width:"abbreviated",context:"formatting"});case"eeeee":return s.day(l,{width:"narrow",context:"formatting"});case"eeeeee":return s.day(l,{width:"short",context:"formatting"});case"eeee":default:return s.day(l,{width:"wide",context:"formatting"})}},c:function(e,n,s,o){const l=e.getDay(),u=(l-o.weekStartsOn+8)%7||7;switch(n){case"c":return String(u);case"cc":return Xe(u,n.length);case"co":return s.ordinalNumber(u,{unit:"day"});case"ccc":return s.day(l,{width:"abbreviated",context:"standalone"});case"ccccc":return s.day(l,{width:"narrow",context:"standalone"});case"cccccc":return s.day(l,{width:"short",context:"standalone"});case"cccc":default:return s.day(l,{width:"wide",context:"standalone"})}},i:function(e,n,s){const o=e.getDay(),l=o===0?7:o;switch(n){case"i":return String(l);case"ii":return Xe(l,n.length);case"io":return s.ordinalNumber(l,{unit:"day"});case"iii":return s.day(o,{width:"abbreviated",context:"formatting"});case"iiiii":return s.day(o,{width:"narrow",context:"formatting"});case"iiiiii":return s.day(o,{width:"short",context:"formatting"});case"iiii":default:return s.day(o,{width:"wide",context:"formatting"})}},a:function(e,n,s){const l=e.getHours()/12>=1?"pm":"am";switch(n){case"a":case"aa":return s.dayPeriod(l,{width:"abbreviated",context:"formatting"});case"aaa":return s.dayPeriod(l,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return s.dayPeriod(l,{width:"narrow",context:"formatting"});case"aaaa":default:return s.dayPeriod(l,{width:"wide",context:"formatting"})}},b:function(e,n,s){const o=e.getHours();let l;switch(o===12?l=Zn.noon:o===0?l=Zn.midnight:l=o/12>=1?"pm":"am",n){case"b":case"bb":return s.dayPeriod(l,{width:"abbreviated",context:"formatting"});case"bbb":return s.dayPeriod(l,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return s.dayPeriod(l,{width:"narrow",context:"formatting"});case"bbbb":default:return s.dayPeriod(l,{width:"wide",context:"formatting"})}},B:function(e,n,s){const o=e.getHours();let l;switch(o>=17?l=Zn.evening:o>=12?l=Zn.afternoon:o>=4?l=Zn.morning:l=Zn.night,n){case"B":case"BB":case"BBB":return s.dayPeriod(l,{width:"abbreviated",context:"formatting"});case"BBBBB":return s.dayPeriod(l,{width:"narrow",context:"formatting"});case"BBBB":default:return s.dayPeriod(l,{width:"wide",context:"formatting"})}},h:function(e,n,s){if(n==="ho"){let o=e.getHours()%12;return o===0&&(o=12),s.ordinalNumber(o,{unit:"hour"})}return ln.h(e,n)},H:function(e,n,s){return n==="Ho"?s.ordinalNumber(e.getHours(),{unit:"hour"}):ln.H(e,n)},K:function(e,n,s){const o=e.getHours()%12;return n==="Ko"?s.ordinalNumber(o,{unit:"hour"}):Xe(o,n.length)},k:function(e,n,s){let o=e.getHours();return o===0&&(o=24),n==="ko"?s.ordinalNumber(o,{unit:"hour"}):Xe(o,n.length)},m:function(e,n,s){return n==="mo"?s.ordinalNumber(e.getMinutes(),{unit:"minute"}):ln.m(e,n)},s:function(e,n,s){return n==="so"?s.ordinalNumber(e.getSeconds(),{unit:"second"}):ln.s(e,n)},S:function(e,n){return ln.S(e,n)},X:function(e,n,s){const o=e.getTimezoneOffset();if(o===0)return"Z";switch(n){case"X":return qo(o);case"XXXX":case"XX":return En(o);case"XXXXX":case"XXX":default:return En(o,":")}},x:function(e,n,s){const o=e.getTimezoneOffset();switch(n){case"x":return qo(o);case"xxxx":case"xx":return En(o);case"xxxxx":case"xxx":default:return En(o,":")}},O:function(e,n,s){const o=e.getTimezoneOffset();switch(n){case"O":case"OO":case"OOO":return"GMT"+Uo(o,":");case"OOOO":default:return"GMT"+En(o,":")}},z:function(e,n,s){const o=e.getTimezoneOffset();switch(n){case"z":case"zz":case"zzz":return"GMT"+Uo(o,":");case"zzzz":default:return"GMT"+En(o,":")}},t:function(e,n,s){const o=Math.trunc(e.getTime()/1e3);return Xe(o,n.length)},T:function(e,n,s){const o=e.getTime();return Xe(o,n.length)}};function Uo(e,n=""){const s=e>0?"-":"+",o=Math.abs(e),l=Math.trunc(o/60),u=o%60;return u===0?s+String(l):s+String(l)+n+Xe(u,2)}function qo(e,n){return e%60===0?(e>0?"-":"+")+Xe(Math.abs(e)/60,2):En(e,n)}function En(e,n=""){const s=e>0?"-":"+",o=Math.abs(e),l=Xe(Math.trunc(o/60),2),u=Xe(o%60,2);return s+l+n+u}const Go=(e,n)=>{switch(e){case"P":return n.date({width:"short"});case"PP":return n.date({width:"medium"});case"PPP":return n.date({width:"long"});case"PPPP":default:return n.date({width:"full"})}},pl=(e,n)=>{switch(e){case"p":return n.time({width:"short"});case"pp":return n.time({width:"medium"});case"ppp":return n.time({width:"long"});case"pppp":default:return n.time({width:"full"})}},Ah=(e,n)=>{const s=e.match(/(P+)(p+)?/)||[],o=s[1],l=s[2];if(!l)return Go(e,n);let u;switch(o){case"P":u=n.dateTime({width:"short"});break;case"PP":u=n.dateTime({width:"medium"});break;case"PPP":u=n.dateTime({width:"long"});break;case"PPPP":default:u=n.dateTime({width:"full"});break}return u.replace("{{date}}",Go(o,n)).replace("{{time}}",pl(l,n))},Ph={p:pl,P:Ah},Oh=/^D+$/,Eh=/^Y+$/,_h=["D","DD","YY","YYYY"];function Ih(e){return Oh.test(e)}function Fh(e){return Eh.test(e)}function Lh(e,n,s){const o=Rh(e,n,s);if(console.warn(o),_h.includes(e))throw new RangeError(o)}function Rh(e,n,s){const o=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${n}\`) for formatting ${o} to the input \`${s}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const $h=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Bh=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,zh=/^'([^]*?)'?$/,Vh=/''/g,Yh=/[a-zA-Z]/;function Qo(e,n,s){var w,b,C,x;const o=Er(),l=o.locale??fl,u=o.firstWeekContainsDate??((b=(w=o.locale)==null?void 0:w.options)==null?void 0:b.firstWeekContainsDate)??1,d=o.weekStartsOn??((x=(C=o.locale)==null?void 0:C.options)==null?void 0:x.weekStartsOn)??0,m=et(e);if(!Rd(m))throw new RangeError("Invalid time value");let y=n.match(Bh).map(j=>{const I=j[0];if(I==="p"||I==="P"){const k=Ph[I];return k(j,l.formatLong)}return j}).join("").match($h).map(j=>{if(j==="''")return{isToken:!1,value:"'"};const I=j[0];if(I==="'")return{isToken:!1,value:Kh(j)};if(Ho[I])return{isToken:!0,value:j};if(I.match(Yh))throw new RangeError("Format string contains an unescaped latin alphabet character `"+I+"`");return{isToken:!1,value:j}});l.localize.preprocessor&&(y=l.localize.preprocessor(m,y));const g={firstWeekContainsDate:u,weekStartsOn:d,locale:l};return y.map(j=>{if(!j.isToken)return j.value;const I=j.value;(Fh(I)||Ih(I))&&Lh(I,n,String(e));const k=Ho[I[0]];return k(m,I,l.localize,g)}).join("")}function Kh(e){const n=e.match(zh);return n?n[1].replace(Vh,"'"):e}function Wh(e,n,s){const o=Er(),l=(s==null?void 0:s.locale)??o.locale??fl,u=2520,d=ls(e,n);if(isNaN(d))throw new RangeError("Invalid time value");const m=Object.assign({},s,{addSuffix:s==null?void 0:s.addSuffix,comparison:d});let y,g;d>0?(y=et(n),g=et(e)):(y=et(e),g=et(n));const w=Hd(g,y),b=(xs(g)-xs(y))/1e3,C=Math.round((w-b)/60);let x;if(C<2)return s!=null&&s.includeSeconds?w<5?l.formatDistance("lessThanXSeconds",5,m):w<10?l.formatDistance("lessThanXSeconds",10,m):w<20?l.formatDistance("lessThanXSeconds",20,m):w<40?l.formatDistance("halfAMinute",0,m):w<60?l.formatDistance("lessThanXMinutes",1,m):l.formatDistance("xMinutes",1,m):C===0?l.formatDistance("lessThanXMinutes",1,m):l.formatDistance("xMinutes",C,m);if(C<45)return l.formatDistance("xMinutes",C,m);if(C<90)return l.formatDistance("aboutXHours",1,m);if(C<Ko){const j=Math.round(C/60);return l.formatDistance("aboutXHours",j,m)}else{if(C<u)return l.formatDistance("xDays",1,m);if(C<as){const j=Math.round(C/Ko);return l.formatDistance("xDays",j,m)}else if(C<as*2)return x=Math.round(C/as),l.formatDistance("aboutXMonths",x,m)}if(x=Wd(g,y),x<12){const j=Math.round(C/as);return l.formatDistance("xMonths",j,m)}else{const j=x%12,I=Math.trunc(x/12);return j<3?l.formatDistance("aboutXYears",I,m):j<9?l.formatDistance("overXYears",I,m):l.formatDistance("almostXYears",I+1,m)}}function Hh(e,n){return Wh(e,Fd(e),n)}function Uh({noteId:e,onRestore:n,onClose:s}){const[o,l]=f.useState([]),[u,d]=f.useState(null),[m,y]=f.useState(!0),[g,w]=f.useState(null);f.useEffect(()=>{b()},[e]);const b=async()=>{y(!0),w(null);try{const x=await Ad.getVersions(e);l(x)}catch(x){const j=x instanceof Error?x.message:"Failed to load version history";w(j)}finally{y(!1)}},C=x=>{confirm(`Restore to version ${x.version}? This will create a new version with the restored content.`)&&(n(x),s())};return m?t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsxs("div",{className:"text-center",children:[t.jsx(Ma,{className:"h-8 w-8 text-muted-foreground mx-auto mb-2 animate-spin"}),t.jsx("p",{className:"text-muted-foreground",children:"Loading versions..."})]})}):g?t.jsxs("div",{className:"flex flex-col items-center justify-center h-64 space-y-4",children:[t.jsx(Pa,{className:"h-12 w-12 text-destructive"}),t.jsx("p",{className:"text-destructive font-medium",children:"Failed to load version history"}),t.jsx("p",{className:"text-sm text-muted-foreground",children:g}),t.jsxs(le,{onClick:b,variant:"outline",size:"sm",children:[t.jsx(Ma,{className:"h-4 w-4 mr-2"}),"Try Again"]})]}):o.length===0?t.jsxs("div",{className:"flex flex-col items-center justify-center h-64 space-y-4",children:[t.jsx(Wa,{className:"h-12 w-12 text-muted-foreground"}),t.jsx("p",{className:"text-muted-foreground",children:"No version history yet"}),t.jsx("p",{className:"text-sm text-muted-foreground",children:"Versions are saved automatically when you edit this note"})]}):t.jsxs("div",{className:"flex flex-col h-full",children:[t.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[t.jsx("h3",{className:"text-lg font-semibold",children:"Version History"}),t.jsx(le,{variant:"ghost",size:"sm",onClick:s,children:"Close"})]}),t.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[t.jsx("div",{className:"w-64 border-r",children:t.jsx($n,{className:"h-full",children:t.jsx("div",{className:"p-2 space-y-1",children:o.map(x=>t.jsxs("button",{onClick:()=>d(x),className:`w-full text-left p-3 rounded-md transition-colors ${(u==null?void 0:u.id)===x.id?"bg-accent text-accent-foreground":"hover:bg-accent/50"}`,children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("span",{className:"font-medium text-sm",children:["Version ",x.version]}),x.id===o[0].id&&t.jsx("span",{className:"text-xs bg-primary text-primary-foreground px-2 py-0.5 rounded",children:"Latest"})]}),t.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:Hh(new Date(x.createdAt),{addSuffix:!0})})]},x.id))})})}),t.jsx("div",{className:"flex-1 flex flex-col",children:u?t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"p-4 border-b",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h4",{className:"font-semibold",children:u.title}),t.jsx("p",{className:"text-sm text-muted-foreground",children:new Date(u.createdAt).toLocaleString()})]}),t.jsxs(le,{onClick:()=>C(u),size:"sm",className:"gap-2",children:[t.jsx(Su,{className:"h-4 w-4"}),"Restore"]})]}),u.tags.length>0&&t.jsx("div",{className:"flex gap-2 mt-2",children:u.tags.map(x=>t.jsx("span",{className:"text-xs bg-secondary text-secondary-foreground px-2 py-1 rounded",children:x},x))})]}),t.jsx($n,{className:"flex-1",children:t.jsx("div",{className:"p-4",children:t.jsx("pre",{className:"whitespace-pre-wrap font-mono text-sm",children:u.content})})})]}):t.jsx("div",{className:"flex items-center justify-center h-full",children:t.jsx("p",{className:"text-muted-foreground",children:"Select a version to view"})})})]})]})}const qh=[{title:"General",shortcuts:[{keys:["Ctrl/Cmd","?"],description:"Show keyboard shortcuts"},{keys:["Ctrl/Cmd","S"],description:"Save current note"},{keys:["Ctrl/Cmd","Shift","C"],description:"Copy note content"},{keys:["Ctrl/Cmd","Shift","F"],description:"Toggle distraction-free mode"},{keys:["Esc"],description:"Exit distraction-free mode"}]},{title:"Formatting",shortcuts:[{keys:["Ctrl/Cmd","B"],description:"Bold text"},{keys:["Ctrl/Cmd","I"],description:"Italic text"},{keys:["Ctrl/Cmd","K"],description:"Insert link"},{keys:["/"],description:"Open slash command menu"}]},{title:"Navigation",shortcuts:[{keys:["Tab"],description:"Navigate between elements"}]},{title:"Slash Commands",shortcuts:[{keys:["/h1"],description:"Heading 1"},{keys:["/h2"],description:"Heading 2"},{keys:["/h3"],description:"Heading 3"},{keys:["/bullet"],description:"Bullet list"},{keys:["/number"],description:"Numbered list"},{keys:["/check"],description:"Checkbox"},{keys:["/code"],description:"Code block"},{keys:["/quote"],description:"Blockquote"},{keys:["/table"],description:"Table"},{keys:["/divider"],description:"Horizontal divider"}]}];function Gh({isOpen:e,onClose:n}){return f.useEffect(()=>{const s=o=>{o.key==="Escape"&&e&&n()};return window.addEventListener("keydown",s),()=>window.removeEventListener("keydown",s)},[e,n]),e?t.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-background rounded-lg shadow-lg w-full max-w-2xl mx-4 max-h-[80vh] sm:max-h-[85vh] overflow-hidden flex flex-col",children:[t.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Oi,{className:"h-5 w-5"}),t.jsx("h2",{className:"text-lg font-semibold",children:"Keyboard Shortcuts"})]}),t.jsx(le,{variant:"ghost",size:"icon",onClick:n,"aria-label":"Close keyboard shortcuts panel",children:t.jsx(Tt,{className:"h-4 w-4"})})]}),t.jsx("div",{className:"p-4 overflow-y-auto flex-1 min-h-0",children:t.jsx("div",{className:"grid gap-6",children:qh.map(s=>t.jsxs("div",{children:[t.jsx("h3",{className:"text-sm font-semibold text-muted-foreground mb-3",children:s.title}),t.jsx("div",{className:"space-y-2",children:s.shortcuts.map((o,l)=>t.jsxs("div",{className:"flex items-center justify-between py-2 px-3 rounded-md hover:bg-accent/50",children:[t.jsx("span",{className:"text-sm",children:o.description}),t.jsx("div",{className:"flex items-center gap-1",children:o.keys.map((u,d)=>t.jsxs("span",{children:[t.jsx("kbd",{className:"px-2 py-1 text-xs font-mono bg-muted rounded border border-border",children:u}),d<o.keys.length-1&&t.jsx("span",{className:"mx-1 text-muted-foreground",children:"+"})]},d))})]},l))})]},s.title))})}),t.jsx("div",{className:"p-4 border-t bg-muted/30",children:t.jsxs("p",{className:"text-xs text-muted-foreground text-center",children:["Press ",t.jsx("kbd",{className:"px-1.5 py-0.5 text-xs font-mono bg-muted rounded border",children:"Esc"})," to close"]})})]})}):null}function Qh(){const[e,n]=f.useState([]),[s,o]=f.useState([]),[l,u]=f.useState(!0),[d,m]=f.useState(null),y=f.useCallback(k=>{const M=new Map;k.forEach(O=>{M.set(O.id,{...O,children:[],noteCount:O.noteCount||0})});const D=[];k.forEach(O=>{const Q=M.get(O.id);O.parentId&&M.has(O.parentId)?M.get(O.parentId).children.push(Q):D.push(Q)});const q=O=>{O.sort((Q,T)=>Q.name.localeCompare(T.name)),O.forEach(Q=>q(Q.children))};return q(D),D},[]),g=f.useCallback(async()=>{try{u(!0);try{const M=(await He.get("/api/folders")).data;await je.transaction("rw",je.folders,async()=>{await je.folders.clear(),await je.folders.bulkPut(M.map(D=>({...D,syncedAt:new Date})))}),n(M),o(y(M))}catch{const k=await je.folders.toArray(),M=await je.notes.filter(q=>!q.deletedAt).toArray(),D=k.map(q=>({...q,childCount:k.filter(O=>O.parentId===q.id).length,noteCount:M.filter(O=>O.folderId===q.id).length}));n(D),o(y(D))}m(null)}catch(k){const M=k instanceof Error?k.message:"Failed to load folders";m(M)}finally{u(!1)}},[y]);f.useEffect(()=>{g()},[g]);const w=f.useCallback(async(k,M=null)=>{try{const D=or.getUser();if(!(D!=null&&D.id))throw new Error("User not authenticated");const O=(await He.post("/api/folders",{name:k,parentId:M})).data;return await je.folders.put({...O,syncedAt:new Date}),await g(),O}catch(D){const q=D instanceof Error?D.message:"Failed to create folder";throw m(q),new Error(q)}},[g]),b=f.useCallback(async(k,M)=>{try{const q=(await He.put(`/api/folders/${k}`,M)).data;return await je.folders.put({...q,syncedAt:new Date}),await g(),q}catch(D){const q=D instanceof Error?D.message:"Failed to update folder";throw m(q),new Error(q)}},[g]),C=f.useCallback(async k=>{try{await He.delete(`/api/folders/${k}`),await je.folders.delete(k),await g()}catch(M){const D=M instanceof Error?M.message:"Failed to delete folder";throw m(D),new Error(D)}},[g]),x=f.useCallback(async(k,M)=>{try{await He.put(`/api/folders/notes/${k}/move`,{folderId:M});const D=await je.notes.get(k);D&&await je.notes.put({...D,folderId:M}),await g()}catch(D){const q=D instanceof Error?D.message:"Failed to move note";throw m(q),new Error(q)}},[g]),j=f.useCallback(k=>e.find(M=>M.id===k),[e]),I=f.useCallback(k=>{const M=[];let D=k;for(;D;){const q=e.find(O=>O.id===D);if(!q)break;M.unshift(q),D=q.parentId}return M},[e]);return{folders:e,folderTree:s,isLoading:l,error:d,createFolder:w,updateFolder:b,deleteFolder:C,moveNoteToFolder:x,getFolderById:j,getFolderPath:I,refresh:g}}function gl({folder:e,level:n,selectedFolderId:s,onSelectFolder:o,onCreateSubfolder:l,onRenameFolder:u,onDeleteFolder:d}){const[m,y]=f.useState(!1),g=e.children.length>0,w=s===e.id;return t.jsxs("div",{children:[t.jsxs("div",{className:Oe("flex items-center gap-1 py-1 px-2 rounded-md cursor-pointer group hover:bg-accent",w&&"bg-accent"),style:{paddingLeft:`${n*16+8}px`},children:[t.jsx("button",{onClick:b=>{b.stopPropagation(),y(!m)},className:Oe("h-4 w-4 flex items-center justify-center",!g&&"invisible"),children:m?t.jsx(Ka,{className:"h-3 w-3"}):t.jsx(Si,{className:"h-3 w-3"})}),t.jsxs("button",{onClick:()=>o(e.id),className:"flex-1 flex items-center gap-2 text-sm text-left",children:[t.jsx(Ai,{className:"h-4 w-4 text-muted-foreground"}),t.jsx("span",{className:"truncate",children:e.name}),e.noteCount>0&&t.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",e.noteCount,")"]})]}),t.jsxs(gs,{children:[t.jsx(Nr,{asChild:!0,children:t.jsx(le,{variant:"ghost",size:"icon",className:"h-6 w-6 opacity-0 group-hover:opacity-100",onClick:b=>b.stopPropagation(),children:t.jsx(_i,{className:"h-3 w-3"})})}),t.jsxs(Dr,{align:"end",children:[t.jsxs(ht,{onClick:()=>l(e.id),children:[t.jsx(Ti,{className:"h-4 w-4 mr-2"}),"New Subfolder"]}),t.jsxs(ht,{onClick:()=>u(e),children:[t.jsx(Pr,{className:"h-4 w-4 mr-2"}),"Rename"]}),t.jsxs(ht,{onClick:()=>d(e),className:"text-destructive",children:[t.jsx(Yt,{className:"h-4 w-4 mr-2"}),"Delete"]})]})]})]}),m&&g&&t.jsx("div",{children:e.children.map(b=>t.jsx(gl,{folder:b,level:n+1,selectedFolderId:s,onSelectFolder:o,onCreateSubfolder:l,onRenameFolder:u,onDeleteFolder:d},b.id))})]})}function Xh({selectedFolderId:e,onSelectFolder:n,onError:s}){const{folderTree:o,createFolder:l,updateFolder:u,deleteFolder:d,isLoading:m}=Qh(),[y,g]=f.useState(!1),[w,b]=f.useState(null),[C,x]=f.useState(""),[j,I]=f.useState(null),[k,M]=f.useState(null),D=async()=>{if(C.trim())try{await l(C.trim(),w),x(""),g(!1),b(null)}catch(T){s==null||s(T instanceof Error?T.message:"Failed to create folder")}},q=async()=>{if(!(!j||!j.name.trim()))try{await u(j.id,{name:j.name.trim()}),I(null)}catch(T){s==null||s(T instanceof Error?T.message:"Failed to rename folder")}},O=async()=>{if(k)try{await d(k.id),e===k.id&&n(null),M(null)}catch(T){s==null||s(T instanceof Error?T.message:"Failed to delete folder")}},Q=(T=null)=>{b(T),g(!0),x("")};return t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex items-center justify-between px-2",children:[t.jsx("span",{className:"text-sm font-medium",children:"Folders"}),t.jsx(le,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:()=>Q(null),title:"New Folder",children:t.jsx(Ti,{className:"h-4 w-4"})})]}),t.jsxs("button",{onClick:()=>n(null),className:Oe("flex items-center gap-2 w-full py-1 px-2 rounded-md text-sm hover:bg-accent",e===null&&"bg-accent"),children:[t.jsx(_t,{className:"h-4 w-4 text-muted-foreground"}),"All Notes"]}),m?t.jsx("div",{className:"px-2 py-4 text-sm text-muted-foreground",children:"Loading folders..."}):t.jsx("div",{children:o.map(T=>t.jsx(gl,{folder:T,level:0,selectedFolderId:e,onSelectFolder:n,onCreateSubfolder:Q,onRenameFolder:I,onDeleteFolder:M},T.id))}),y&&t.jsxs("div",{className:"px-2 space-y-2",children:[t.jsx(vt,{placeholder:"Folder name",value:C,onChange:T=>x(T.target.value),onKeyDown:T=>{T.key==="Enter"&&D(),T.key==="Escape"&&(g(!1),x(""))},autoFocus:!0,className:"h-8"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(le,{size:"sm",onClick:D,disabled:!C.trim(),children:"Create"}),t.jsx(le,{size:"sm",variant:"ghost",onClick:()=>{g(!1),x("")},children:"Cancel"})]})]}),j&&t.jsxs("div",{className:"px-2 space-y-2",children:[t.jsx(vt,{value:j.name,onChange:T=>I({...j,name:T.target.value}),onKeyDown:T=>{T.key==="Enter"&&q(),T.key==="Escape"&&I(null)},autoFocus:!0,className:"h-8"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(le,{size:"sm",onClick:q,children:"Rename"}),t.jsx(le,{size:"sm",variant:"ghost",onClick:()=>I(null),children:"Cancel"})]})]}),t.jsx(Rn,{open:!!k,onOpenChange:T=>!T&&M(null),children:t.jsxs(pn,{children:[t.jsxs(gn,{children:[t.jsx(xn,{children:"Delete Folder"}),t.jsxs(vn,{children:['Are you sure you want to delete "',k==null?void 0:k.name,'"? This will also delete all subfolders. Notes in these folders will be moved to "All Notes".']})]}),t.jsxs(yn,{children:[t.jsx(wn,{children:"Cancel"}),t.jsx(bn,{onClick:O,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Delete"})]})]})})]})}function Jh({notes:e,onSelectNote:n,onClose:s}){const o=f.useRef(null),l=f.useRef(null),[u,d]=f.useState(1),[m,y]=f.useState({x:0,y:0}),[g,w]=f.useState(!1),[b,C]=f.useState(null),[x,j]=f.useState({width:800,height:600}),I=f.useRef([]),{nodes:k,links:M}=f.useMemo(()=>{const U=e.filter(J=>!J.deletedAt&&!J.isArchived).map(J=>({id:J.id,title:J.title||"Untitled",size:Math.min(20,Math.max(8,Math.sqrt(J.content.length)/5)),tags:J.tags})),Y=[];for(let J=0;J<U.length;J++)for(let ne=J+1;ne<U.length;ne++){const G=U[J].tags.filter(oe=>U[ne].tags.includes(oe));G.length>0&&Y.push({source:U[J].id,target:U[ne].id,weight:G.length})}return{nodes:U,links:Y}},[e]);f.useEffect(()=>{const U=x.width/2,Y=x.height/2;I.current=k.map(J=>({...J,x:U+(Math.random()-.5)*400,y:Y+(Math.random()-.5)*400,vx:0,vy:0}))},[k,x]),f.useEffect(()=>{const U=()=>{l.current&&j({width:l.current.clientWidth,height:l.current.clientHeight})};return U(),window.addEventListener("resize",U),()=>window.removeEventListener("resize",U)},[]),f.useEffect(()=>{let U;const Y=new Map(I.current.map(ne=>[ne.id,ne])),J=()=>{const ne=I.current;if(ne.length!==0){for(const G of ne){const oe=x.width/2,te=x.height/2;G.vx=(G.vx||0)+(oe-(G.x||0))*.001,G.vy=(G.vy||0)+(te-(G.y||0))*.001;for(const z of ne){if(G.id===z.id)continue;const K=(G.x||0)-(z.x||0),W=(G.y||0)-(z.y||0),ee=Math.sqrt(K*K+W*W)||1,ie=500/(ee*ee);G.vx=(G.vx||0)+K/ee*ie,G.vy=(G.vy||0)+W/ee*ie}}for(const G of M){const oe=Y.get(G.source),te=Y.get(G.target);if(!oe||!te)continue;const z=(te.x||0)-(oe.x||0),K=(te.y||0)-(oe.y||0),W=Math.sqrt(z*z+K*K)||1,ee=(W-100)*.01*G.weight;oe.vx=(oe.vx||0)+z/W*ee,oe.vy=(oe.vy||0)+K/W*ee,te.vx=(te.vx||0)-z/W*ee,te.vy=(te.vy||0)-K/W*ee}for(const G of ne)G.vx=(G.vx||0)*.9,G.vy=(G.vy||0)*.9,G.x=(G.x||0)+(G.vx||0),G.y=(G.y||0)+(G.vy||0),G.x=Math.max(50,Math.min(x.width-50,G.x||0)),G.y=Math.max(50,Math.min(x.height-50,G.y||0));q(),U=requestAnimationFrame(J)}};return J(),()=>cancelAnimationFrame(U)},[M,x]);const D=()=>{const U=getComputedStyle(document.documentElement),Y=document.documentElement.classList.contains("dark");return{linkColor:Y?"rgba(156, 163, 175, 0.3)":"rgba(107, 114, 128, 0.3)",nodeColor:U.getPropertyValue("--primary").trim()||(Y?"#818CF8":"#6366F1"),nodeHoverColor:U.getPropertyValue("--primary").trim()||"#3B82F6",labelColor:Y?"#D1D5DB":"#6B7280",labelHoverColor:Y?"#F9FAFB":"#1F2937",strokeColor:Y?"#F9FAFB":"#FFFFFF"}},q=()=>{const U=o.current,Y=U==null?void 0:U.getContext("2d");if(!U||!Y)return;const J=I.current,ne=new Map(J.map(oe=>[oe.id,oe])),G=D();Y.clearRect(0,0,U.width,U.height),Y.save(),Y.translate(m.x,m.y),Y.scale(u,u),Y.strokeStyle=G.linkColor,Y.lineWidth=1/u;for(const oe of M){const te=ne.get(oe.source),z=ne.get(oe.target);!te||!z||(Y.beginPath(),Y.moveTo(te.x||0,te.y||0),Y.lineTo(z.x||0,z.y||0),Y.stroke())}for(const oe of J){const te=(b==null?void 0:b.id)===oe.id;Y.beginPath(),Y.arc(oe.x||0,oe.y||0,oe.size,0,Math.PI*2),Y.fillStyle=te?G.nodeHoverColor:G.nodeColor,Y.fill(),te&&(Y.strokeStyle=G.strokeColor,Y.lineWidth=2/u,Y.stroke()),u>.5&&(Y.fillStyle=te?G.labelHoverColor:G.labelColor,Y.font=`${12/u}px sans-serif`,Y.textAlign="center",Y.fillText(oe.title.length>20?oe.title.slice(0,20)+"...":oe.title,oe.x||0,(oe.y||0)+oe.size+15/u))}Y.restore()},O=U=>{const Y=o.current;if(!Y)return;const J=Y.getBoundingClientRect(),ne=(U.clientX-J.left-m.x)/u,G=(U.clientY-J.top-m.y)/u;if(g){y({x:m.x+U.movementX,y:m.y+U.movementY});return}let oe=!1;for(const te of I.current){const z=(te.x||0)-ne,K=(te.y||0)-G;if(Math.sqrt(z*z+K*K)<te.size){C(te),Y.style.cursor="pointer",oe=!0;break}}oe||(C(null),Y.style.cursor=g?"grabbing":"grab")},Q=()=>{b?(n(b.id),s()):w(!0)},T=()=>{w(!1)},P=U=>{U.preventDefault();const Y=U.deltaY>0?.9:1.1;d(Math.max(.1,Math.min(3,u*Y)))};return t.jsxs("div",{className:"fixed inset-0 z-50 bg-background/95 flex flex-col",children:[t.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[t.jsx("h2",{className:"text-lg font-semibold",children:"Graph View"}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(le,{variant:"outline",size:"icon",onClick:()=>d(u*1.2),"aria-label":"Zoom in",children:t.jsx(_u,{className:"h-4 w-4"})}),t.jsx(le,{variant:"outline",size:"icon",onClick:()=>d(u*.8),"aria-label":"Zoom out",children:t.jsx(Iu,{className:"h-4 w-4"})}),t.jsx(le,{variant:"outline",size:"icon",onClick:()=>{d(1),y({x:0,y:0})},"aria-label":"Reset view",children:t.jsx(vu,{className:"h-4 w-4"})}),t.jsx(le,{variant:"ghost",size:"icon",onClick:s,"aria-label":"Close graph view",children:t.jsx(Tt,{className:"h-4 w-4"})})]})]}),t.jsx("div",{ref:l,className:"flex-1 overflow-hidden",children:t.jsx("canvas",{ref:o,width:x.width,height:x.height,onMouseMove:O,onMouseDown:Q,onMouseUp:T,onMouseLeave:T,onWheel:P,style:{cursor:g?"grabbing":"grab"},"aria-label":`Graph visualization with ${k.length} notes and ${M.length} connections. Click nodes to select notes, drag to pan, scroll to zoom.`,role:"img"})}),t.jsxs("div",{className:"p-4 border-t text-sm text-muted-foreground",children:[t.jsxs("p",{children:[k.length," notes, ",M.length," connections (via shared tags)"]}),t.jsx("p",{children:"Click a node to open the note. Drag to pan, scroll to zoom."})]}),b&&t.jsxs("div",{className:"absolute bottom-20 left-4 bg-popover border rounded-lg p-3 shadow-lg max-w-xs",children:[t.jsx("h3",{className:"font-medium truncate",children:b.title}),b.tags.length>0&&t.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:["Tags: ",b.tags.join(", ")]})]})]})}const Zh=["localeText"],Ba=f.createContext(null),ef=function(n){const{localeText:s}=n,o=mt(n,Zh),{adapter:l,localeText:u}=f.useContext(Ba)??{adapter:void 0,localeText:void 0},d=Kt({props:o,name:"MuiLocalizationProvider"}),{children:m,dateAdapter:y,dateFormats:g,dateLibInstance:w,adapterLocale:b,localeText:C}=d,x=f.useMemo(()=>_e({},C,u,s),[C,u,s]),j=f.useMemo(()=>{if(!y)return l||null;const M=new y({locale:b,formats:g,instance:w});if(!M.isMUIAdapter)throw new Error(["MUI X: The date adapter should be imported from `@mui/x-date-pickers` or `@mui/x-date-pickers-pro`, not from `@date-io`","For example, `import { AdapterDayjs } from '@mui/x-date-pickers/AdapterDayjs'` instead of `import AdapterDayjs from '@date-io/dayjs'`","More information on the installation documentation: https://mui.com/x/react-date-pickers/quickstart/#installation"].join(`
`));return M},[y,b,g,w,l]),I=f.useMemo(()=>j?{minDate:j.date("1900-01-01T00:00:00.000"),maxDate:j.date("2099-12-31T00:00:00.000")}:null,[j]),k=f.useMemo(()=>({utils:j,adapter:j,defaultDates:I,localeText:x}),[I,j,x]);return t.jsx(Ba.Provider,{value:k,children:m})};var yl={exports:{}};(function(e,n){(function(s,o){e.exports=o()})(hn,function(){var s=1e3,o=6e4,l=36e5,u="millisecond",d="second",m="minute",y="hour",g="day",w="week",b="month",C="quarter",x="year",j="date",I="Invalid Date",k=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,M=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,D={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(te){var z=["th","st","nd","rd"],K=te%100;return"["+te+(z[(K-20)%10]||z[K]||z[0])+"]"}},q=function(te,z,K){var W=String(te);return!W||W.length>=z?te:""+Array(z+1-W.length).join(K)+te},O={s:q,z:function(te){var z=-te.utcOffset(),K=Math.abs(z),W=Math.floor(K/60),ee=K%60;return(z<=0?"+":"-")+q(W,2,"0")+":"+q(ee,2,"0")},m:function te(z,K){if(z.date()<K.date())return-te(K,z);var W=12*(K.year()-z.year())+(K.month()-z.month()),ee=z.clone().add(W,b),ie=K-ee<0,me=z.clone().add(W+(ie?-1:1),b);return+(-(W+(K-ee)/(ie?ee-me:me-ee))||0)},a:function(te){return te<0?Math.ceil(te)||0:Math.floor(te)},p:function(te){return{M:b,y:x,w,d:g,D:j,h:y,m,s:d,ms:u,Q:C}[te]||String(te||"").toLowerCase().replace(/s$/,"")},u:function(te){return te===void 0}},Q="en",T={};T[Q]=D;var P="$isDayjsObject",U=function(te){return te instanceof G||!(!te||!te[P])},Y=function te(z,K,W){var ee;if(!z)return Q;if(typeof z=="string"){var ie=z.toLowerCase();T[ie]&&(ee=ie),K&&(T[ie]=K,ee=ie);var me=z.split("-");if(!ee&&me.length>1)return te(me[0])}else{var ke=z.name;T[ke]=z,ee=ke}return!W&&ee&&(Q=ee),ee||!W&&Q},J=function(te,z){if(U(te))return te.clone();var K=typeof z=="object"?z:{};return K.date=te,K.args=arguments,new G(K)},ne=O;ne.l=Y,ne.i=U,ne.w=function(te,z){return J(te,{locale:z.$L,utc:z.$u,x:z.$x,$offset:z.$offset})};var G=function(){function te(K){this.$L=Y(K.locale,null,!0),this.parse(K),this.$x=this.$x||K.x||{},this[P]=!0}var z=te.prototype;return z.parse=function(K){this.$d=function(W){var ee=W.date,ie=W.utc;if(ee===null)return new Date(NaN);if(ne.u(ee))return new Date;if(ee instanceof Date)return new Date(ee);if(typeof ee=="string"&&!/Z$/i.test(ee)){var me=ee.match(k);if(me){var ke=me[2]-1||0,Te=(me[7]||"0").substring(0,3);return ie?new Date(Date.UTC(me[1],ke,me[3]||1,me[4]||0,me[5]||0,me[6]||0,Te)):new Date(me[1],ke,me[3]||1,me[4]||0,me[5]||0,me[6]||0,Te)}}return new Date(ee)}(K),this.init()},z.init=function(){var K=this.$d;this.$y=K.getFullYear(),this.$M=K.getMonth(),this.$D=K.getDate(),this.$W=K.getDay(),this.$H=K.getHours(),this.$m=K.getMinutes(),this.$s=K.getSeconds(),this.$ms=K.getMilliseconds()},z.$utils=function(){return ne},z.isValid=function(){return this.$d.toString()!==I},z.isSame=function(K,W){var ee=J(K);return this.startOf(W)<=ee&&ee<=this.endOf(W)},z.isAfter=function(K,W){return J(K)<this.startOf(W)},z.isBefore=function(K,W){return this.endOf(W)<J(K)},z.$g=function(K,W,ee){return ne.u(K)?this[W]:this.set(ee,K)},z.unix=function(){return Math.floor(this.valueOf()/1e3)},z.valueOf=function(){return this.$d.getTime()},z.startOf=function(K,W){var ee=this,ie=!!ne.u(W)||W,me=ne.p(K),ke=function(ce,Ie){var X=ne.w(ee.$u?Date.UTC(ee.$y,Ie,ce):new Date(ee.$y,Ie,ce),ee);return ie?X:X.endOf(g)},Te=function(ce,Ie){return ne.w(ee.toDate()[ce].apply(ee.toDate("s"),(ie?[0,0,0,0]:[23,59,59,999]).slice(Ie)),ee)},Ae=this.$W,Be=this.$M,de=this.$D,Le="set"+(this.$u?"UTC":"");switch(me){case x:return ie?ke(1,0):ke(31,11);case b:return ie?ke(1,Be):ke(0,Be+1);case w:var Ve=this.$locale().weekStart||0,tt=(Ae<Ve?Ae+7:Ae)-Ve;return ke(ie?de-tt:de+(6-tt),Be);case g:case j:return Te(Le+"Hours",0);case y:return Te(Le+"Minutes",1);case m:return Te(Le+"Seconds",2);case d:return Te(Le+"Milliseconds",3);default:return this.clone()}},z.endOf=function(K){return this.startOf(K,!1)},z.$set=function(K,W){var ee,ie=ne.p(K),me="set"+(this.$u?"UTC":""),ke=(ee={},ee[g]=me+"Date",ee[j]=me+"Date",ee[b]=me+"Month",ee[x]=me+"FullYear",ee[y]=me+"Hours",ee[m]=me+"Minutes",ee[d]=me+"Seconds",ee[u]=me+"Milliseconds",ee)[ie],Te=ie===g?this.$D+(W-this.$W):W;if(ie===b||ie===x){var Ae=this.clone().set(j,1);Ae.$d[ke](Te),Ae.init(),this.$d=Ae.set(j,Math.min(this.$D,Ae.daysInMonth())).$d}else ke&&this.$d[ke](Te);return this.init(),this},z.set=function(K,W){return this.clone().$set(K,W)},z.get=function(K){return this[ne.p(K)]()},z.add=function(K,W){var ee,ie=this;K=Number(K);var me=ne.p(W),ke=function(Be){var de=J(ie);return ne.w(de.date(de.date()+Math.round(Be*K)),ie)};if(me===b)return this.set(b,this.$M+K);if(me===x)return this.set(x,this.$y+K);if(me===g)return ke(1);if(me===w)return ke(7);var Te=(ee={},ee[m]=o,ee[y]=l,ee[d]=s,ee)[me]||1,Ae=this.$d.getTime()+K*Te;return ne.w(Ae,this)},z.subtract=function(K,W){return this.add(-1*K,W)},z.format=function(K){var W=this,ee=this.$locale();if(!this.isValid())return ee.invalidDate||I;var ie=K||"YYYY-MM-DDTHH:mm:ssZ",me=ne.z(this),ke=this.$H,Te=this.$m,Ae=this.$M,Be=ee.weekdays,de=ee.months,Le=ee.meridiem,Ve=function(Ie,X,se,Ce){return Ie&&(Ie[X]||Ie(W,ie))||se[X].slice(0,Ce)},tt=function(Ie){return ne.s(ke%12||12,Ie,"0")},ce=Le||function(Ie,X,se){var Ce=Ie<12?"AM":"PM";return se?Ce.toLowerCase():Ce};return ie.replace(M,function(Ie,X){return X||function(se){switch(se){case"YY":return String(W.$y).slice(-2);case"YYYY":return ne.s(W.$y,4,"0");case"M":return Ae+1;case"MM":return ne.s(Ae+1,2,"0");case"MMM":return Ve(ee.monthsShort,Ae,de,3);case"MMMM":return Ve(de,Ae);case"D":return W.$D;case"DD":return ne.s(W.$D,2,"0");case"d":return String(W.$W);case"dd":return Ve(ee.weekdaysMin,W.$W,Be,2);case"ddd":return Ve(ee.weekdaysShort,W.$W,Be,3);case"dddd":return Be[W.$W];case"H":return String(ke);case"HH":return ne.s(ke,2,"0");case"h":return tt(1);case"hh":return tt(2);case"a":return ce(ke,Te,!0);case"A":return ce(ke,Te,!1);case"m":return String(Te);case"mm":return ne.s(Te,2,"0");case"s":return String(W.$s);case"ss":return ne.s(W.$s,2,"0");case"SSS":return ne.s(W.$ms,3,"0");case"Z":return me}return null}(Ie)||me.replace(":","")})},z.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},z.diff=function(K,W,ee){var ie,me=this,ke=ne.p(W),Te=J(K),Ae=(Te.utcOffset()-this.utcOffset())*o,Be=this-Te,de=function(){return ne.m(me,Te)};switch(ke){case x:ie=de()/12;break;case b:ie=de();break;case C:ie=de()/3;break;case w:ie=(Be-Ae)/6048e5;break;case g:ie=(Be-Ae)/864e5;break;case y:ie=Be/l;break;case m:ie=Be/o;break;case d:ie=Be/s;break;default:ie=Be}return ee?ie:ne.a(ie)},z.daysInMonth=function(){return this.endOf(b).$D},z.$locale=function(){return T[this.$L]},z.locale=function(K,W){if(!K)return this.$L;var ee=this.clone(),ie=Y(K,W,!0);return ie&&(ee.$L=ie),ee},z.clone=function(){return ne.w(this.$d,this)},z.toDate=function(){return new Date(this.valueOf())},z.toJSON=function(){return this.isValid()?this.toISOString():null},z.toISOString=function(){return this.$d.toISOString()},z.toString=function(){return this.$d.toUTCString()},te}(),oe=G.prototype;return J.prototype=oe,[["$ms",u],["$s",d],["$m",m],["$H",y],["$W",g],["$M",b],["$y",x],["$D",j]].forEach(function(te){oe[te[1]]=function(z){return this.$g(z,te[0],te[1])}}),J.extend=function(te,z){return te.$i||(te(z,G,J),te.$i=!0),J},J.locale=Y,J.isDayjs=U,J.unix=function(te){return J(1e3*te)},J.en=T[Q],J.Ls=T,J.p={},J})})(yl);var tf=yl.exports;const ot=zn(tf);var xl={exports:{}};(function(e,n){(function(s,o){e.exports=o()})(hn,function(){var s="week",o="year";return function(l,u,d){var m=u.prototype;m.week=function(y){if(y===void 0&&(y=null),y!==null)return this.add(7*(y-this.week()),"day");var g=this.$locale().yearStart||1;if(this.month()===11&&this.date()>25){var w=d(this).startOf(o).add(1,o).date(g),b=d(this).endOf(s);if(w.isBefore(b))return 1}var C=d(this).startOf(o).date(g).startOf(s).subtract(1,"millisecond"),x=this.diff(C,s,!0);return x<0?d(this).startOf("week").week():Math.ceil(x)},m.weeks=function(y){return y===void 0&&(y=null),this.week(y)}}})})(xl);var nf=xl.exports;const rf=zn(nf);var vl={exports:{}};(function(e,n){(function(s,o){e.exports=o()})(hn,function(){var s={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},o=/(\[[^[]*\])|([-_:/.,()\s]+)|(A|a|Q|YYYY|YY?|ww?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,l=/\d/,u=/\d\d/,d=/\d\d?/,m=/\d*[^-_:/,()\s\d]+/,y={},g=function(k){return(k=+k)+(k>68?1900:2e3)},w=function(k){return function(M){this[k]=+M}},b=[/[+-]\d\d:?(\d\d)?|Z/,function(k){(this.zone||(this.zone={})).offset=function(M){if(!M||M==="Z")return 0;var D=M.match(/([+-]|\d\d)/g),q=60*D[1]+(+D[2]||0);return q===0?0:D[0]==="+"?-q:q}(k)}],C=function(k){var M=y[k];return M&&(M.indexOf?M:M.s.concat(M.f))},x=function(k,M){var D,q=y.meridiem;if(q){for(var O=1;O<=24;O+=1)if(k.indexOf(q(O,0,M))>-1){D=O>12;break}}else D=k===(M?"pm":"PM");return D},j={A:[m,function(k){this.afternoon=x(k,!1)}],a:[m,function(k){this.afternoon=x(k,!0)}],Q:[l,function(k){this.month=3*(k-1)+1}],S:[l,function(k){this.milliseconds=100*+k}],SS:[u,function(k){this.milliseconds=10*+k}],SSS:[/\d{3}/,function(k){this.milliseconds=+k}],s:[d,w("seconds")],ss:[d,w("seconds")],m:[d,w("minutes")],mm:[d,w("minutes")],H:[d,w("hours")],h:[d,w("hours")],HH:[d,w("hours")],hh:[d,w("hours")],D:[d,w("day")],DD:[u,w("day")],Do:[m,function(k){var M=y.ordinal,D=k.match(/\d+/);if(this.day=D[0],M)for(var q=1;q<=31;q+=1)M(q).replace(/\[|\]/g,"")===k&&(this.day=q)}],w:[d,w("week")],ww:[u,w("week")],M:[d,w("month")],MM:[u,w("month")],MMM:[m,function(k){var M=C("months"),D=(C("monthsShort")||M.map(function(q){return q.slice(0,3)})).indexOf(k)+1;if(D<1)throw new Error;this.month=D%12||D}],MMMM:[m,function(k){var M=C("months").indexOf(k)+1;if(M<1)throw new Error;this.month=M%12||M}],Y:[/[+-]?\d+/,w("year")],YY:[u,function(k){this.year=g(k)}],YYYY:[/\d{4}/,w("year")],Z:b,ZZ:b};function I(k){var M,D;M=k,D=y&&y.formats;for(var q=(k=M.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,function(J,ne,G){var oe=G&&G.toUpperCase();return ne||D[G]||s[G]||D[oe].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(te,z,K){return z||K.slice(1)})})).match(o),O=q.length,Q=0;Q<O;Q+=1){var T=q[Q],P=j[T],U=P&&P[0],Y=P&&P[1];q[Q]=Y?{regex:U,parser:Y}:T.replace(/^\[|\]$/g,"")}return function(J){for(var ne={},G=0,oe=0;G<O;G+=1){var te=q[G];if(typeof te=="string")oe+=te.length;else{var z=te.regex,K=te.parser,W=J.slice(oe),ee=z.exec(W)[0];K.call(ne,ee),J=J.replace(ee,"")}}return function(ie){var me=ie.afternoon;if(me!==void 0){var ke=ie.hours;me?ke<12&&(ie.hours+=12):ke===12&&(ie.hours=0),delete ie.afternoon}}(ne),ne}}return function(k,M,D){D.p.customParseFormat=!0,k&&k.parseTwoDigitYear&&(g=k.parseTwoDigitYear);var q=M.prototype,O=q.parse;q.parse=function(Q){var T=Q.date,P=Q.utc,U=Q.args;this.$u=P;var Y=U[1];if(typeof Y=="string"){var J=U[2]===!0,ne=U[3]===!0,G=J||ne,oe=U[2];ne&&(oe=U[2]),y=this.$locale(),!J&&oe&&(y=D.Ls[oe]),this.$d=function(W,ee,ie,me){try{if(["x","X"].indexOf(ee)>-1)return new Date((ee==="X"?1e3:1)*W);var ke=I(ee)(W),Te=ke.year,Ae=ke.month,Be=ke.day,de=ke.hours,Le=ke.minutes,Ve=ke.seconds,tt=ke.milliseconds,ce=ke.zone,Ie=ke.week,X=new Date,se=Be||(Te||Ae?1:X.getDate()),Ce=Te||X.getFullYear(),we=0;Te&&!Ae||(we=Ae>0?Ae-1:X.getMonth());var re,Pe=de||0,qe=Le||0,Ze=Ve||0,st=tt||0;return ce?new Date(Date.UTC(Ce,we,se,Pe,qe,Ze,st+60*ce.offset*1e3)):ie?new Date(Date.UTC(Ce,we,se,Pe,qe,Ze,st)):(re=new Date(Ce,we,se,Pe,qe,Ze,st),Ie&&(re=me(re).week(Ie).toDate()),re)}catch{return new Date("")}}(T,Y,P,D),this.init(),oe&&oe!==!0&&(this.$L=this.locale(oe).$L),G&&T!=this.format(Y)&&(this.$d=new Date("")),y={}}else if(Y instanceof Array)for(var te=Y.length,z=1;z<=te;z+=1){U[1]=Y[z-1];var K=D.apply(this,U);if(K.isValid()){this.$d=K.$d,this.$L=K.$L,this.init();break}z===te&&(this.$d=new Date(""))}else O.call(this,Q)}}})})(vl);var sf=vl.exports;const af=zn(sf);var bl={exports:{}};(function(e,n){(function(s,o){e.exports=o()})(hn,function(){var s={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};return function(o,l,u){var d=l.prototype,m=d.format;u.en.formats=s,d.format=function(y){y===void 0&&(y="YYYY-MM-DDTHH:mm:ssZ");var g=this.$locale().formats,w=function(b,C){return b.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,function(x,j,I){var k=I&&I.toUpperCase();return j||C[I]||s[I]||C[k].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(M,D,q){return D||q.slice(1)})})}(y,g===void 0?{}:g);return m.call(this,w)}}})})(bl);var of=bl.exports;const lf=zn(of);var wl={exports:{}};(function(e,n){(function(s,o){e.exports=o()})(hn,function(){return function(s,o,l){o.prototype.isBetween=function(u,d,m,y){var g=l(u),w=l(d),b=(y=y||"()")[0]==="(",C=y[1]===")";return(b?this.isAfter(g,m):!this.isBefore(g,m))&&(C?this.isBefore(w,m):!this.isAfter(w,m))||(b?this.isBefore(g,m):!this.isAfter(g,m))&&(C?this.isAfter(w,m):!this.isBefore(w,m))}}})})(wl);var cf=wl.exports;const uf=zn(cf);var jl={exports:{}};(function(e,n){(function(s,o){e.exports=o()})(hn,function(){return function(s,o){var l=o.prototype,u=l.format;l.format=function(d){var m=this,y=this.$locale();if(!this.isValid())return u.bind(this)(d);var g=this.$utils(),w=(d||"YYYY-MM-DDTHH:mm:ssZ").replace(/\[([^\]]+)]|Q|wo|ww|w|WW|W|zzz|z|gggg|GGGG|Do|X|x|k{1,2}|S/g,function(b){switch(b){case"Q":return Math.ceil((m.$M+1)/3);case"Do":return y.ordinal(m.$D);case"gggg":return m.weekYear();case"GGGG":return m.isoWeekYear();case"wo":return y.ordinal(m.week(),"W");case"w":case"ww":return g.s(m.week(),b==="w"?1:2,"0");case"W":case"WW":return g.s(m.isoWeek(),b==="W"?1:2,"0");case"k":case"kk":return g.s(String(m.$H===0?24:m.$H),b==="k"?1:2,"0");case"X":return Math.floor(m.$d.getTime()/1e3);case"x":return m.$d.getTime();case"z":return"["+m.offsetName()+"]";case"zzz":return"["+m.offsetName("long")+"]";default:return b}});return u.bind(this)(w)}}})})(jl);var df=jl.exports;const hf=zn(df);ot.extend(lf);ot.extend(rf);ot.extend(uf);ot.extend(hf);const ff={YY:"year",YYYY:{sectionType:"year",contentType:"digit",maxLength:4},M:{sectionType:"month",contentType:"digit",maxLength:2},MM:"month",MMM:{sectionType:"month",contentType:"letter"},MMMM:{sectionType:"month",contentType:"letter"},D:{sectionType:"day",contentType:"digit",maxLength:2},DD:"day",Do:{sectionType:"day",contentType:"digit-with-letter"},d:{sectionType:"weekDay",contentType:"digit",maxLength:2},dd:{sectionType:"weekDay",contentType:"letter"},ddd:{sectionType:"weekDay",contentType:"letter"},dddd:{sectionType:"weekDay",contentType:"letter"},A:"meridiem",a:"meridiem",H:{sectionType:"hours",contentType:"digit",maxLength:2},HH:"hours",h:{sectionType:"hours",contentType:"digit",maxLength:2},hh:"hours",m:{sectionType:"minutes",contentType:"digit",maxLength:2},mm:"minutes",s:{sectionType:"seconds",contentType:"digit",maxLength:2},ss:"seconds"},mf={year:"YYYY",month:"MMMM",monthShort:"MMM",dayOfMonth:"D",dayOfMonthFull:"Do",weekday:"dddd",weekdayShort:"dd",hours24h:"HH",hours12h:"hh",meridiem:"A",minutes:"mm",seconds:"ss",fullDate:"ll",keyboardDate:"L",shortDate:"MMM D",normalDate:"D MMMM",normalDateWithWeekday:"ddd, MMM D",fullTime12h:"hh:mm A",fullTime24h:"HH:mm",keyboardDateTime12h:"L hh:mm A",keyboardDateTime24h:"L HH:mm"},ja=["Missing UTC plugin","To be able to use UTC or timezones, you have to enable the `utc` plugin","Find more information on https://mui.com/x/react-date-pickers/timezone/#day-js-and-utc"].join(`
`),Xo=["Missing timezone plugin","To be able to use timezones, you have to enable both the `utc` and the `timezone` plugin","Find more information on https://mui.com/x/react-date-pickers/timezone/#day-js-and-timezone"].join(`
`);class pf{constructor({locale:n,formats:s}={}){xe(this,"isMUIAdapter",!0);xe(this,"isTimezoneCompatible",!0);xe(this,"lib","dayjs");xe(this,"escapedCharacters",{start:"[",end:"]"});xe(this,"formatTokenMap",ff);xe(this,"setLocaleToValue",n=>{const s=this.getCurrentLocaleCode();return s===n.locale()?n:n.locale(s)});xe(this,"hasUTCPlugin",()=>typeof ot.utc<"u");xe(this,"hasTimezonePlugin",()=>typeof ot.tz<"u");xe(this,"isSame",(n,s,o)=>{const l=this.setTimezone(s,this.getTimezone(n));return n.format(o)===l.format(o)});xe(this,"cleanTimezone",n=>{switch(n){case"default":return;case"system":return ot.tz.guess();default:return n}});xe(this,"createSystemDate",n=>{let s;if(this.hasUTCPlugin()&&this.hasTimezonePlugin()){const o=ot.tz.guess();o==="UTC"?s=ot(n):s=ot.tz(n,o)}else s=ot(n);return this.setLocaleToValue(s)});xe(this,"createUTCDate",n=>{if(!this.hasUTCPlugin())throw new Error(ja);return this.setLocaleToValue(ot.utc(n))});xe(this,"createTZDate",(n,s)=>{if(!this.hasUTCPlugin())throw new Error(ja);if(!this.hasTimezonePlugin())throw new Error(Xo);const o=n!==void 0&&!n.endsWith("Z");return this.setLocaleToValue(ot(n).tz(this.cleanTimezone(s),o))});xe(this,"getLocaleFormats",()=>{const n=ot.Ls,s=this.locale||"en";let o=n[s];return o===void 0&&(o=n.en),o.formats});xe(this,"adjustOffset",n=>{if(!this.hasTimezonePlugin())return n;const s=this.getTimezone(n);if(s!=="UTC"){const o=n.tz(this.cleanTimezone(s),!0);if(o.$offset===(n.$offset??0))return n;n.$offset=o.$offset}return n});xe(this,"date",(n,s="default")=>n===null?null:s==="UTC"?this.createUTCDate(n):s==="system"||s==="default"&&!this.hasTimezonePlugin()?this.createSystemDate(n):this.createTZDate(n,s));xe(this,"getInvalidDate",()=>ot(new Date("Invalid date")));xe(this,"getTimezone",n=>{var s;if(this.hasTimezonePlugin()){const o=(s=n.$x)==null?void 0:s.$timezone;if(o)return o}return this.hasUTCPlugin()&&n.isUTC()?"UTC":"system"});xe(this,"setTimezone",(n,s)=>{if(this.getTimezone(n)===s)return n;if(s==="UTC"){if(!this.hasUTCPlugin())throw new Error(ja);return n.utc()}if(s==="system")return n.local();if(!this.hasTimezonePlugin()){if(s==="default")return n;throw new Error(Xo)}return this.setLocaleToValue(ot.tz(n,this.cleanTimezone(s)))});xe(this,"toJsDate",n=>n.toDate());xe(this,"parse",(n,s)=>n===""?null:ot(n,s,this.locale,!0));xe(this,"getCurrentLocaleCode",()=>this.locale||"en");xe(this,"is12HourCycleInCurrentLocale",()=>/A|a/.test(this.getLocaleFormats().LT||""));xe(this,"expandFormat",n=>{const s=this.getLocaleFormats(),o=l=>l.replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,(u,d,m)=>d||m.slice(1));return n.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,(l,u,d)=>{const m=d&&d.toUpperCase();return u||s[d]||o(s[m])})});xe(this,"isValid",n=>n==null?!1:n.isValid());xe(this,"format",(n,s)=>this.formatByString(n,this.formats[s]));xe(this,"formatByString",(n,s)=>this.setLocaleToValue(n).format(s));xe(this,"formatNumber",n=>n);xe(this,"isEqual",(n,s)=>n===null&&s===null?!0:n===null||s===null?!1:n.toDate().getTime()===s.toDate().getTime());xe(this,"isSameYear",(n,s)=>this.isSame(n,s,"YYYY"));xe(this,"isSameMonth",(n,s)=>this.isSame(n,s,"YYYY-MM"));xe(this,"isSameDay",(n,s)=>this.isSame(n,s,"YYYY-MM-DD"));xe(this,"isSameHour",(n,s)=>n.isSame(s,"hour"));xe(this,"isAfter",(n,s)=>n>s);xe(this,"isAfterYear",(n,s)=>this.hasUTCPlugin()?!this.isSameYear(n,s)&&n.utc()>s.utc():n.isAfter(s,"year"));xe(this,"isAfterDay",(n,s)=>this.hasUTCPlugin()?!this.isSameDay(n,s)&&n.utc()>s.utc():n.isAfter(s,"day"));xe(this,"isBefore",(n,s)=>n<s);xe(this,"isBeforeYear",(n,s)=>this.hasUTCPlugin()?!this.isSameYear(n,s)&&n.utc()<s.utc():n.isBefore(s,"year"));xe(this,"isBeforeDay",(n,s)=>this.hasUTCPlugin()?!this.isSameDay(n,s)&&n.utc()<s.utc():n.isBefore(s,"day"));xe(this,"isWithinRange",(n,[s,o])=>n>=s&&n<=o);xe(this,"startOfYear",n=>this.adjustOffset(n.startOf("year")));xe(this,"startOfMonth",n=>this.adjustOffset(n.startOf("month")));xe(this,"startOfWeek",n=>this.adjustOffset(this.setLocaleToValue(n).startOf("week")));xe(this,"startOfDay",n=>this.adjustOffset(n.startOf("day")));xe(this,"endOfYear",n=>this.adjustOffset(n.endOf("year")));xe(this,"endOfMonth",n=>this.adjustOffset(n.endOf("month")));xe(this,"endOfWeek",n=>this.adjustOffset(this.setLocaleToValue(n).endOf("week")));xe(this,"endOfDay",n=>this.adjustOffset(n.endOf("day")));xe(this,"addYears",(n,s)=>this.adjustOffset(n.add(s,"year")));xe(this,"addMonths",(n,s)=>this.adjustOffset(n.add(s,"month")));xe(this,"addWeeks",(n,s)=>this.adjustOffset(n.add(s,"week")));xe(this,"addDays",(n,s)=>this.adjustOffset(n.add(s,"day")));xe(this,"addHours",(n,s)=>this.adjustOffset(n.add(s,"hour")));xe(this,"addMinutes",(n,s)=>this.adjustOffset(n.add(s,"minute")));xe(this,"addSeconds",(n,s)=>this.adjustOffset(n.add(s,"second")));xe(this,"getYear",n=>n.year());xe(this,"getMonth",n=>n.month());xe(this,"getDate",n=>n.date());xe(this,"getHours",n=>n.hour());xe(this,"getMinutes",n=>n.minute());xe(this,"getSeconds",n=>n.second());xe(this,"getMilliseconds",n=>n.millisecond());xe(this,"setYear",(n,s)=>this.adjustOffset(n.set("year",s)));xe(this,"setMonth",(n,s)=>this.adjustOffset(n.set("month",s)));xe(this,"setDate",(n,s)=>this.adjustOffset(n.set("date",s)));xe(this,"setHours",(n,s)=>this.adjustOffset(n.set("hour",s)));xe(this,"setMinutes",(n,s)=>this.adjustOffset(n.set("minute",s)));xe(this,"setSeconds",(n,s)=>this.adjustOffset(n.set("second",s)));xe(this,"setMilliseconds",(n,s)=>this.adjustOffset(n.set("millisecond",s)));xe(this,"getDaysInMonth",n=>n.daysInMonth());xe(this,"getWeekArray",n=>{const s=this.startOfWeek(this.startOfMonth(n)),o=this.endOfWeek(this.endOfMonth(n));let l=0,u=s;const d=[];for(;u<o;){const m=Math.floor(l/7);d[m]=d[m]||[],d[m].push(u),u=this.addDays(u,1),l+=1}return d});xe(this,"getWeekNumber",n=>n.week());xe(this,"getYearRange",([n,s])=>{const o=this.startOfYear(n),l=this.endOfYear(s),u=[];let d=o;for(;this.isBefore(d,l);)u.push(d),d=this.addYears(d,1);return u});this.locale=n,this.formats=_e({},mf,s),ot.extend(af)}getDayOfWeek(n){return n.day()+1}}const vs=(e,n,s)=>{let o=n;return o=e.setHours(o,e.getHours(s)),o=e.setMinutes(o,e.getMinutes(s)),o=e.setSeconds(o,e.getSeconds(s)),o=e.setMilliseconds(o,e.getMilliseconds(s)),o},Tr=({date:e,disableFuture:n,disablePast:s,maxDate:o,minDate:l,isDateDisabled:u,adapter:d,timezone:m})=>{const y=vs(d,d.date(void 0,m),e);s&&d.isBefore(l,y)&&(l=y),n&&d.isAfter(o,y)&&(o=y);let g=e,w=e;for(d.isBefore(e,l)&&(g=l,w=null),d.isAfter(e,o)&&(w&&(w=o),g=null);g||w;){if(g&&d.isAfter(g,o)&&(g=null),w&&d.isBefore(w,l)&&(w=null),g){if(!u(g))return g;g=d.addDays(g,1)}if(w){if(!u(w))return w;w=d.addDays(w,-1)}}return null},gf=(e,n)=>e.isValid(n)?n:null,Jo=(e,n,s)=>n==null||!e.isValid(n)?s:n,yf=(e,n,s)=>!e.isValid(n)&&n!=null&&!e.isValid(s)&&s!=null?!0:e.isEqual(n,s),xf=(e,n)=>{const o=[e.startOfYear(n)];for(;o.length<12;){const l=o[o.length-1];o.push(e.addMonths(l,1))}return o},kl=(e,n,s)=>s==="date"?e.startOfDay(e.date(void 0,n)):e.date(void 0,n),vf=(e,n)=>{const s=e.startOfWeek(n);return[0,1,2,3,4,5,6].map(o=>e.addDays(s,o))},Zo=(e,n)=>n.getHours(e)*3600+n.getMinutes(e)*60+n.getSeconds(e),bf=(e,n)=>(s,o)=>e?n.isAfter(s,o):Zo(s,n)>Zo(o,n),qt={year:1,month:2,day:3,minutes:5,seconds:6,milliseconds:7},br=(e,n,s)=>{if(n===qt.year)return e.startOfYear(s);if(n===qt.month)return e.startOfMonth(s);if(n===qt.day)return e.startOfDay(s);let o=s;return n<qt.minutes&&(o=e.setMinutes(o,0)),n<qt.seconds&&(o=e.setSeconds(o,0)),n<qt.milliseconds&&(o=e.setMilliseconds(o,0)),o},wf=({props:e,adapter:n,granularity:s,timezone:o,getTodayDate:l})=>{let u=l?l():br(n,s,kl(n,o));e.minDate!=null&&n.isAfterDay(e.minDate,u)&&(u=br(n,s,e.minDate)),e.maxDate!=null&&n.isBeforeDay(e.maxDate,u)&&(u=br(n,s,e.maxDate));const d=bf(e.disableIgnoringDatePartForTimeValidation??!1,n);return e.minTime!=null&&d(e.minTime,u)&&(u=br(n,s,e.disableIgnoringDatePartForTimeValidation?e.minTime:vs(n,u,e.minTime))),e.maxTime!=null&&d(u,e.maxTime)&&(u=br(n,s,e.disableIgnoringDatePartForTimeValidation?e.maxTime:vs(n,u,e.maxTime))),u},jf=["value","referenceDate"],Bn={emptyValue:null,getTodayValue:kl,getInitialReferenceValue:e=>{let{value:n,referenceDate:s}=e,o=mt(e,jf);return o.adapter.isValid(n)?n:s??wf(o)},cleanValue:gf,areValuesEqual:yf,isSameError:(e,n)=>e===n,hasError:e=>e!=null,defaultErrorState:null,getTimezone:(e,n)=>e.isValid(n)?e.getTimezone(n):null,setTimezone:(e,n,s)=>s==null?null:e.setTimezone(s,n)},Cl=({props:e,value:n,timezone:s,adapter:o})=>{if(n===null)return null;const{shouldDisableDate:l,shouldDisableMonth:u,shouldDisableYear:d,disablePast:m,disableFuture:y,minDate:g,maxDate:w}=e,b=o.date(void 0,s);switch(!0){case!o.isValid(n):return"invalidDate";case!!(l&&l(n)):return"shouldDisableDate";case!!(u&&u(n)):return"shouldDisableMonth";case!!(d&&d(n)):return"shouldDisableYear";case!!(y&&o.isAfterDay(n,b)):return"disableFuture";case!!(m&&o.isBeforeDay(n,b)):return"disablePast";case!!(g&&o.isBeforeDay(n,g)):return"minDate";case!!(w&&o.isAfterDay(n,w)):return"maxDate";default:return null}};Cl.valueManager=Bn;const kf=e=>({components:{MuiLocalizationProvider:{defaultProps:{localeText:_e({},e)}}}}),Nl={previousMonth:"Previous month",nextMonth:"Next month",openPreviousView:"Open previous view",openNextView:"Open next view",calendarViewSwitchingButtonAriaLabel:e=>e==="year"?"year view is open, switch to calendar view":"calendar view is open, switch to year view",start:"Start",end:"End",startDate:"Start date",startTime:"Start time",endDate:"End date",endTime:"End time",cancelButtonLabel:"Cancel",clearButtonLabel:"Clear",okButtonLabel:"OK",todayButtonLabel:"Today",nextStepButtonLabel:"Next",datePickerToolbarTitle:"Select date",dateTimePickerToolbarTitle:"Select date & time",timePickerToolbarTitle:"Select time",dateRangePickerToolbarTitle:"Select date range",timeRangePickerToolbarTitle:"Select time range",clockLabelText:(e,n)=>`Select ${e}. ${n?`Selected time is ${n}`:"No time selected"}`,hoursClockNumberText:e=>`${e} hours`,minutesClockNumberText:e=>`${e} minutes`,secondsClockNumberText:e=>`${e} seconds`,selectViewText:e=>`Select ${e}`,calendarWeekNumberHeaderLabel:"Week number",calendarWeekNumberHeaderText:"#",calendarWeekNumberAriaLabelText:e=>`Week ${e}`,calendarWeekNumberText:e=>`${e}`,openDatePickerDialogue:e=>e?`Choose date, selected date is ${e}`:"Choose date",openTimePickerDialogue:e=>e?`Choose time, selected time is ${e}`:"Choose time",openRangePickerDialogue:e=>e?`Choose range, selected range is ${e}`:"Choose range",fieldClearLabel:"Clear",timeTableLabel:"pick time",dateTableLabel:"pick date",fieldYearPlaceholder:e=>"Y".repeat(e.digitAmount),fieldMonthPlaceholder:e=>e.contentType==="letter"?"MMMM":"MM",fieldDayPlaceholder:()=>"DD",fieldWeekDayPlaceholder:e=>e.contentType==="letter"?"EEEE":"EE",fieldHoursPlaceholder:()=>"hh",fieldMinutesPlaceholder:()=>"mm",fieldSecondsPlaceholder:()=>"ss",fieldMeridiemPlaceholder:()=>"aa",year:"Year",month:"Month",day:"Day",weekDay:"Week day",hours:"Hours",minutes:"Minutes",seconds:"Seconds",meridiem:"Meridiem",empty:"Empty"},Cf=Nl;kf(Nl);const Xa=()=>{const e=f.useContext(Ba);if(e===null)throw new Error(["MUI X: Can not find the date and time pickers localization context.","It looks like you forgot to wrap your component in LocalizationProvider.","This can also happen if you are bundling multiple versions of the `@mui/x-date-pickers` package"].join(`
`));if(e.adapter===null)throw new Error(["MUI X: Can not find the date and time pickers adapter from its localization context.","It looks like you forgot to pass a `dateAdapter` to your LocalizationProvider."].join(`
`));const n=f.useMemo(()=>_e({},Cf,e.localeText),[e.localeText]);return f.useMemo(()=>_e({},e,{localeText:n}),[e,n])},jt=()=>Xa().adapter,Dl=()=>Xa().localeText,Nf=f.createContext({ownerState:{isPickerDisabled:!1,isPickerReadOnly:!1,isPickerValueEmpty:!1,isPickerOpen:!1,pickerVariant:"desktop",pickerOrientation:"portrait"},rootRefObject:{current:null},labelId:void 0,dismissViews:()=>{},hasUIView:!0,getCurrentViewMode:()=>"UI",triggerElement:null,viewContainerRole:null,defaultActionBarActions:[],onPopperExited:void 0}),Sl=({shouldDisableDate:e,shouldDisableMonth:n,shouldDisableYear:s,minDate:o,maxDate:l,disableFuture:u,disablePast:d,timezone:m})=>{const y=jt();return f.useCallback(g=>Cl({adapter:y,value:g,timezone:m,props:{shouldDisableDate:e,shouldDisableMonth:n,shouldDisableYear:s,minDate:o,maxDate:l,disableFuture:u,disablePast:d}})!==null,[y,e,n,s,o,l,u,d,m])},Df=(e,n)=>(s,o)=>{switch(o.type){case"setVisibleDate":return _e({},s,{slideDirection:o.direction,currentMonth:o.month,isMonthSwitchingAnimating:!n.isSameMonth(o.month,s.currentMonth)&&!e&&!o.skipAnimation,focusedDay:o.focusedDay});case"changeMonthTimezone":{const l=o.newTimezone;if(n.getTimezone(s.currentMonth)===l)return s;let u=n.setTimezone(s.currentMonth,l);return n.getMonth(u)!==n.getMonth(s.currentMonth)&&(u=n.setMonth(u,n.getMonth(s.currentMonth))),_e({},s,{currentMonth:u})}case"finishMonthSwitchingAnimation":return _e({},s,{isMonthSwitchingAnimating:!1});default:throw new Error("missing support")}},Sf=e=>{const{value:n,referenceDate:s,disableFuture:o,disablePast:l,maxDate:u,minDate:d,onMonthChange:m,onYearChange:y,reduceAnimations:g,shouldDisableDate:w,timezone:b,getCurrentMonthFromVisibleDate:C}=e,x=jt(),j=f.useRef(Df(!!g,x)).current,I=f.useMemo(()=>Bn.getInitialReferenceValue({value:n,adapter:x,timezone:b,props:e,referenceDate:s,granularity:qt.day}),[s,b]),[k,M]=f.useReducer(j,{isMonthSwitchingAnimating:!1,focusedDay:I,currentMonth:x.setDate(I,1),slideDirection:"left"}),D=Sl({shouldDisableDate:w,minDate:d,maxDate:u,disableFuture:o,disablePast:l,timezone:b});f.useEffect(()=>{M({type:"changeMonthTimezone",newTimezone:x.getTimezone(I)})},[I,x]);const q=rt(({target:Q,reason:T})=>{if(T==="cell-interaction"&&k.focusedDay!=null&&x.isSameDay(Q,k.focusedDay))return;const P=T==="cell-interaction";let U,Y;if(T==="cell-interaction")U=C(Q,k.currentMonth),Y=Q;else if(U=x.isSameMonth(Q,k.currentMonth)?k.currentMonth:x.startOfMonth(Q),Y=Q,D(Y)){const G=x.startOfMonth(Q),oe=x.endOfMonth(Q);Y=Tr({adapter:x,date:Y,minDate:x.isBefore(d,G)?G:d,maxDate:x.isAfter(u,oe)?oe:u,disablePast:l,disableFuture:o,isDateDisabled:D,timezone:b})}const J=!x.isSameMonth(k.currentMonth,U),ne=!x.isSameYear(k.currentMonth,U);J&&(m==null||m(U)),ne&&(y==null||y(x.startOfYear(U))),M({type:"setVisibleDate",month:U,direction:x.isAfterDay(U,k.currentMonth)?"left":"right",focusedDay:k.focusedDay!=null&&Y!=null&&x.isSameDay(Y,k.focusedDay)?k.focusedDay:Y,skipAnimation:P})}),O=f.useCallback(()=>{M({type:"finishMonthSwitchingAnimation"})},[]);return{referenceDate:I,calendarState:k,setVisibleDate:q,isDateDisabled:D,onMonthSwitchingAnimationEnd:O}},Mf=e=>Xt("MuiPickersFadeTransitionGroup",e);Jt("MuiPickersFadeTransitionGroup",["root"]);const Tf=["children"],Af=e=>It({root:["root"]},Mf,e),Pf=Je(pi,{name:"MuiPickersFadeTransitionGroup",slot:"Root"})({display:"block",position:"relative"});function Ml(e){const n=Kt({props:e,name:"MuiPickersFadeTransitionGroup"}),{className:s,reduceAnimations:o,transKey:l,classes:u}=n,{children:d}=n,m=mt(n,Tf),y=Af(u),g=Va();return o?d:t.jsx(Pf,{className:Mt(y.root,s),ownerState:m,children:t.jsx(mi,{appear:!1,mountOnEnter:!0,unmountOnExit:!0,timeout:{appear:g.transitions.duration.enteringScreen,enter:g.transitions.duration.enteringScreen,exit:0},children:d},l)})}const Ar=36,As=2,Ja=320,Of=280,Tl=336;function Ef(e){return Xt("MuiPickersDay",e)}const On=Jt("MuiPickersDay",["root","dayWithMargin","dayOutsideMonth","hiddenDaySpacingFiller","today","selected","disabled"]),Zt=()=>f.useContext(Nf);function Al(e){const{disabled:n,selected:s,today:o,outsideCurrentMonth:l,day:u,disableMargin:d,disableHighlightToday:m,showDaysOutsideCurrentMonth:y}=e,g=jt(),{ownerState:w}=Zt();return f.useMemo(()=>_e({},w,{day:u,isDaySelected:s??!1,isDayDisabled:n??!1,isDayCurrent:o??!1,isDayOutsideMonth:l??!1,isDayStartOfWeek:g.isSameDay(u,g.startOfWeek(u)),isDayEndOfWeek:g.isSameDay(u,g.endOfWeek(u)),disableMargin:d??!1,disableHighlightToday:m??!1,showDaysOutsideCurrentMonth:y??!1}),[g,w,u,s,n,o,l,d,m,y])}const _f=["autoFocus","className","classes","hidden","isAnimating","onClick","onDaySelect","onFocus","onBlur","onKeyDown","onMouseDown","onMouseEnter","children","isFirstVisibleCell","isLastVisibleCell","day","selected","disabled","today","outsideCurrentMonth","disableMargin","disableHighlightToday","showDaysOutsideCurrentMonth"],If=(e,n)=>{const{isDaySelected:s,isDayDisabled:o,isDayCurrent:l,isDayOutsideMonth:u,disableMargin:d,disableHighlightToday:m,showDaysOutsideCurrentMonth:y}=n,g=u&&!y;return It({root:["root",s&&!g&&"selected",o&&"disabled",!d&&"dayWithMargin",!m&&l&&"today",u&&y&&"dayOutsideMonth",g&&"hiddenDaySpacingFiller"],hiddenDaySpacingFiller:["hiddenDaySpacingFiller"]},Ef,e)},Pl=({theme:e})=>_e({},e.typography.caption,{width:Ar,height:Ar,borderRadius:"50%",padding:0,backgroundColor:"transparent",transition:e.transitions.create("background-color",{duration:e.transitions.duration.short}),color:(e.vars||e).palette.text.primary,"@media (pointer: fine)":{"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.hoverOpacity})`:nr(e.palette.primary.main,e.palette.action.hoverOpacity)}},"&:focus":{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.focusOpacity})`:nr(e.palette.primary.main,e.palette.action.focusOpacity),[`&.${On.selected}`]:{willChange:"background-color",backgroundColor:(e.vars||e).palette.primary.dark}},[`&.${On.selected}`]:{color:(e.vars||e).palette.primary.contrastText,backgroundColor:(e.vars||e).palette.primary.main,fontWeight:e.typography.fontWeightMedium,"&:hover":{willChange:"background-color",backgroundColor:(e.vars||e).palette.primary.dark}},[`&.${On.disabled}:not(.${On.selected})`]:{color:(e.vars||e).palette.text.disabled},[`&.${On.disabled}&.${On.selected}`]:{opacity:.6},variants:[{props:{disableMargin:!1},style:{margin:`0 ${As}px`}},{props:{isDayOutsideMonth:!0,showDaysOutsideCurrentMonth:!0},style:{color:(e.vars||e).palette.text.secondary}},{props:{disableHighlightToday:!1,isDayCurrent:!0},style:{[`&:not(.${On.selected})`]:{border:`1px solid ${(e.vars||e).palette.text.secondary}`}}}]}),Ol=(e,n)=>{const{ownerState:s}=e;return[n.root,!s.disableMargin&&n.dayWithMargin,!s.disableHighlightToday&&s.isDayCurrent&&n.today,s.isDayOutsideMonth&&s.showDaysOutsideCurrentMonth&&n.dayOutsideMonth,s.isDayOutsideMonth&&!s.showDaysOutsideCurrentMonth&&n.hiddenDaySpacingFiller]},Ff=Je(vc,{name:"MuiPickersDay",slot:"Root",overridesResolver:Ol})(Pl),Lf=Je("div",{name:"MuiPickersDay",slot:"Root",overridesResolver:Ol})(({theme:e})=>_e({},Pl({theme:e}),{opacity:0,pointerEvents:"none"})),wr=()=>{},Rf=f.forwardRef(function(n,s){const o=Kt({props:n,name:"MuiPickersDay"}),{autoFocus:l=!1,className:u,classes:d,isAnimating:m,onClick:y,onDaySelect:g,onFocus:w=wr,onBlur:b=wr,onKeyDown:C=wr,onMouseDown:x=wr,onMouseEnter:j=wr,children:I,day:k,selected:M,disabled:D,today:q,outsideCurrentMonth:O,disableMargin:Q,disableHighlightToday:T,showDaysOutsideCurrentMonth:P}=o,U=mt(o,_f),Y=Al({day:k,selected:M,disabled:D,today:q,outsideCurrentMonth:O,disableMargin:Q,disableHighlightToday:T,showDaysOutsideCurrentMonth:P}),J=If(d,Y),ne=jt(),G=f.useRef(null),oe=gi(G,s);Ya(()=>{l&&!D&&!m&&!O&&G.current.focus()},[l,D,m,O]);const te=K=>{x(K),O&&K.preventDefault()},z=K=>{K.defaultMuiPrevented=!0,D||g(k),O&&K.currentTarget.focus(),y&&y(K)};return O&&!P?t.jsx(Lf,{className:Mt(J.root,J.hiddenDaySpacingFiller,u),ownerState:Y,role:U.role}):t.jsx(Ff,_e({className:Mt(J.root,u),ref:oe,centerRipple:!0,disabled:D,tabIndex:M?0:-1,onKeyDown:K=>C(K,k),onFocus:K=>w(K,k),onBlur:K=>b(K,k),onMouseEnter:K=>j(K,k),onClick:z,onMouseDown:te},U,{ownerState:Y,children:I??ne.format(k,"dayOfMonth")}))}),$f=f.memo(Rf),Bf=()=>Xa().defaultDates,Ps=e=>{const n=jt(),s=f.useRef(void 0);return s.current===void 0&&(s.current=n.date(void 0,e)),s.current},zf=e=>Xt("MuiPickersSlideTransition",e),Ot=Jt("MuiPickersSlideTransition",["root","slideEnter-left","slideEnter-right","slideEnterActive","slideExit","slideExitActiveLeft-left","slideExitActiveLeft-right"]),Vf=["children","className","reduceAnimations","slideDirection","transKey","classes"],Yf=(e,n)=>{const{slideDirection:s}=n,o={root:["root"],exit:["slideExit"],enterActive:["slideEnterActive"],enter:[`slideEnter-${s}`],exitActive:[`slideExitActiveLeft-${s}`]};return It(o,zf,e)},Kf=Je(pi,{name:"MuiPickersSlideTransition",slot:"Root",overridesResolver:(e,n)=>[n.root,{[`.${Ot["slideEnter-left"]}`]:n["slideEnter-left"]},{[`.${Ot["slideEnter-right"]}`]:n["slideEnter-right"]},{[`.${Ot.slideEnterActive}`]:n.slideEnterActive},{[`.${Ot.slideExit}`]:n.slideExit},{[`.${Ot["slideExitActiveLeft-left"]}`]:n["slideExitActiveLeft-left"]},{[`.${Ot["slideExitActiveLeft-right"]}`]:n["slideExitActiveLeft-right"]}]})(({theme:e})=>{const n=e.transitions.create("transform",{duration:e.transitions.duration.complex,easing:"cubic-bezier(0.35, 0.8, 0.4, 1)"});return{display:"block",position:"relative",overflowX:"hidden","& > *":{position:"absolute",top:0,right:0,left:0},[`& .${Ot["slideEnter-left"]}`]:{willChange:"transform",transform:"translate(100%)",zIndex:1},[`& .${Ot["slideEnter-right"]}`]:{willChange:"transform",transform:"translate(-100%)",zIndex:1},[`& .${Ot.slideEnterActive}`]:{transform:"translate(0%)",transition:n},[`& .${Ot.slideExit}`]:{transform:"translate(0%)"},[`& .${Ot["slideExitActiveLeft-left"]}`]:{willChange:"transform",transform:"translate(-100%)",transition:n,zIndex:0},[`& .${Ot["slideExitActiveLeft-right"]}`]:{willChange:"transform",transform:"translate(100%)",transition:n,zIndex:0}}});function Wf(e){const n=Kt({props:e,name:"MuiPickersSlideTransition"}),{children:s,className:o,reduceAnimations:l,slideDirection:u,transKey:d,classes:m}=n,y=mt(n,Vf),{ownerState:g}=Zt(),w=_e({},g,{slideDirection:u}),b=Yf(m,w),C=Va();if(l)return t.jsx("div",{className:Mt(b.root,o),children:s});const x={exit:b.exit,enterActive:b.enterActive,enter:b.enter,exitActive:b.exitActive};return t.jsx(Kf,{className:Mt(b.root,o),childFactory:j=>f.cloneElement(j,{classNames:x}),role:"presentation",ownerState:w,children:t.jsx(bc,_e({mountOnEnter:!0,unmountOnExit:!0,timeout:C.transitions.duration.complex,classNames:x},y,{children:s}),d)})}const Hf=e=>Xt("MuiDayCalendar",e);Jt("MuiDayCalendar",["root","header","weekDayLabel","loadingContainer","slideTransition","monthContainer","weekContainer","weekNumberLabel","weekNumber"]);const Uf=["parentProps","day","focusedDay","selectedDays","isDateDisabled","currentMonthNumber","isViewFocused"],qf=["ownerState"],Gf=e=>It({root:["root"],header:["header"],weekDayLabel:["weekDayLabel"],loadingContainer:["loadingContainer"],slideTransition:["slideTransition"],monthContainer:["monthContainer"],weekContainer:["weekContainer"],weekNumberLabel:["weekNumberLabel"],weekNumber:["weekNumber"]},Hf,e),El=(Ar+As*2)*6,Qf=Je("div",{name:"MuiDayCalendar",slot:"Root"})({}),Xf=Je("div",{name:"MuiDayCalendar",slot:"Header"})({display:"flex",justifyContent:"center",alignItems:"center"}),Jf=Je(St,{name:"MuiDayCalendar",slot:"WeekDayLabel"})(({theme:e})=>({width:36,height:40,margin:"0 2px",textAlign:"center",display:"flex",justifyContent:"center",alignItems:"center",color:(e.vars||e).palette.text.secondary})),Zf=Je(St,{name:"MuiDayCalendar",slot:"WeekNumberLabel"})(({theme:e})=>({width:36,height:40,margin:"0 2px",textAlign:"center",display:"flex",justifyContent:"center",alignItems:"center",color:(e.vars||e).palette.text.disabled})),em=Je(St,{name:"MuiDayCalendar",slot:"WeekNumber"})(({theme:e})=>_e({},e.typography.caption,{width:Ar,height:Ar,padding:0,margin:`0 ${As}px`,color:(e.vars||e).palette.text.disabled,fontSize:"0.75rem",alignItems:"center",justifyContent:"center",display:"inline-flex"})),tm=Je("div",{name:"MuiDayCalendar",slot:"LoadingContainer"})({display:"flex",justifyContent:"center",alignItems:"center",minHeight:El}),nm=Je(Wf,{name:"MuiDayCalendar",slot:"SlideTransition"})({minHeight:El}),rm=Je("div",{name:"MuiDayCalendar",slot:"MonthContainer"})({overflow:"hidden"}),sm=Je("div",{name:"MuiDayCalendar",slot:"WeekContainer"})({margin:`${As}px 0`,display:"flex",justifyContent:"center"});function am(e){let{parentProps:n,day:s,focusedDay:o,selectedDays:l,isDateDisabled:u,currentMonthNumber:d,isViewFocused:m}=e,y=mt(e,Uf);const{disabled:g,disableHighlightToday:w,isMonthSwitchingAnimating:b,showDaysOutsideCurrentMonth:C,slots:x,slotProps:j,timezone:I}=n,k=jt(),M=Ps(I),D=o!=null&&k.isSameDay(s,o),q=m&&D,O=l.some(te=>k.isSameDay(te,s)),Q=k.isSameDay(s,M),T=f.useMemo(()=>g||u(s),[g,u,s]),P=f.useMemo(()=>k.getMonth(s)!==d,[k,s,d]),U=Al({day:s,selected:O,disabled:T,today:Q,outsideCurrentMonth:P,disableMargin:void 0,disableHighlightToday:w,showDaysOutsideCurrentMonth:C}),Y=(x==null?void 0:x.day)??$f,J=Vt({elementType:Y,externalSlotProps:j==null?void 0:j.day,additionalProps:_e({disableHighlightToday:w,showDaysOutsideCurrentMonth:C,role:"gridcell",isAnimating:b,"data-timestamp":k.toJsDate(s).valueOf()},y),ownerState:_e({},U,{day:s,isDayDisabled:T,isDaySelected:O})}),ne=mt(J,qf),G=f.useMemo(()=>{const te=k.startOfMonth(k.setMonth(s,d));return C?k.isSameDay(s,k.startOfWeek(te)):k.isSameDay(s,te)},[d,s,C,k]),oe=f.useMemo(()=>{const te=k.endOfMonth(k.setMonth(s,d));return C?k.isSameDay(s,k.endOfWeek(te)):k.isSameDay(s,te)},[d,s,C,k]);return t.jsx(Y,_e({},ne,{day:s,disabled:T,autoFocus:!P&&q,today:Q,outsideCurrentMonth:P,isFirstVisibleCell:G,isLastVisibleCell:oe,selected:O,tabIndex:D?0:-1,"aria-selected":O,"aria-current":Q?"date":void 0}))}function om(e){const n=Kt({props:e,name:"MuiDayCalendar"}),s=jt(),{onFocusedDayChange:o,className:l,classes:u,currentMonth:d,selectedDays:m,focusedDay:y,loading:g,onSelectedDaysChange:w,onMonthSwitchingAnimationEnd:b,readOnly:C,reduceAnimations:x,renderLoading:j=()=>t.jsx("span",{children:"..."}),slideDirection:I,TransitionProps:k,disablePast:M,disableFuture:D,minDate:q,maxDate:O,shouldDisableDate:Q,shouldDisableMonth:T,shouldDisableYear:P,dayOfWeekFormatter:U=X=>s.format(X,"weekdayShort").charAt(0).toUpperCase(),hasFocus:Y,onFocusedViewChange:J,gridLabelId:ne,displayWeekNumber:G,fixedWeekNumber:oe,timezone:te}=n,z=Ps(te),K=Gf(u),W=bs(),ee=Sl({shouldDisableDate:Q,shouldDisableMonth:T,shouldDisableYear:P,minDate:q,maxDate:O,disablePast:M,disableFuture:D,timezone:te}),ie=Dl(),me=rt(X=>{C||w(X)}),ke=X=>{ee(X)||(o(X),J==null||J(!0))},Te=rt((X,se)=>{switch(X.key){case"ArrowUp":ke(s.addDays(se,-7)),X.preventDefault();break;case"ArrowDown":ke(s.addDays(se,7)),X.preventDefault();break;case"ArrowLeft":{const Ce=s.addDays(se,W?1:-1),we=s.addMonths(se,W?1:-1),re=Tr({adapter:s,date:Ce,minDate:W?Ce:s.startOfMonth(we),maxDate:W?s.endOfMonth(we):Ce,isDateDisabled:ee,timezone:te});ke(re||Ce),X.preventDefault();break}case"ArrowRight":{const Ce=s.addDays(se,W?-1:1),we=s.addMonths(se,W?-1:1),re=Tr({adapter:s,date:Ce,minDate:W?s.startOfMonth(we):Ce,maxDate:W?Ce:s.endOfMonth(we),isDateDisabled:ee,timezone:te});ke(re||Ce),X.preventDefault();break}case"Home":ke(s.startOfWeek(se)),X.preventDefault();break;case"End":ke(s.endOfWeek(se)),X.preventDefault();break;case"PageUp":ke(s.addMonths(se,1)),X.preventDefault();break;case"PageDown":ke(s.addMonths(se,-1)),X.preventDefault();break}}),Ae=rt((X,se)=>ke(se)),Be=rt((X,se)=>{y!=null&&s.isSameDay(y,se)&&(J==null||J(!1))}),de=s.getMonth(d),Le=s.getYear(d),Ve=f.useMemo(()=>m.filter(X=>!!X).map(X=>s.startOfDay(X)),[s,m]),tt=`${Le}-${de}`,ce=f.useMemo(()=>f.createRef(),[tt]),Ie=f.useMemo(()=>{const X=s.getWeekArray(d);let se=s.addMonths(d,1);for(;oe&&X.length<oe;){const Ce=s.getWeekArray(se),we=s.isSameDay(X[X.length-1][0],Ce[0][0]);Ce.slice(we?1:0).forEach(re=>{X.length<oe&&X.push(re)}),se=s.addMonths(se,1)}return X},[d,oe,s]);return t.jsxs(Qf,{role:"grid","aria-labelledby":ne,className:K.root,children:[t.jsxs(Xf,{role:"row",className:K.header,children:[G&&t.jsx(Zf,{variant:"caption",role:"columnheader","aria-label":ie.calendarWeekNumberHeaderLabel,className:K.weekNumberLabel,children:ie.calendarWeekNumberHeaderText}),vf(s,z).map((X,se)=>t.jsx(Jf,{variant:"caption",role:"columnheader","aria-label":s.format(X,"weekday"),className:K.weekDayLabel,children:U(X)},se.toString()))]}),g?t.jsx(tm,{className:K.loadingContainer,children:j()}):t.jsx(nm,_e({transKey:tt,onExited:b,reduceAnimations:x,slideDirection:I,className:Mt(l,K.slideTransition)},k,{nodeRef:ce,children:t.jsx(rm,{ref:ce,role:"rowgroup",className:K.monthContainer,children:Ie.map((X,se)=>t.jsxs(sm,{role:"row",className:K.weekContainer,"aria-rowindex":se+1,children:[G&&t.jsx(em,{className:K.weekNumber,role:"rowheader","aria-label":ie.calendarWeekNumberAriaLabelText(s.getWeekNumber(X[0])),children:ie.calendarWeekNumberText(s.getWeekNumber(X[0]))}),X.map((Ce,we)=>t.jsx(am,{parentProps:n,day:Ce,selectedDays:Ve,isViewFocused:Y,focusedDay:y,onKeyDown:Te,onFocus:Ae,onBlur:Be,onDaySelect:me,isDateDisabled:ee,currentMonthNumber:de,"aria-colindex":we+1},Ce.toString()))]},`week-${X[0]}`))})}))]})}function _l(e){return Xt("MuiMonthCalendar",e)}const os=Jt("MuiMonthCalendar",["root","button","disabled","selected"]),im=["autoFocus","classes","disabled","selected","value","onClick","onKeyDown","onFocus","onBlur","slots","slotProps"],lm=(e,n)=>{const s={button:["button",n.isMonthDisabled&&"disabled",n.isMonthSelected&&"selected"]};return It(s,_l,e)},cm=Je("button",{name:"MuiMonthCalendar",slot:"Button",overridesResolver:(e,n)=>[n.button,{[`&.${os.disabled}`]:n.disabled},{[`&.${os.selected}`]:n.selected}]})(({theme:e})=>_e({color:"unset",backgroundColor:"transparent",border:0,outline:0},e.typography.subtitle1,{height:36,width:72,borderRadius:18,cursor:"pointer","&:focus":{backgroundColor:e.vars?`rgba(${e.vars.palette.action.activeChannel} / ${e.vars.palette.action.hoverOpacity})`:nr(e.palette.action.active,e.palette.action.hoverOpacity)},"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette.action.activeChannel} / ${e.vars.palette.action.hoverOpacity})`:nr(e.palette.action.active,e.palette.action.hoverOpacity)},"&:disabled":{cursor:"auto",pointerEvents:"none"},[`&.${os.disabled}`]:{color:(e.vars||e).palette.text.secondary},[`&.${os.selected}`]:{color:(e.vars||e).palette.primary.contrastText,backgroundColor:(e.vars||e).palette.primary.main,"&:focus, &:hover":{backgroundColor:(e.vars||e).palette.primary.dark}}})),um=f.memo(function(n){const{autoFocus:s,classes:o,disabled:l,selected:u,value:d,onClick:m,onKeyDown:y,onFocus:g,onBlur:w,slots:b,slotProps:C}=n,x=mt(n,im),j=f.useRef(null),{ownerState:I}=Zt(),k=_e({},I,{isMonthDisabled:l,isMonthSelected:u}),M=lm(o,k);Ya(()=>{var O;s&&((O=j.current)==null||O.focus())},[s]);const D=(b==null?void 0:b.monthButton)??cm,q=Vt({elementType:D,externalSlotProps:C==null?void 0:C.monthButton,externalForwardedProps:x,additionalProps:{disabled:l,ref:j,type:"button",role:"radio","aria-checked":u,onClick:O=>m(O,d),onKeyDown:O=>y(O,d),onFocus:O=>g(O,d),onBlur:O=>w(O,d)},ownerState:k,className:M.button});return t.jsx(D,_e({},q))}),Za=({name:e,timezone:n,value:s,defaultValue:o,referenceDate:l,onChange:u,valueManager:d})=>{const m=jt(),[y,g]=Cr({name:e,state:"value",controlled:s,default:o??d.emptyValue}),w=f.useMemo(()=>d.getTimezone(m,y),[m,d,y]),b=rt(I=>w==null?I:d.setTimezone(m,w,I)),C=f.useMemo(()=>n||w||(l?m.getTimezone(Array.isArray(l)?l[0]:l):"default"),[n,w,l,m]),x=f.useMemo(()=>d.setTimezone(m,C,y),[d,m,C,y]),j=rt((I,...k)=>{const M=b(I);g(M),u==null||u(M,...k)});return{value:x,handleValueChange:j,timezone:C}};function eo(e){const n=jt(),s=Bf();return f.useMemo(()=>({disablePast:e.disablePast??!1,disableFuture:e.disableFuture??!1,minDate:Jo(n,e.minDate,s.minDate),maxDate:Jo(n,e.maxDate,s.maxDate)}),[e.minDate,e.maxDate,e.disableFuture,e.disablePast,n,s])}const dm=["autoFocus","className","currentMonth","classes","value","defaultValue","referenceDate","disabled","disableFuture","disablePast","maxDate","minDate","onChange","shouldDisableMonth","readOnly","disableHighlightToday","onMonthFocus","hasFocus","onFocusedViewChange","monthsPerRow","timezone","gridLabelId","slots","slotProps"],hm=e=>It({root:["root"]},_l,e);function fm(e,n){const s=Kt({props:e,name:n}),o=eo(s);return _e({},s,o,{monthsPerRow:s.monthsPerRow??3})}const ei=(e,n,s,o,l)=>!!(e===n&&o&&l.isSameYear(s,o)),mm=Je("div",{name:"MuiMonthCalendar",slot:"Root",shouldForwardProp:e=>yi(e)&&e!=="monthsPerRow"})({display:"flex",flexWrap:"wrap",justifyContent:"space-evenly",rowGap:16,padding:"8px 0",width:Ja,boxSizing:"border-box",variants:[{props:{monthsPerRow:3},style:{columnGap:24}},{props:{monthsPerRow:4},style:{columnGap:0}}]}),pm=f.forwardRef(function(n,s){const o=fm(n,"MuiMonthCalendar"),{autoFocus:l,className:u,currentMonth:d,classes:m,value:y,defaultValue:g,referenceDate:w,disabled:b,disableFuture:C,disablePast:x,maxDate:j,minDate:I,onChange:k,shouldDisableMonth:M,readOnly:D,onMonthFocus:q,hasFocus:O,onFocusedViewChange:Q,monthsPerRow:T,timezone:P,gridLabelId:U,slots:Y,slotProps:J}=o,ne=mt(o,dm),{value:G,handleValueChange:oe,timezone:te}=Za({name:"MonthCalendar",timezone:P,value:y,defaultValue:g,referenceDate:w,onChange:k,valueManager:Bn}),z=Ps(te),K=bs(),W=jt(),{ownerState:ee}=Zt(),ie=f.useMemo(()=>Bn.getInitialReferenceValue({value:G,adapter:W,props:o,timezone:te,referenceDate:w,granularity:qt.month}),[]),me=hm(m),ke=f.useMemo(()=>W.getMonth(z),[W,z]),Te=f.useMemo(()=>G!=null?W.getMonth(G):null,[G,W]),[Ae,Be]=f.useState(()=>Te||W.getMonth(ie)),[de,Le]=Cr({name:"MonthCalendar",state:"hasFocus",controlled:O,default:l??!1}),Ve=rt(we=>{Le(we),Q&&Q(we)}),tt=f.useCallback(we=>{const re=W.startOfMonth(x&&W.isAfter(z,I)?z:I),Pe=W.startOfMonth(C&&W.isBefore(z,j)?z:j),qe=W.startOfMonth(we);return W.isBefore(qe,re)||W.isAfter(qe,Pe)?!0:M?M(qe):!1},[C,x,j,I,z,M,W]),ce=rt((we,re)=>{if(D)return;const qe=(G&&d&&!W.isSameYear(G,d)?W.setYear(G,W.getYear(d)):G)??d??ie,Ze=W.setMonth(qe,re);oe(Ze)}),Ie=rt(we=>{tt(W.setMonth(G??d??ie,we))||(Be(we),Ve(!0),q&&q(we))});f.useEffect(()=>{Be(we=>Te!==null&&we!==Te?Te:we)},[Te]);const X=rt((we,re)=>{switch(we.key){case"ArrowUp":Ie((12+re-3)%12),we.preventDefault();break;case"ArrowDown":Ie((12+re+3)%12),we.preventDefault();break;case"ArrowLeft":Ie((12+re+(K?1:-1))%12),we.preventDefault();break;case"ArrowRight":Ie((12+re+(K?-1:1))%12),we.preventDefault();break}}),se=rt((we,re)=>{Ie(re)}),Ce=rt((we,re)=>{Ae===re&&Ve(!1)});return t.jsx(mm,_e({ref:s,className:Mt(me.root,u),ownerState:ee,role:"radiogroup","aria-labelledby":U,monthsPerRow:T},ne,{children:xf(W,d??G??ie).map(we=>{const re=W.getMonth(we),Pe=W.format(we,"monthShort"),qe=W.format(we,"month"),Ze=ei(re,Te,we,G,W),st=b||tt(we);return t.jsx(um,{selected:Ze,value:re,onClick:ce,onKeyDown:X,autoFocus:de&&re===Ae,disabled:st,tabIndex:re===Ae&&!st?0:-1,onFocus:se,onBlur:Ce,"aria-current":ei(re,ke,we,z,W)?"date":void 0,"aria-label":qe,slots:Y,slotProps:J,classes:m,children:Pe},Pe)})}))});function Il(e){return Xt("MuiYearCalendar",e)}const is=Jt("MuiYearCalendar",["root","button","disabled","selected"]),gm=["autoFocus","classes","disabled","selected","value","onClick","onKeyDown","onFocus","onBlur","slots","slotProps"],ym=(e,n)=>{const s={button:["button",n.isYearDisabled&&"disabled",n.isYearSelected&&"selected"]};return It(s,Il,e)},xm=Je("button",{name:"MuiYearCalendar",slot:"Button",overridesResolver:(e,n)=>[n.button,{[`&.${is.disabled}`]:n.disabled},{[`&.${is.selected}`]:n.selected}]})(({theme:e})=>_e({color:"unset",backgroundColor:"transparent",border:0,outline:0},e.typography.subtitle1,{height:36,width:72,borderRadius:18,cursor:"pointer","&:focus":{backgroundColor:e.vars?`rgba(${e.vars.palette.action.activeChannel} / ${e.vars.palette.action.focusOpacity})`:nr(e.palette.action.active,e.palette.action.focusOpacity)},"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette.action.activeChannel} / ${e.vars.palette.action.hoverOpacity})`:nr(e.palette.action.active,e.palette.action.hoverOpacity)},"&:disabled":{cursor:"auto",pointerEvents:"none"},[`&.${is.disabled}`]:{color:(e.vars||e).palette.text.secondary},[`&.${is.selected}`]:{color:(e.vars||e).palette.primary.contrastText,backgroundColor:(e.vars||e).palette.primary.main,"&:focus, &:hover":{backgroundColor:(e.vars||e).palette.primary.dark}}})),vm=f.memo(function(n){const{autoFocus:s,classes:o,disabled:l,selected:u,value:d,onClick:m,onKeyDown:y,onFocus:g,onBlur:w,slots:b,slotProps:C}=n,x=mt(n,gm),j=f.useRef(null),{ownerState:I}=Zt(),k=_e({},I,{isYearDisabled:l,isYearSelected:u}),M=ym(o,k);Ya(()=>{var O;s&&((O=j.current)==null||O.focus())},[s]);const D=(b==null?void 0:b.yearButton)??xm,q=Vt({elementType:D,externalSlotProps:C==null?void 0:C.yearButton,externalForwardedProps:x,additionalProps:{disabled:l,ref:j,type:"button",role:"radio","aria-checked":u,onClick:O=>m(O,d),onKeyDown:O=>y(O,d),onFocus:O=>g(O,d),onBlur:O=>w(O,d)},ownerState:k,className:M.button});return t.jsx(D,_e({},q))}),bm=["autoFocus","className","classes","value","defaultValue","referenceDate","disabled","disableFuture","disablePast","maxDate","minDate","onChange","readOnly","shouldDisableYear","disableHighlightToday","onYearFocus","hasFocus","onFocusedViewChange","yearsOrder","yearsPerRow","timezone","gridLabelId","slots","slotProps"],wm=e=>It({root:["root"]},Il,e);function jm(e,n){const s=Kt({props:e,name:n}),o=eo(s);return _e({},s,o,{yearsPerRow:s.yearsPerRow??3,yearsOrder:s.yearsOrder??"asc"})}const km=Je("div",{name:"MuiYearCalendar",slot:"Root",shouldForwardProp:e=>yi(e)&&e!=="yearsPerRow"})({display:"flex",flexWrap:"wrap",justifyContent:"space-evenly",rowGap:12,padding:"6px 0",overflowY:"auto",height:"100%",width:Ja,maxHeight:Of,boxSizing:"border-box",position:"relative",variants:[{props:{yearsPerRow:3},style:{columnGap:24}},{props:{yearsPerRow:4},style:{columnGap:0,padding:"0 2px"}}]}),Cm=Je("div",{name:"MuiYearCalendar",slot:"ButtonFiller"})({height:36,width:72}),Nm=f.forwardRef(function(n,s){const o=jm(n,"MuiYearCalendar"),{autoFocus:l,className:u,classes:d,value:m,defaultValue:y,referenceDate:g,disabled:w,disableFuture:b,disablePast:C,maxDate:x,minDate:j,onChange:I,readOnly:k,shouldDisableYear:M,onYearFocus:D,hasFocus:q,onFocusedViewChange:O,yearsOrder:Q,yearsPerRow:T,timezone:P,gridLabelId:U,slots:Y,slotProps:J}=o,ne=mt(o,bm),{value:G,handleValueChange:oe,timezone:te}=Za({name:"YearCalendar",timezone:P,value:m,defaultValue:y,referenceDate:g,onChange:I,valueManager:Bn}),z=Ps(te),K=bs(),W=jt(),{ownerState:ee}=Zt(),ie=f.useMemo(()=>Bn.getInitialReferenceValue({value:G,adapter:W,props:o,timezone:te,referenceDate:g,granularity:qt.year}),[]),me=wm(d),ke=f.useMemo(()=>W.getYear(z),[W,z]),Te=f.useMemo(()=>G!=null?W.getYear(G):null,[G,W]),[Ae,Be]=f.useState(()=>Te||W.getYear(ie)),[de,Le]=Cr({name:"YearCalendar",state:"hasFocus",controlled:q,default:l??!1}),Ve=rt(Ee=>{Le(Ee),O&&O(Ee)}),tt=f.useCallback(Ee=>{if(C&&W.isBeforeYear(Ee,z)||b&&W.isAfterYear(Ee,z)||j&&W.isBeforeYear(Ee,j)||x&&W.isAfterYear(Ee,x))return!0;if(!M)return!1;const Re=W.startOfYear(Ee);return M(Re)},[b,C,x,j,z,M,W]),ce=rt((Ee,Re)=>{if(k)return;const kt=W.setYear(G??ie,Re);oe(kt)}),Ie=rt(Ee=>{tt(W.setYear(G??ie,Ee))||(Be(Ee),Ve(!0),D==null||D(Ee))});f.useEffect(()=>{Be(Ee=>Te!==null&&Ee!==Te?Te:Ee)},[Te]);const X=Q!=="desc"?T*1:T*-1,se=K&&Q==="asc"||!K&&Q==="desc"?-1:1,Ce=rt((Ee,Re)=>{switch(Ee.key){case"ArrowUp":Ie(Re-X),Ee.preventDefault();break;case"ArrowDown":Ie(Re+X),Ee.preventDefault();break;case"ArrowLeft":Ie(Re-se),Ee.preventDefault();break;case"ArrowRight":Ie(Re+se),Ee.preventDefault();break}}),we=rt((Ee,Re)=>{Ie(Re)}),re=rt((Ee,Re)=>{Ae===Re&&Ve(!1)}),Pe=f.useRef(null),qe=gi(s,Pe);f.useEffect(()=>{if(l||Pe.current===null)return;const Ee=Pe.current.querySelector('[tabindex="0"]');if(!Ee)return;const Re=Ee.offsetHeight,kt=Ee.offsetTop,pt=Pe.current.clientHeight,Wt=Pe.current.scrollTop,Ct=kt+Re;Re>pt||kt<Wt||(Pe.current.scrollTop=Ct-pt/2-Re/2)},[l]);const Ze=W.getYearRange([j,x]);Q==="desc"&&Ze.reverse();let st=T-Ze.length%T;return st===T&&(st=0),t.jsxs(km,_e({ref:qe,className:Mt(me.root,u),ownerState:ee,role:"radiogroup","aria-labelledby":U,yearsPerRow:T},ne,{children:[Ze.map(Ee=>{const Re=W.getYear(Ee),kt=Re===Te,pt=w||tt(Ee);return t.jsx(vm,{selected:kt,value:Re,onClick:ce,onKeyDown:Ce,autoFocus:de&&Re===Ae,disabled:pt,tabIndex:Re===Ae&&!pt?0:-1,onFocus:we,onBlur:re,"aria-current":ke===Re?"date":void 0,slots:Y,slotProps:J,classes:d,children:W.format(Ee,"year")},W.format(Ee,"year"))}),Array.from({length:st},(Ee,Re)=>t.jsx(Cm,{},Re))]}))}),Dm={hasNextStep:!1,hasSeveralSteps:!1,goToNextStep:()=>{},areViewsInSameStep:()=>!0};function Sm({onChange:e,onViewChange:n,openTo:s,view:o,views:l,autoFocus:u,focusedView:d,onFocusedViewChange:m,getStepNavigation:y}){const g=f.useRef(s),w=f.useRef(l),b=f.useRef(l.includes(s)?s:l[0]),[C,x]=Cr({name:"useViews",state:"view",controlled:o,default:b.current}),j=f.useRef(u?C:null),[I,k]=Cr({name:"useViews",state:"focusedView",controlled:d,default:j.current}),M=y?y({setView:x,view:C,defaultView:b.current,views:l}):Dm;f.useEffect(()=>{(g.current&&g.current!==s||w.current&&w.current.some(Y=>!l.includes(Y)))&&(x(l.includes(s)?s:l[0]),w.current=l,g.current=s)},[s,x,C,l]);const D=l.indexOf(C),q=l[D-1]??null,O=l[D+1]??null,Q=rt((Y,J)=>{k(J?Y:ne=>Y===ne?null:ne),m==null||m(Y,J)}),T=rt(Y=>{Q(Y,!0),Y!==C&&(x(Y),n&&n(Y))}),P=rt(()=>{O&&T(O)}),U=rt((Y,J,ne)=>{const G=J==="finish",oe=ne?l.indexOf(ne)<l.length-1:!!O;e(Y,G&&oe?"partial":J,ne);let z=null;if(ne!=null&&ne!==C?z=ne:G&&(z=C),z==null)return;const K=l[l.indexOf(z)+1];K==null||!M.areViewsInSameStep(z,K)||T(K)});return _e({},M,{view:C,setView:T,focusedView:I,setFocusedView:Q,nextView:O,previousView:q,defaultView:l.includes(s)?s:l[0],goToNextView:P,setValueAndGoToNextView:U})}const Mm=e=>Xt("MuiPickersCalendarHeader",e),Tm=Jt("MuiPickersCalendarHeader",["root","labelContainer","label","switchViewButton","switchViewIcon"]),Am=kn(t.jsx("path",{d:"M7 10l5 5 5-5z"})),Pm=kn(t.jsx("path",{d:"M15.41 16.59L10.83 12l4.58-4.59L14 6l-6 6 6 6 1.41-1.41z"})),Om=kn(t.jsx("path",{d:"M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"}));kn(t.jsx("path",{d:"M17 12h-5v5h5v-5zM16 1v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-1V1h-2zm3 18H5V8h14v11z"}));kn(t.jsxs(f.Fragment,{children:[t.jsx("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),t.jsx("path",{d:"M12.5 7H11v6l5.25 3.15.75-1.23-4.5-2.67z"})]}));kn(t.jsx("path",{d:"M9 11H7v2h2v-2zm4 0h-2v2h2v-2zm4 0h-2v2h2v-2zm2-7h-1V2h-2v2H8V2H6v2H5c-1.11 0-1.99.9-1.99 2L3 20c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 16H5V9h14v11z"}));kn(t.jsxs(f.Fragment,{children:[t.jsx("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),t.jsx("path",{d:"M12.5 7H11v6l5.25 3.15.75-1.23-4.5-2.67z"})]}));kn(t.jsx("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}));function Em(e){return Xt("MuiPickersArrowSwitcher",e)}Jt("MuiPickersArrowSwitcher",["root","spacer","button","previousIconButton","nextIconButton","leftArrowIcon","rightArrowIcon"]);const _m=["children","className","slots","slotProps","isNextDisabled","isNextHidden","onGoToNext","nextLabel","isPreviousDisabled","isPreviousHidden","onGoToPrevious","previousLabel","labelId","classes"],Im=["ownerState"],Fm=["ownerState"],Lm=Je("div",{name:"MuiPickersArrowSwitcher",slot:"Root"})({display:"flex"}),Rm=Je("div",{name:"MuiPickersArrowSwitcher",slot:"Spacer"})(({theme:e})=>({width:e.spacing(3)})),ti=Je(_n,{name:"MuiPickersArrowSwitcher",slot:"Button"})({variants:[{props:{isButtonHidden:!0},style:{visibility:"hidden"}}]}),$m=e=>It({root:["root"],spacer:["spacer"],button:["button"],previousIconButton:["previousIconButton"],nextIconButton:["nextIconButton"],leftArrowIcon:["leftArrowIcon"],rightArrowIcon:["rightArrowIcon"]},Em,e),Bm=f.forwardRef(function(n,s){const o=bs(),l=Kt({props:n,name:"MuiPickersArrowSwitcher"}),{children:u,className:d,slots:m,slotProps:y,isNextDisabled:g,isNextHidden:w,onGoToNext:b,nextLabel:C,isPreviousDisabled:x,isPreviousHidden:j,onGoToPrevious:I,previousLabel:k,labelId:M,classes:D}=l,q=mt(l,_m),{ownerState:O}=Zt(),Q=$m(D),T={isDisabled:g,isHidden:w,goTo:b,label:C},P={isDisabled:x,isHidden:j,goTo:I,label:k},U=(m==null?void 0:m.previousIconButton)??ti,Y=Vt({elementType:U,externalSlotProps:y==null?void 0:y.previousIconButton,additionalProps:{size:"medium",title:P.label,"aria-label":P.label,disabled:P.isDisabled,edge:"end",onClick:P.goTo},ownerState:_e({},O,{isButtonHidden:P.isHidden??!1}),className:Mt(Q.button,Q.previousIconButton)}),J=(m==null?void 0:m.nextIconButton)??ti,ne=Vt({elementType:J,externalSlotProps:y==null?void 0:y.nextIconButton,additionalProps:{size:"medium",title:T.label,"aria-label":T.label,disabled:T.isDisabled,edge:"start",onClick:T.goTo},ownerState:_e({},O,{isButtonHidden:T.isHidden??!1}),className:Mt(Q.button,Q.nextIconButton)}),G=(m==null?void 0:m.leftArrowIcon)??Pm,oe=Vt({elementType:G,externalSlotProps:y==null?void 0:y.leftArrowIcon,additionalProps:{fontSize:"inherit"},ownerState:O,className:Q.leftArrowIcon}),te=mt(oe,Im),z=(m==null?void 0:m.rightArrowIcon)??Om,K=Vt({elementType:z,externalSlotProps:y==null?void 0:y.rightArrowIcon,additionalProps:{fontSize:"inherit"},ownerState:O,className:Q.rightArrowIcon}),W=mt(K,Fm);return t.jsxs(Lm,_e({ref:s,className:Mt(Q.root,d),ownerState:O},q,{children:[t.jsx(U,_e({},Y,{children:o?t.jsx(z,_e({},W)):t.jsx(G,_e({},te))})),u?t.jsx(St,{variant:"subtitle1",component:"span",id:M,children:u}):t.jsx(Rm,{className:Q.spacer,ownerState:O}),t.jsx(J,_e({},ne,{children:o?t.jsx(G,_e({},te)):t.jsx(z,_e({},W))}))]}))});function zm(e,{disableFuture:n,maxDate:s,timezone:o}){const l=jt();return f.useMemo(()=>{const u=l.date(void 0,o),d=l.startOfMonth(n&&l.isBefore(u,s)?u:s);return!l.isAfter(d,e)},[n,s,e,l,o])}function Vm(e,{disablePast:n,minDate:s,timezone:o}){const l=jt();return f.useMemo(()=>{const u=l.date(void 0,o),d=l.startOfMonth(n&&l.isAfter(u,s)?u:s);return!l.isBefore(d,e)},[n,s,e,l,o])}const Ym=["slots","slotProps","currentMonth","disabled","disableFuture","disablePast","maxDate","minDate","onMonthChange","onViewChange","view","reduceAnimations","views","labelId","className","classes","timezone","format"],Km=["ownerState"],Wm=e=>It({root:["root"],labelContainer:["labelContainer"],label:["label"],switchViewButton:["switchViewButton"],switchViewIcon:["switchViewIcon"]},Mm,e),Hm=Je("div",{name:"MuiPickersCalendarHeader",slot:"Root"})({display:"flex",alignItems:"center",marginTop:12,marginBottom:4,paddingLeft:24,paddingRight:12,maxHeight:40,minHeight:40}),Um=Je("div",{name:"MuiPickersCalendarHeader",slot:"LabelContainer"})(({theme:e})=>_e({display:"flex",overflow:"hidden",alignItems:"center",cursor:"pointer",marginRight:"auto"},e.typography.body1,{fontWeight:e.typography.fontWeightMedium})),qm=Je("div",{name:"MuiPickersCalendarHeader",slot:"Label"})({marginRight:6}),Gm=Je(_n,{name:"MuiPickersCalendarHeader",slot:"SwitchViewButton"})({marginRight:"auto",variants:[{props:{view:"year"},style:{[`.${Tm.switchViewIcon}`]:{transform:"rotate(180deg)"}}}]}),Qm=Je(Am,{name:"MuiPickersCalendarHeader",slot:"SwitchViewIcon"})(({theme:e})=>({willChange:"transform",transition:e.transitions.create("transform"),transform:"rotate(0deg)"})),Xm=f.forwardRef(function(n,s){const o=Dl(),l=jt(),u=Kt({props:n,name:"MuiPickersCalendarHeader"}),{slots:d,slotProps:m,currentMonth:y,disabled:g,disableFuture:w,disablePast:b,maxDate:C,minDate:x,onMonthChange:j,onViewChange:I,view:k,reduceAnimations:M,views:D,labelId:q,className:O,classes:Q,timezone:T,format:P=`${l.formats.month} ${l.formats.year}`}=u,U=mt(u,Ym),{ownerState:Y}=Zt(),J=Wm(Q),ne=(d==null?void 0:d.switchViewButton)??Gm,G=Vt({elementType:ne,externalSlotProps:m==null?void 0:m.switchViewButton,additionalProps:{size:"small","aria-label":o.calendarViewSwitchingButtonAriaLabel(k)},ownerState:_e({},Y,{view:k}),className:J.switchViewButton}),oe=(d==null?void 0:d.switchViewIcon)??Qm,te=Vt({elementType:oe,externalSlotProps:m==null?void 0:m.switchViewIcon,ownerState:Y,className:J.switchViewIcon}),z=mt(te,Km),K=()=>j(l.addMonths(y,1)),W=()=>j(l.addMonths(y,-1)),ee=zm(y,{disableFuture:w,maxDate:C,timezone:T}),ie=Vm(y,{disablePast:b,minDate:x,timezone:T}),me=()=>{if(!(D.length===1||!I||g))if(D.length===2)I(D.find(Te=>Te!==k)||D[0]);else{const Te=D.indexOf(k)!==0?0:1;I(D[Te])}};if(D.length===1&&D[0]==="year")return null;const ke=l.formatByString(y,P);return t.jsxs(Hm,_e({},U,{ownerState:Y,className:Mt(J.root,O),ref:s,children:[t.jsxs(Um,{role:"presentation",onClick:me,ownerState:Y,"aria-live":"polite",className:J.labelContainer,children:[t.jsx(Ml,{reduceAnimations:M,transKey:ke,children:t.jsx(qm,{id:q,ownerState:Y,className:J.label,children:ke})}),D.length>1&&!g&&t.jsx(ne,_e({},G,{children:t.jsx(oe,_e({},z))}))]}),t.jsx(mi,{in:k==="day",appear:!M,enter:!M,children:t.jsx(Bm,{slots:d,slotProps:m,onGoToPrevious:W,isPreviousDisabled:ie,previousLabel:o.previousMonth,onGoToNext:K,isNextDisabled:ee,nextLabel:o.nextMonth})})]}))}),Jm=Je("div",{slot:"internal",shouldForwardProp:void 0})({overflow:"hidden",width:Ja,maxHeight:Tl,display:"flex",flexDirection:"column",margin:"0 auto"}),Zm="@media (prefers-reduced-motion: reduce)",tr=typeof navigator<"u"&&navigator.userAgent.match(/android\s(\d+)|OS\s(\d+)/i),ni=tr&&tr[1]?parseInt(tr[1],10):null,ri=tr&&tr[2]?parseInt(tr[2],10):null,ep=ni&&ni<10||ri&&ri<13||!1;function tp(e){const n=xi(Zm,{defaultMatches:!1});return e??(n||ep)}const np=e=>Xt("MuiDateCalendar",e);Jt("MuiDateCalendar",["root","viewTransitionContainer"]);const rp=["autoFocus","onViewChange","value","defaultValue","referenceDate","disableFuture","disablePast","onChange","onYearChange","onMonthChange","reduceAnimations","shouldDisableDate","shouldDisableMonth","shouldDisableYear","view","views","openTo","className","classes","disabled","readOnly","minDate","maxDate","disableHighlightToday","focusedView","onFocusedViewChange","showDaysOutsideCurrentMonth","fixedWeekNumber","dayOfWeekFormatter","slots","slotProps","loading","renderLoading","displayWeekNumber","yearsOrder","yearsPerRow","monthsPerRow","timezone"],sp=e=>It({root:["root"],viewTransitionContainer:["viewTransitionContainer"]},np,e);function ap(e,n){const s=Kt({props:e,name:n}),o=tp(s.reduceAnimations),l=eo(s);return _e({},s,l,{loading:s.loading??!1,openTo:s.openTo??"day",views:s.views??["year","day"],reduceAnimations:o,renderLoading:s.renderLoading??(()=>t.jsx("span",{children:"..."}))})}const op=Je(Jm,{name:"MuiDateCalendar",slot:"Root"})({display:"flex",flexDirection:"column",height:Tl}),ip=Je(Ml,{name:"MuiDateCalendar",slot:"ViewTransitionContainer"})({}),lp=f.forwardRef(function(n,s){const o=jt(),{ownerState:l}=Zt(),u=wc(),d=ap(n,"MuiDateCalendar"),{autoFocus:m,onViewChange:y,value:g,defaultValue:w,referenceDate:b,disableFuture:C,disablePast:x,onChange:j,onMonthChange:I,reduceAnimations:k,shouldDisableDate:M,shouldDisableMonth:D,shouldDisableYear:q,view:O,views:Q,openTo:T,className:P,classes:U,disabled:Y,readOnly:J,minDate:ne,maxDate:G,disableHighlightToday:oe,focusedView:te,onFocusedViewChange:z,showDaysOutsideCurrentMonth:K,fixedWeekNumber:W,dayOfWeekFormatter:ee,slots:ie,slotProps:me,loading:ke,renderLoading:Te,displayWeekNumber:Ae,yearsOrder:Be,yearsPerRow:de,monthsPerRow:Le,timezone:Ve}=d,tt=mt(d,rp),{value:ce,handleValueChange:Ie,timezone:X}=Za({name:"DateCalendar",timezone:Ve,value:g,defaultValue:w,referenceDate:b,onChange:j,valueManager:Bn}),{view:se,setView:Ce,focusedView:we,setFocusedView:re,goToNextView:Pe,setValueAndGoToNextView:qe}=Sm({view:O,views:Q,openTo:T,onChange:Ie,onViewChange:y,autoFocus:m,focusedView:te,onFocusedViewChange:z}),{referenceDate:Ze,calendarState:st,setVisibleDate:Ee,isDateDisabled:Re,onMonthSwitchingAnimationEnd:kt}=Sf({value:ce,referenceDate:b,reduceAnimations:k,onMonthChange:I,minDate:ne,maxDate:G,shouldDisableDate:M,disablePast:x,disableFuture:C,timezone:X,getCurrentMonthFromVisibleDate:(We,ct)=>o.isSameMonth(We,ct)?ct:o.startOfMonth(We)}),pt=Y&&ce||ne,Wt=Y&&ce||G,Ct=`${u}-grid-label`,fe=we!==null,Se=(ie==null?void 0:ie.calendarHeader)??Xm,Ge=Vt({elementType:Se,externalSlotProps:me==null?void 0:me.calendarHeader,additionalProps:{views:Q,view:se,currentMonth:st.currentMonth,onViewChange:Ce,onMonthChange:We=>Ee({target:We,reason:"header-navigation"}),minDate:pt,maxDate:Wt,disabled:Y,disablePast:x,disableFuture:C,reduceAnimations:k,timezone:X,labelId:Ct},ownerState:l}),bt=rt(We=>{const ct=o.startOfMonth(We),Lt=o.endOfMonth(We),ge=Re(We)?Tr({adapter:o,date:We,minDate:o.isBefore(ne,ct)?ct:ne,maxDate:o.isAfter(G,Lt)?Lt:G,disablePast:x,disableFuture:C,isDateDisabled:Re,timezone:X}):We;ge?(qe(ge,"finish"),Ee({target:ge,reason:"cell-interaction"})):(Pe(),Ee({target:ct,reason:"cell-interaction"}))}),ir=rt(We=>{const ct=o.startOfYear(We),Lt=o.endOfYear(We),ge=Re(We)?Tr({adapter:o,date:We,minDate:o.isBefore(ne,ct)?ct:ne,maxDate:o.isAfter(G,Lt)?Lt:G,disablePast:x,disableFuture:C,isDateDisabled:Re,timezone:X}):We;ge?(qe(ge,"finish"),Ee({target:ge,reason:"cell-interaction"})):(Pe(),Ee({target:ct,reason:"cell-interaction"}))}),Vn=rt(We=>Ie(We&&vs(o,We,ce??Ze),"finish",se));f.useEffect(()=>{o.isValid(ce)&&Ee({target:ce,reason:"controlled-value-change"})},[ce]);const Ft=sp(U),en={disablePast:x,disableFuture:C,maxDate:G,minDate:ne},Nn={disableHighlightToday:oe,readOnly:J,disabled:Y,timezone:X,gridLabelId:Ct,slots:ie,slotProps:me},At=f.useRef(se);f.useEffect(()=>{At.current!==se&&(we===At.current&&re(se,!0),At.current=se)},[we,re,se]);const Me=f.useMemo(()=>[ce],[ce]);return t.jsxs(op,_e({ref:s,className:Mt(Ft.root,P),ownerState:l},tt,{children:[t.jsx(Se,_e({},Ge,{slots:ie,slotProps:me})),t.jsx(ip,{reduceAnimations:k,className:Ft.viewTransitionContainer,transKey:se,ownerState:l,children:t.jsxs("div",{children:[se==="year"&&t.jsx(Nm,_e({},en,Nn,{value:ce,onChange:ir,shouldDisableYear:q,hasFocus:fe,onFocusedViewChange:We=>re("year",We),yearsOrder:Be,yearsPerRow:de,referenceDate:Ze})),se==="month"&&t.jsx(pm,_e({},en,Nn,{currentMonth:st.currentMonth,hasFocus:fe,className:P,value:ce,onChange:bt,shouldDisableMonth:D,onFocusedViewChange:We=>re("month",We),monthsPerRow:Le,referenceDate:Ze})),se==="day"&&t.jsx(om,_e({},st,en,Nn,{onMonthSwitchingAnimationEnd:kt,hasFocus:fe,onFocusedDayChange:We=>Ee({target:We,reason:"cell-interaction"}),reduceAnimations:k,selectedDays:Me,onSelectedDaysChange:Vn,shouldDisableDate:M,shouldDisableMonth:D,shouldDisableYear:q,onFocusedViewChange:We=>re("day",We),showDaysOutsideCurrentMonth:K,fixedWeekNumber:W,dayOfWeekFormatter:ee,displayWeekNumber:Ae,loading:ke,renderLoading:Te}))]})})]}))});function za({className:e,selected:n,onSelect:s,disabled:o,mode:l="single",showOutsideDays:u=!0,month:d,onMonthChange:m,fromDate:y,toDate:g,...w}){const b=n?ot(n):null,C=d?ot(d):void 0,x=y?ot(y):void 0,j=g?ot(g):void 0,I=M=>{s&&s(M?M.toDate():void 0)},k=M=>{m&&m(M.toDate())};return t.jsx(ef,{dateAdapter:pf,children:t.jsx(Qe,{className:Oe("p-3",e),children:t.jsx(lp,{value:b,onChange:I,disabled:o,showDaysOutsideCurrentMonth:u,referenceDate:C,onMonthChange:k,minDate:x,maxDate:j,sx:{width:"100%",maxWidth:"320px","& .MuiPickersCalendarHeader-root":{paddingLeft:"8px",paddingRight:"8px",marginTop:0},"& .MuiPickersCalendarHeader-label":{fontSize:"0.875rem",fontWeight:500},"& .MuiPickersArrowSwitcher-button":{opacity:.5,"&:hover":{opacity:1}},"& .MuiDayCalendar-weekDayLabel":{width:36,height:36,fontSize:"0.8rem",color:"text.secondary"},"& .MuiPickersDay-root":{width:36,height:36,fontSize:"0.875rem","&:hover":{backgroundColor:"action.hover"},"&.Mui-selected":{backgroundColor:"primary.main",color:"primary.contrastText","&:hover":{backgroundColor:"primary.main"},"&:focus":{backgroundColor:"primary.main"}},"&.MuiPickersDay-today":{backgroundColor:"action.selected",borderColor:"transparent"},"&.MuiPickersDay-dayOutsideMonth":{color:"text.disabled",opacity:.5}},"& .MuiPickersDay-dayDisabled":{color:"text.disabled",opacity:.5}},...w})})})}za.displayName="Calendar";const ka="vibenotes-saved-searches",si={query:"",tags:[],colorLabelIds:[],dateFrom:null,dateTo:null,sortBy:"updated",sortOrder:"desc"};function cp({allTags:e,onFiltersChange:n,onClose:s}){const{labels:o}=Ha(),[l,u]=f.useState(si),[d,m]=f.useState([]),[y,g]=f.useState(!1),[w,b]=f.useState("");f.useEffect(()=>{const O=localStorage.getItem(ka);if(O)try{const T=JSON.parse(O).map(P=>({...P,filters:{...P.filters,dateFrom:P.filters.dateFrom?new Date(P.filters.dateFrom):null,dateTo:P.filters.dateTo?new Date(P.filters.dateTo):null}}));m(T)}catch{m([])}},[]),f.useEffect(()=>{n(l)},[l,n]);const C=f.useCallback(O=>{u(Q=>({...Q,...O}))},[]),x=f.useCallback(O=>{u(Q=>({...Q,tags:Q.tags.includes(O)?Q.tags.filter(T=>T!==O):[...Q.tags,O]}))},[]),j=f.useCallback(O=>{u(Q=>({...Q,colorLabelIds:Q.colorLabelIds.includes(O)?Q.colorLabelIds.filter(T=>T!==O):[...Q.colorLabelIds,O]}))},[]),I=f.useCallback(()=>{u(si)},[]),k=l.query||l.tags.length>0||l.colorLabelIds.length>0||l.dateFrom||l.dateTo,M=f.useCallback(()=>{if(!w.trim())return;const O={id:crypto.randomUUID(),name:w.trim(),filters:{...l}},Q=[...d,O];m(Q),localStorage.setItem(ka,JSON.stringify(Q)),b(""),g(!1)},[w,l,d]),D=f.useCallback(O=>{u(O.filters)},[]),q=f.useCallback(O=>{const Q=d.filter(T=>T.id!==O);m(Q),localStorage.setItem(ka,JSON.stringify(Q))},[d]);return t.jsxs("div",{className:"space-y-4 p-4 border rounded-lg bg-card",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(du,{className:"h-4 w-4"}),t.jsx("span",{className:"font-medium",children:"Advanced Search"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[k&&t.jsx(le,{variant:"ghost",size:"sm",onClick:I,children:"Clear All"}),s&&t.jsx(le,{variant:"ghost",size:"icon",onClick:s,"aria-label":"Close search panel",children:t.jsx(Tt,{className:"h-4 w-4"})})]})]}),t.jsxs("div",{className:"relative",children:[t.jsx(ws,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),t.jsx(vt,{placeholder:"Search in titles and content...",value:l.query,onChange:O=>C({query:O.target.value}),className:"pl-10"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx("span",{className:"text-sm text-muted-foreground",children:"Date Range"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs(Ia,{children:[t.jsx(fs,{asChild:!0,children:t.jsxs(le,{variant:"outline",className:Oe("flex-1 justify-start text-left font-normal",!l.dateFrom&&"text-muted-foreground"),children:[t.jsx(Oa,{className:"mr-2 h-4 w-4"}),l.dateFrom?Qo(l.dateFrom,"PP"):"From"]})}),t.jsx(ms,{className:"w-auto p-0",align:"start",children:t.jsx(za,{mode:"single",selected:l.dateFrom||void 0,onSelect:O=>C({dateFrom:O||null})})})]}),t.jsxs(Ia,{children:[t.jsx(fs,{asChild:!0,children:t.jsxs(le,{variant:"outline",className:Oe("flex-1 justify-start text-left font-normal",!l.dateTo&&"text-muted-foreground"),children:[t.jsx(Oa,{className:"mr-2 h-4 w-4"}),l.dateTo?Qo(l.dateTo,"PP"):"To"]})}),t.jsx(ms,{className:"w-auto p-0",align:"start",children:t.jsx(za,{mode:"single",selected:l.dateTo||void 0,onSelect:O=>C({dateTo:O||null})})})]})]})]}),e.length>0&&t.jsxs("div",{className:"space-y-2",children:[t.jsx("span",{className:"text-sm text-muted-foreground",children:"Tags"}),t.jsx("div",{className:"flex flex-wrap gap-1.5",children:e.map(O=>t.jsx(Ds,{variant:l.tags.includes(O)?"default":"outline",className:"cursor-pointer",onClick:()=>x(O),children:O},O))})]}),o.length>0&&t.jsxs("div",{className:"space-y-2",children:[t.jsx("span",{className:"text-sm text-muted-foreground",children:"Color Labels"}),t.jsx("div",{className:"flex flex-wrap gap-1.5",children:o.map(O=>t.jsxs("button",{onClick:()=>j(O.id),className:Oe("inline-flex items-center gap-1 rounded-full px-2.5 py-0.5 text-xs transition-all",l.colorLabelIds.includes(O.id)?"ring-2 ring-offset-2 ring-offset-background":"opacity-60 hover:opacity-100"),style:{backgroundColor:`${O.color}20`,color:O.color,borderColor:O.color,...l.colorLabelIds.includes(O.id)&&{ringColor:O.color}},children:[t.jsx("span",{className:"h-2 w-2 rounded-full",style:{backgroundColor:O.color}}),O.name]},O.id))})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx("span",{className:"text-sm text-muted-foreground",children:"Sort By"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs("select",{value:l.sortBy,onChange:O=>C({sortBy:O.target.value}),className:"flex-1 h-9 rounded-md border border-input bg-background px-3 text-sm",children:[t.jsx("option",{value:"updated",children:"Last Updated"}),t.jsx("option",{value:"created",children:"Created"}),t.jsx("option",{value:"title",children:"Title"})]}),t.jsxs("select",{value:l.sortOrder,onChange:O=>C({sortOrder:O.target.value}),className:"w-28 h-9 rounded-md border border-input bg-background px-3 text-sm",children:[t.jsx("option",{value:"desc",children:"Newest"}),t.jsx("option",{value:"asc",children:"Oldest"})]})]})]}),k&&t.jsxs(le,{variant:"outline",size:"sm",className:"w-full gap-2",onClick:()=>g(!0),children:[t.jsx(Li,{className:"h-4 w-4"}),"Save This Search"]}),d.length>0&&t.jsxs("div",{className:"space-y-2 border-t pt-4",children:[t.jsx("span",{className:"text-sm text-muted-foreground",children:"Saved Searches"}),t.jsx("div",{className:"space-y-1",children:d.map(O=>t.jsxs("div",{className:"flex items-center justify-between p-2 rounded-md hover:bg-accent",children:[t.jsx("button",{onClick:()=>D(O),className:"flex-1 text-left text-sm",children:O.name}),t.jsx(le,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:()=>q(O.id),"aria-label":`Delete saved search: ${O.name}`,children:t.jsx(Yt,{className:"h-3 w-3"})})]},O.id))})]}),t.jsx(Fn,{open:y,onOpenChange:g,children:t.jsxs(dn,{children:[t.jsxs(Gt,{children:[t.jsx(Qt,{children:"Save Search"}),t.jsx(mn,{children:"Give your search a name to easily find it later."})]}),t.jsx(vt,{placeholder:"Search name...",value:w,onChange:O=>b(O.target.value),onKeyDown:O=>O.key==="Enter"&&M()}),t.jsxs(Ln,{children:[t.jsx(le,{variant:"outline",onClick:()=>g(!1),children:"Cancel"}),t.jsx(le,{onClick:M,disabled:!w.trim(),children:"Save"})]})]})})]})}function up(){const[e,n]=f.useState([]),[s,o]=f.useState(null),[l,u]=f.useState(!0),[d,m]=f.useState(null),y=f.useCallback(async x=>{try{u(!0);const j=new URLSearchParams;x!=null&&x.limit&&j.set("limit",x.limit.toString()),x!=null&&x.offset&&j.set("offset",x.offset.toString()),x!=null&&x.type&&j.set("type",x.type);const I=await He.get(`/api/activities?${j.toString()}`);n(I.data),m(null)}catch(j){m(j instanceof Error?j.message:"Failed to load activities")}finally{u(!1)}},[]),g=f.useCallback(async(x=7)=>{try{u(!0);const j=await He.get(`/api/activities/recent?days=${x}`);n(j.data),m(null)}catch(j){m(j instanceof Error?j.message:"Failed to load recent activities")}finally{u(!1)}},[]),w=f.useCallback(async(x,j)=>{try{const I=j?`?limit=${j}`:"";return(await He.get(`/api/activities/note/${x}${I}`)).data}catch(I){throw new Error(I instanceof Error?I.message:"Failed to load note activities")}},[]),b=f.useCallback(async()=>{try{const x=await He.get("/api/activities/stats");o(x.data)}catch(x){m(x instanceof Error?x.message:"Failed to load activity stats")}},[]),C=f.useCallback(async(x=90)=>{try{const j=await He.delete(`/api/activities/cleanup?days=${x}`);return await y(),j.data.deleted}catch(j){throw new Error(j instanceof Error?j.message:"Failed to cleanup activities")}},[y]);return f.useEffect(()=>{y()},[y]),{activities:e,stats:s,isLoading:l,error:d,fetchActivities:y,fetchRecentActivities:g,fetchNoteActivities:w,fetchStats:b,cleanupActivities:C}}function dp(e){var o;const n=e.metadata,s=(n==null?void 0:n.title)||((o=e.note)==null?void 0:o.title)||"a note";switch(e.type){case"note_created":return`Created "${s}"`;case"note_updated":return`Updated "${s}"`;case"note_deleted":return`Deleted "${s}"`;case"note_restored":return`Restored "${s}"`;case"note_archived":return`Archived "${s}"`;case"note_unarchived":return`Unarchived "${s}"`;case"note_pinned":return`Pinned "${s}"`;case"note_unpinned":return`Unpinned "${s}"`;case"note_moved":const l=(n==null?void 0:n.folder)||"All Notes";return`Moved "${s}" to ${l}`;case"folder_created":return`Created folder "${n==null?void 0:n.folderName}"`;case"folder_updated":return`Updated folder "${n==null?void 0:n.folderName}"`;case"folder_deleted":return`Deleted folder "${n==null?void 0:n.folderName}"`;case"label_created":return`Created label "${n==null?void 0:n.labelName}"`;case"label_assigned":return`Added label "${n==null?void 0:n.labelName}" to "${n==null?void 0:n.noteTitle}"`;case"label_removed":return`Removed label "${n==null?void 0:n.labelName}" from "${n==null?void 0:n.noteTitle}"`;default:return`Activity: ${e.type}`}}function hp(e){switch(e){case"note_created":return Cn;case"note_updated":return Pr;case"note_deleted":return Yt;case"note_restored":return Eu;case"note_archived":return ks;case"note_unarchived":return Pi;case"note_pinned":return Ii;case"note_unpinned":return Cu;case"note_moved":case"folder_created":case"folder_updated":case"folder_deleted":return Ai;case"label_created":case"label_assigned":case"label_removed":return rr;default:return hs}}function fp(e){switch(e){case"note_created":return"text-emerald-600 dark:text-emerald-400";case"note_deleted":return"text-destructive";case"note_archived":return"text-amber-600 dark:text-amber-400";case"note_pinned":return"text-primary";default:return"text-muted-foreground"}}function mp(e){const n=new Date(e),o=new Date().getTime()-n.getTime(),l=Math.floor(o/6e4),u=Math.floor(o/36e5),d=Math.floor(o/864e5);return l<1?"Just now":l<60?`${l}m ago`:u<24?`${u}h ago`:d<7?`${d}d ago`:n.toLocaleDateString()}function pp(e){const n=new Map,s=new Date().toDateString(),o=new Date(Date.now()-864e5).toDateString();return e.forEach(l=>{const u=new Date(l.createdAt).toDateString();let d;u===s?d="Today":u===o?d="Yesterday":d=new Date(l.createdAt).toLocaleDateString(void 0,{weekday:"long",month:"short",day:"numeric"}),n.has(d)||n.set(d,[]),n.get(d).push(l)}),n}function gp({onClose:e,onSelectNote:n}){const{activities:s,isLoading:o,error:l,fetchActivities:u,fetchRecentActivities:d,fetchStats:m,stats:y}=up(),[g,w]=f.useState("recent");f.useEffect(()=>{g==="recent"?d(7):u({limit:100}),m()},[g,u,d,m]);const b=pp(s),C=x=>{x.noteId&&n&&(n(x.noteId),e())};return t.jsxs("div",{className:"fixed inset-0 z-50 bg-background/95 flex flex-col",children:[t.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(hs,{className:"h-5 w-5"}),t.jsx("h2",{className:"text-lg font-semibold",children:"Activity Feed"})]}),t.jsx(le,{variant:"ghost",size:"icon",onClick:e,"aria-label":"Close activity feed",children:t.jsx(Tt,{className:"h-4 w-4"})})]}),y&&t.jsxs("div",{className:"grid grid-cols-4 gap-4 p-4 border-b bg-muted/30",children:[t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-2xl font-bold",children:y.totalActivities}),t.jsx("div",{className:"text-xs text-muted-foreground",children:"Total"})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-2xl font-bold text-emerald-600 dark:text-emerald-400",children:y.notesCreated}),t.jsx("div",{className:"text-xs text-muted-foreground",children:"Created"})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-2xl font-bold text-primary",children:y.notesUpdated}),t.jsx("div",{className:"text-xs text-muted-foreground",children:"Updated"})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-2xl font-bold text-destructive",children:y.notesDeleted}),t.jsx("div",{className:"text-xs text-muted-foreground",children:"Deleted"})]})]}),t.jsxs("div",{className:"flex gap-2 p-4 border-b",children:[t.jsxs(le,{variant:g==="recent"?"default":"outline",size:"sm",onClick:()=>w("recent"),children:[t.jsx(Wa,{className:"h-4 w-4 mr-2"}),"Last 7 Days"]}),t.jsx(le,{variant:g==="all"?"default":"outline",size:"sm",onClick:()=>w("all"),children:"All Activity"})]}),t.jsx($n,{className:"flex-1",children:o?t.jsx("div",{className:"flex items-center justify-center h-32 text-muted-foreground",children:"Loading activities..."}):l?t.jsx("div",{className:"flex items-center justify-center h-32 text-destructive",children:l}):s.length===0?t.jsxs("div",{className:"flex flex-col items-center justify-center h-32 text-muted-foreground",children:[t.jsx(hs,{className:"h-8 w-8 mb-2"}),t.jsx("p",{children:"No activities yet"}),t.jsx("p",{className:"text-sm",children:"Start creating and editing notes to see your activity here"})]}):t.jsx("div",{className:"p-4 space-y-6",children:Array.from(b.entries()).map(([x,j])=>t.jsxs("div",{children:[t.jsx("h3",{className:"text-sm font-medium text-muted-foreground mb-3",children:x}),t.jsx("div",{className:"space-y-2",children:j.map(I=>{const k=hp(I.type),M=fp(I.type),D=dp(I);return t.jsxs("button",{onClick:()=>C(I),className:Oe("w-full flex items-start gap-3 p-3 rounded-lg text-left transition-colors",I.noteId?"hover:bg-accent cursor-pointer":"cursor-default"),disabled:!I.noteId,children:[t.jsx("div",{className:Oe("mt-0.5",M),children:t.jsx(k,{className:"h-4 w-4"})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("p",{className:"text-sm",children:D}),t.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:mp(I.createdAt)})]})]},I.id)})})]},x))})}),t.jsx("div",{className:"p-4 border-t text-sm text-muted-foreground",children:t.jsx("p",{children:"Click on an activity to open the related note"})})]})}function yp(e){const[n,s]=f.useState([]),[o,l]=f.useState(!1),[u,d]=f.useState(null),m=f.useCallback(async()=>{try{l(!0),d(null);const C=await He.get(`/api/comments/note/${e}`);s(C.data)}catch(C){d(C instanceof Error?C.message:"Failed to load comments")}finally{l(!1)}},[e]),y=f.useCallback(async(C,x)=>{try{d(null);const j=await He.post("/api/comments",{content:C,noteId:e,parentId:x});return await m(),j.data}catch(j){return d(j instanceof Error?j.message:"Failed to create comment"),null}},[e,m]),g=f.useCallback(async(C,x)=>{try{d(null);const j=await He.put(`/api/comments/${C}`,{content:x});return await m(),j.data}catch(j){return d(j instanceof Error?j.message:"Failed to update comment"),null}},[m]),w=f.useCallback(async C=>{try{return d(null),await He.delete(`/api/comments/${C}`),await m(),!0}catch(x){return d(x instanceof Error?x.message:"Failed to delete comment"),!1}},[m]),b=f.useCallback(async()=>{try{return(await He.get(`/api/comments/note/${e}/count`)).data.count}catch{return 0}},[e]);return{comments:n,isLoading:o,error:u,fetchComments:m,createComment:y,updateComment:g,deleteComment:w,getCommentCount:b}}function xp(e){const n=new Date(e),o=new Date().getTime()-n.getTime(),l=Math.floor(o/6e4),u=Math.floor(o/36e5),d=Math.floor(o/864e5);return l<1?"Just now":l<60?`${l}m ago`:u<24?`${u}h ago`:d<7?`${d}d ago`:n.toLocaleDateString()}function Fl({comment:e,replies:n=[],onReply:s,onEdit:o,onDelete:l,currentUserId:u,level:d=0}){const m=e.userId===u,y=e.user.displayName||e.user.email.split("@")[0];return t.jsxs("div",{className:Oe("space-y-2",d>0&&"ml-6 border-l-2 border-muted pl-4"),children:[t.jsx("div",{className:"group",children:t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx("div",{className:"w-8 h-8 rounded-full bg-primary/10 flex items-center justify-center text-sm font-medium",children:y.charAt(0).toUpperCase()}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"font-medium text-sm",children:y}),t.jsx("span",{className:"text-xs text-muted-foreground",children:xp(e.createdAt)}),e.updatedAt!==e.createdAt&&t.jsx("span",{className:"text-xs text-muted-foreground",children:"(edited)"})]}),t.jsx("p",{className:"text-sm mt-1 whitespace-pre-wrap",children:e.content}),t.jsxs("div",{className:"flex items-center gap-2 mt-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[t.jsxs(le,{variant:"ghost",size:"sm",className:"h-7 text-xs",onClick:()=>s(e.id),children:[t.jsx(Fi,{className:"h-3 w-3 mr-1"}),"Reply"]}),m&&t.jsxs(t.Fragment,{children:[t.jsxs(le,{variant:"ghost",size:"sm",className:"h-7 text-xs",onClick:()=>o(e),children:[t.jsx(Pr,{className:"h-3 w-3 mr-1"}),"Edit"]}),t.jsxs(le,{variant:"ghost",size:"sm",className:"h-7 text-xs text-destructive hover:text-destructive",onClick:()=>l(e.id),children:[t.jsx(Yt,{className:"h-3 w-3 mr-1"}),"Delete"]})]})]})]})]})}),n.length>0&&t.jsx("div",{className:"space-y-2 mt-2",children:n.map(g=>t.jsx(Fl,{comment:g,onReply:s,onEdit:o,onDelete:l,currentUserId:u,level:d+1},g.id))})]})}function vp({noteId:e,onClose:n}){var oe,te;const{comments:s,isLoading:o,error:l,fetchComments:u,createComment:d,updateComment:m,deleteComment:y}=yp(e),[g,w]=f.useState(""),[b,C]=f.useState(null),[x,j]=f.useState(null),[I,k]=f.useState(""),[M,D]=f.useState(null),[q,O]=f.useState(!1),Q=or.getUser(),T=(Q==null?void 0:Q.id)||"";f.useEffect(()=>{u()},[u]);const P=async()=>{g.trim()&&(O(!0),await d(g.trim(),b),w(""),C(null),O(!1))},U=async()=>{!x||!I.trim()||(O(!0),await m(x.id,I.trim()),j(null),k(""),O(!1))},Y=async()=>{M&&(await y(M),D(null))},J=z=>{j(z),k(z.content)},ne=z=>{C(z),j(null)},G=()=>{C(null),j(null),k("")};return t.jsxs("div",{className:"flex flex-col h-full border-l bg-background",children:[t.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(_a,{className:"h-5 w-5"}),t.jsx("h3",{className:"font-semibold",children:"Comments"}),t.jsxs("span",{className:"text-sm text-muted-foreground",children:["(",s.reduce((z,K)=>{var W;return z+1+(((W=K.replies)==null?void 0:W.length)||0)},0),")"]})]}),t.jsx(le,{variant:"ghost",size:"icon",onClick:n,"aria-label":"Close comments panel",children:t.jsx(Tt,{className:"h-4 w-4"})})]}),t.jsx($n,{className:"flex-1 p-4",children:o?t.jsx("div",{className:"text-center text-muted-foreground py-8",children:"Loading comments..."}):l?t.jsx("div",{className:"text-center text-destructive py-8",children:l}):s.length===0?t.jsxs("div",{className:"text-center text-muted-foreground py-8",children:[t.jsx(_a,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),t.jsx("p",{children:"No comments yet"}),t.jsx("p",{className:"text-sm",children:"Be the first to add a comment"})]}):t.jsx("div",{className:"space-y-4",children:s.map(z=>t.jsx(Fl,{comment:z,replies:z.replies,onReply:ne,onEdit:J,onDelete:D,currentUserId:T},z.id))})}),x&&t.jsxs("div",{className:"p-4 border-t bg-muted/30",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2 text-sm text-muted-foreground",children:[t.jsx(Pr,{className:"h-3 w-3"}),"Editing comment",t.jsx(le,{variant:"ghost",size:"sm",onClick:G,children:"Cancel"})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(sr,{value:I,onChange:z=>k(z.target.value),placeholder:"Edit your comment...",className:"flex-1 min-h-[60px] resize-none",autoFocus:!0}),t.jsx(le,{onClick:U,disabled:!I.trim()||q,size:"icon","aria-label":"Save comment edit",children:t.jsx(fn,{className:"h-4 w-4"})})]})]}),b&&!x&&t.jsxs("div",{className:"px-4 py-2 border-t bg-muted/30 flex items-center gap-2 text-sm text-muted-foreground",children:[t.jsx(Fi,{className:"h-3 w-3"}),"Replying to comment",t.jsx(le,{variant:"ghost",size:"sm",onClick:G,children:"Cancel"})]}),!x&&t.jsxs("div",{className:"p-4 border-t",children:[t.jsxs("div",{className:"flex gap-2",children:[t.jsx(sr,{value:g,onChange:z=>w(z.target.value),placeholder:b?"Write a reply...":"Add a comment...",className:"flex-1 min-h-[60px] resize-none",onKeyDown:z=>{z.key==="Enter"&&(z.ctrlKey||z.metaKey)&&P()}}),t.jsx(le,{onClick:P,disabled:!g.trim()||q,size:"icon","aria-label":b?"Send reply":"Send comment",children:t.jsx(Mu,{className:"h-4 w-4"})})]}),t.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Press Ctrl+Enter to submit"})]}),t.jsx(Rn,{open:!!M,onOpenChange:z=>!z&&D(null),children:t.jsxs(pn,{children:[t.jsxs(gn,{children:[t.jsx(xn,{children:"Delete Comment"}),t.jsxs(vn,{children:["Are you sure you want to delete this comment? This action cannot be undone.",(te=(oe=s.find(z=>z.id===M))==null?void 0:oe.replies)!=null&&te.length?t.jsx("span",{className:"block mt-2 font-medium",children:"All replies to this comment will also be deleted."}):null]})]}),t.jsxs(yn,{children:[t.jsx(wn,{children:"Cancel"}),t.jsx(bn,{onClick:Y,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Delete"})]})]})})]})}const Ll=f.createContext(null);function to(){const e=f.useContext(Ll);if(!e)throw new Error("Select components must be used within a Select");return e}const bp=({children:e,value:n,onValueChange:s,defaultValue:o="",open:l,onOpenChange:u})=>{const[d,m]=f.useState(o),[y,g]=f.useState(!1),w=n!==void 0,b=w?n:d,C=l!==void 0,x=C?l:y,j=f.useCallback(k=>{w||m(k),s==null||s(k)},[w,s]),I=f.useCallback(k=>{C||g(k),u==null||u(k)},[C,u]);return t.jsx(Ll.Provider,{value:{value:b,onValueChange:j,open:x,setOpen:I},children:e})},no=({placeholder:e})=>{const{value:n}=to();return t.jsx(t.Fragment,{children:n||e})};no.displayName="SelectValue";const Rl=f.forwardRef(({className:e,children:n},s)=>{const{value:o,onValueChange:l,open:u,setOpen:d}=to(),m=y=>{l(y.target.value)};return t.jsx(jc,{ref:s,className:Oe("w-full",e),size:"small",children:t.jsx(kc,{value:o,onChange:m,open:u,onOpen:()=>d(!0),onClose:()=>d(!1),displayEmpty:!0,renderValue:y=>{if(!y){let g="";return f.Children.forEach(n,w=>{f.isValidElement(w)&&w.type===no&&(g=w.props.placeholder||"")}),t.jsx("span",{className:"text-muted-foreground",children:g})}return y},IconComponent:y=>t.jsx(Ka,{className:"h-4 w-4 opacity-50 mr-2",...y}),sx:{height:"40px","& .MuiOutlinedInput-notchedOutline":{borderColor:"divider"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"divider"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"primary.main",borderWidth:"2px"},"& .MuiSelect-select":{display:"flex",alignItems:"center"}},MenuProps:{PaperProps:{sx:{backgroundImage:"none",maxHeight:"384px"}}},children:t.jsx(ar,{value:"",sx:{display:"none"}})})})});Rl.displayName="SelectTrigger";const wp=f.forwardRef(({className:e,...n},s)=>t.jsx("div",{ref:s,className:Oe("hidden",e),...n}));wp.displayName="SelectScrollUpButton";const jp=f.forwardRef(({className:e,...n},s)=>t.jsx("div",{ref:s,className:Oe("hidden",e),...n}));jp.displayName="SelectScrollDownButton";const $l=f.forwardRef(({className:e,children:n},s)=>t.jsx(Qe,{ref:s,className:Oe("hidden",e),children:n}));$l.displayName="SelectContent";const kp=f.forwardRef(({className:e,children:n,...s},o)=>t.jsx(Cc,{ref:o,className:Oe("py-1.5 pl-8 pr-2 text-sm font-semibold",e),sx:{lineHeight:"inherit",backgroundColor:"transparent"},...s,children:n}));kp.displayName="SelectLabel";const cs=f.forwardRef(({className:e,children:n,value:s,disabled:o,...l},u)=>{const d=to(),m=d.value===s;return t.jsxs(ar,{ref:u,value:s,disabled:o,onClick:()=>{d.onValueChange(s),d.setOpen(!1)},className:Oe("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none",e),sx:{minHeight:"auto",py:.75,pl:4,pr:1,"&:hover":{backgroundColor:"action.hover"},"&.Mui-selected":{backgroundColor:"action.selected"},"&.Mui-selected:hover":{backgroundColor:"action.selected"}},...l,children:[t.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:m&&t.jsx(fn,{className:"h-4 w-4"})}),n]})});cs.displayName="SelectItem";const Cp=f.forwardRef(({className:e,...n},s)=>t.jsx(us,{ref:s,className:Oe("-mx-1 my-1",e),...n}));Cp.displayName="SelectSeparator";function Np(){const[e,n]=f.useState([]),[s,o]=f.useState(!0),[l,u]=f.useState(null),d=f.useCallback(async()=>{try{o(!0),u(null);const k=await He.get("/api/workspaces");n(k.data)}catch(k){u(k instanceof Error?k.message:"Failed to load workspaces")}finally{o(!1)}},[]),m=f.useCallback(async(k,M)=>{try{u(null);const D=await He.post("/api/workspaces",{name:k,description:M});return await d(),D.data}catch(D){return u(D instanceof Error?D.message:"Failed to create workspace"),null}},[d]),y=f.useCallback(async k=>{try{return(await He.get(`/api/workspaces/${k}`)).data}catch(M){return u(M instanceof Error?M.message:"Failed to load workspace"),null}},[]),g=f.useCallback(async(k,M)=>{try{u(null);const D=await He.put(`/api/workspaces/${k}`,M);return await d(),D.data}catch(D){return u(D instanceof Error?D.message:"Failed to update workspace"),null}},[d]),w=f.useCallback(async k=>{try{return u(null),await He.delete(`/api/workspaces/${k}`),await d(),!0}catch(M){return u(M instanceof Error?M.message:"Failed to delete workspace"),!1}},[d]),b=f.useCallback(async(k,M,D="editor")=>{try{return u(null),await He.post(`/api/workspaces/${k}/members`,{email:M,role:D}),!0}catch(q){return u(q instanceof Error?q.message:"Failed to invite member"),!1}},[]),C=f.useCallback(async(k,M,D)=>{try{return u(null),await He.put(`/api/workspaces/${k}/members/${M}`,{role:D}),!0}catch(q){return u(q instanceof Error?q.message:"Failed to update member role"),!1}},[]),x=f.useCallback(async(k,M)=>{try{return u(null),await He.delete(`/api/workspaces/${k}/members/${M}`),!0}catch(D){return u(D instanceof Error?D.message:"Failed to remove member"),!1}},[]),j=f.useCallback(async k=>{try{return u(null),await He.post(`/api/workspaces/${k}/leave`),await d(),!0}catch(M){return u(M instanceof Error?M.message:"Failed to leave workspace"),!1}},[d]),I=f.useCallback(async k=>{try{return(await He.get(`/api/workspaces/${k}/role`)).data.role}catch{return null}},[]);return f.useEffect(()=>{d()},[d]),{workspaces:e,isLoading:s,error:l,fetchWorkspaces:d,createWorkspace:m,getWorkspace:y,updateWorkspace:g,deleteWorkspace:w,inviteMember:b,updateMemberRole:C,removeMember:x,leaveWorkspace:j,getUserRole:I}}function Dp(e){switch(e){case"admin":return Ea;case"editor":return Ns;case"viewer":return Cs}}function ai(e){return e.charAt(0).toUpperCase()+e.slice(1)}function Sp({onClose:e,onSelectWorkspace:n}){const{workspaces:s,isLoading:o,error:l,createWorkspace:u,getWorkspace:d,updateWorkspace:m,deleteWorkspace:y,inviteMember:g,updateMemberRole:w,removeMember:b,leaveWorkspace:C}=Np(),[x,j]=f.useState(null),[I,k]=f.useState(!1),[M,D]=f.useState(!1),[q,O]=f.useState(!1),[Q,T]=f.useState(null),[P,U]=f.useState(null),[Y,J]=f.useState(""),[ne,G]=f.useState(""),[oe,te]=f.useState(""),[z,K]=f.useState("editor"),[W,ee]=f.useState(null),[ie,me]=f.useState(!1),ke=or.getUser(),Te=(ke==null?void 0:ke.id)||"",Ae=async re=>{const Pe=await d(re.id);j(Pe)},Be=async()=>{if(!Y.trim()){ee("Workspace name is required");return}me(!0),ee(null);const re=await u(Y.trim(),ne.trim()||void 0);re?(k(!1),J(""),G(""),j(re)):ee(l||"Failed to create workspace"),me(!1)},de=async()=>{if(!x||!Y.trim()){ee("Workspace name is required");return}me(!0),ee(null);const re=await m(x.id,{name:Y.trim(),description:ne.trim()||void 0});re?(j(re),D(!1)):ee(l||"Failed to update workspace"),me(!1)},Le=async()=>{if(!Q)return;await y(Q)&&(T(null),j(null))},Ve=async()=>{if(!P)return;await C(P)&&(U(null),j(null))},tt=async()=>{if(!x||!oe.trim()){ee("Email is required");return}if(me(!0),ee(null),await g(x.id,oe.trim(),z)){O(!1),te(""),K("editor");const Pe=await d(x.id);j(Pe)}else ee(l||"Failed to invite member");me(!1)},ce=async(re,Pe)=>{if(!x)return;if(await w(x.id,re.userId,Pe)){const Ze=await d(x.id);j(Ze)}},Ie=async re=>{if(!x)return;if(await b(x.id,re.userId)){const qe=await d(x.id);j(qe)}},X=()=>{x&&(J(x.name),G(x.description||""),D(!0))},se=(x==null?void 0:x.owner.id)===Te,Ce=x==null?void 0:x.members.find(re=>re.userId===Te),we=(Ce==null?void 0:Ce.role)==="admin"||se;return t.jsxs("div",{className:"fixed inset-0 z-50 bg-background/95 flex flex-col",children:[t.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(er,{className:"h-5 w-5"}),t.jsx("h2",{className:"text-lg font-semibold",children:"Workspaces"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs(le,{onClick:()=>k(!0),children:[t.jsx(Cn,{className:"h-4 w-4 mr-2"}),"New Workspace"]}),t.jsx(le,{variant:"ghost",size:"icon",onClick:e,children:t.jsx(Tt,{className:"h-4 w-4"})})]})]}),t.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[t.jsx("div",{className:"w-80 border-r",children:t.jsx($n,{className:"h-full",children:o?t.jsx("div",{className:"p-4 text-center text-muted-foreground",children:"Loading workspaces..."}):s.length===0?t.jsxs("div",{className:"p-4 text-center text-muted-foreground",children:[t.jsx(er,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),t.jsx("p",{children:"No workspaces yet"}),t.jsx("p",{className:"text-sm",children:"Create one to start collaborating"})]}):t.jsx("div",{className:"p-2 space-y-1",children:s.map(re=>t.jsxs("button",{onClick:()=>Ae(re),className:Oe("w-full text-left p-3 rounded-lg transition-colors",(x==null?void 0:x.id)===re.id?"bg-accent":"hover:bg-accent/50"),children:[t.jsx("div",{className:"font-medium truncate",children:re.name}),t.jsxs("div",{className:"flex items-center gap-3 mt-1 text-xs text-muted-foreground",children:[t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx(er,{className:"h-3 w-3"}),re._count.members]}),t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx(_t,{className:"h-3 w-3"}),re._count.notes]})]})]},re.id))})})}),t.jsx("div",{className:"flex-1 overflow-hidden",children:x?t.jsx($n,{className:"h-full",children:t.jsxs("div",{className:"p-6 space-y-6",children:[t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-xl font-semibold",children:x.name}),x.description&&t.jsx("p",{className:"text-muted-foreground mt-1",children:x.description}),t.jsxs("p",{className:"text-sm text-muted-foreground mt-2",children:["Created by ",x.owner.displayName||x.owner.email]})]}),t.jsxs(gs,{children:[t.jsx(Nr,{asChild:!0,children:t.jsx(le,{variant:"outline",size:"icon",children:t.jsx(_i,{className:"h-4 w-4"})})}),t.jsxs(Dr,{align:"end",children:[n&&t.jsxs(ht,{onClick:()=>{n(x.id),e()},children:[t.jsx(_t,{className:"h-4 w-4 mr-2"}),"View Notes"]}),we&&t.jsxs(t.Fragment,{children:[t.jsxs(ht,{onClick:X,children:[t.jsx(Tu,{className:"h-4 w-4 mr-2"}),"Settings"]}),t.jsxs(ht,{onClick:()=>O(!0),children:[t.jsx($o,{className:"h-4 w-4 mr-2"}),"Invite Member"]})]}),t.jsx(Sr,{}),se?t.jsxs(ht,{onClick:()=>T(x.id),className:"text-destructive",children:[t.jsx(Yt,{className:"h-4 w-4 mr-2"}),"Delete Workspace"]}):t.jsxs(ht,{onClick:()=>U(x.id),className:"text-destructive",children:[t.jsx(Ei,{className:"h-4 w-4 mr-2"}),"Leave Workspace"]})]})]})]}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("h4",{className:"font-medium",children:["Members (",x.members.length,")"]}),we&&t.jsxs(le,{variant:"outline",size:"sm",onClick:()=>O(!0),children:[t.jsx($o,{className:"h-4 w-4 mr-2"}),"Invite"]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-lg bg-muted/30",children:[t.jsx("div",{className:"w-10 h-10 rounded-full bg-primary/10 flex items-center justify-center",children:(x.owner.displayName||x.owner.email).charAt(0).toUpperCase()}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("div",{className:"font-medium truncate",children:x.owner.displayName||x.owner.email}),t.jsx("div",{className:"text-sm text-muted-foreground truncate",children:x.owner.email})]}),t.jsxs("div",{className:"flex items-center gap-1 text-amber-500",children:[t.jsx(Ea,{className:"h-4 w-4"}),t.jsx("span",{className:"text-sm",children:"Owner"})]})]}),x.members.filter(re=>re.userId!==x.owner.id).map(re=>{const Pe=Dp(re.role);return t.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-lg hover:bg-muted/30",children:[t.jsx("div",{className:"w-10 h-10 rounded-full bg-primary/10 flex items-center justify-center",children:(re.user.displayName||re.user.email).charAt(0).toUpperCase()}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("div",{className:"font-medium truncate",children:re.user.displayName||re.user.email}),t.jsx("div",{className:"text-sm text-muted-foreground truncate",children:re.user.email})]}),we?t.jsxs(gs,{children:[t.jsx(Nr,{asChild:!0,children:t.jsxs(le,{variant:"ghost",size:"sm",children:[t.jsx(Pe,{className:"h-4 w-4 mr-2"}),ai(re.role)]})}),t.jsxs(Dr,{align:"end",children:[t.jsxs(ht,{onClick:()=>ce(re,"admin"),children:[t.jsx(Ea,{className:"h-4 w-4 mr-2"}),"Admin"]}),t.jsxs(ht,{onClick:()=>ce(re,"editor"),children:[t.jsx(Ns,{className:"h-4 w-4 mr-2"}),"Editor"]}),t.jsxs(ht,{onClick:()=>ce(re,"viewer"),children:[t.jsx(Cs,{className:"h-4 w-4 mr-2"}),"Viewer"]}),t.jsx(Sr,{}),t.jsxs(ht,{onClick:()=>Ie(re),className:"text-destructive",children:[t.jsx(Yt,{className:"h-4 w-4 mr-2"}),"Remove"]})]})]}):t.jsxs("div",{className:"flex items-center gap-1 text-muted-foreground",children:[t.jsx(Pe,{className:"h-4 w-4"}),t.jsx("span",{className:"text-sm",children:ai(re.role)})]})]},re.userId)})]})]})]})}):t.jsx("div",{className:"h-full flex items-center justify-center text-muted-foreground",children:t.jsxs("div",{className:"text-center",children:[t.jsx(er,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),t.jsx("p",{children:"Select a workspace to view details"})]})})})]}),t.jsx(Fn,{open:I,onOpenChange:k,children:t.jsxs(dn,{children:[t.jsxs(Gt,{children:[t.jsx(Qt,{children:"Create Workspace"}),t.jsx(mn,{children:"Create a new workspace to collaborate with others"})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium",children:"Name"}),t.jsx(vt,{value:Y,onChange:re=>J(re.target.value),placeholder:"Workspace name",autoFocus:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium",children:"Description (optional)"}),t.jsx(sr,{value:ne,onChange:re=>G(re.target.value),placeholder:"Describe the workspace",rows:3})]}),W&&t.jsx("p",{className:"text-sm text-destructive",children:W})]}),t.jsxs(Ln,{children:[t.jsx(le,{variant:"outline",onClick:()=>k(!1),children:"Cancel"}),t.jsx(le,{onClick:Be,disabled:ie,children:"Create"})]})]})}),t.jsx(Fn,{open:M,onOpenChange:D,children:t.jsxs(dn,{children:[t.jsx(Gt,{children:t.jsx(Qt,{children:"Workspace Settings"})}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium",children:"Name"}),t.jsx(vt,{value:Y,onChange:re=>J(re.target.value),placeholder:"Workspace name"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium",children:"Description"}),t.jsx(sr,{value:ne,onChange:re=>G(re.target.value),placeholder:"Describe the workspace",rows:3})]}),W&&t.jsx("p",{className:"text-sm text-destructive",children:W})]}),t.jsxs(Ln,{children:[t.jsx(le,{variant:"outline",onClick:()=>D(!1),children:"Cancel"}),t.jsx(le,{onClick:de,disabled:ie,children:"Save Changes"})]})]})}),t.jsx(Fn,{open:q,onOpenChange:O,children:t.jsxs(dn,{children:[t.jsxs(Gt,{children:[t.jsx(Qt,{children:"Invite Member"}),t.jsx(mn,{children:"Invite someone to join this workspace"})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium",children:"Email"}),t.jsx(vt,{type:"email",value:oe,onChange:re=>te(re.target.value),placeholder:"user@example.com",autoFocus:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium",children:"Role"}),t.jsxs(bp,{value:z,onValueChange:re=>K(re),children:[t.jsx(Rl,{children:t.jsx(no,{})}),t.jsxs($l,{children:[t.jsx(cs,{value:"admin",children:"Admin - Full access"}),t.jsx(cs,{value:"editor",children:"Editor - Can edit notes"}),t.jsx(cs,{value:"viewer",children:"Viewer - Read only"})]})]})]}),W&&t.jsx("p",{className:"text-sm text-destructive",children:W})]}),t.jsxs(Ln,{children:[t.jsx(le,{variant:"outline",onClick:()=>O(!1),children:"Cancel"}),t.jsx(le,{onClick:tt,disabled:ie,children:"Invite"})]})]})}),t.jsx(Rn,{open:!!Q,onOpenChange:re=>!re&&T(null),children:t.jsxs(pn,{children:[t.jsxs(gn,{children:[t.jsx(xn,{children:"Delete Workspace"}),t.jsx(vn,{children:"Are you sure you want to delete this workspace? This will remove all members and notes in the workspace will be moved to their original owners. This action cannot be undone."})]}),t.jsxs(yn,{children:[t.jsx(wn,{children:"Cancel"}),t.jsx(bn,{onClick:Le,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Delete"})]})]})}),t.jsx(Rn,{open:!!P,onOpenChange:re=>!re&&U(null),children:t.jsxs(pn,{children:[t.jsxs(gn,{children:[t.jsx(xn,{children:"Leave Workspace"}),t.jsx(vn,{children:"Are you sure you want to leave this workspace? You will lose access to all shared notes."})]}),t.jsxs(yn,{children:[t.jsx(wn,{children:"Cancel"}),t.jsx(bn,{onClick:Ve,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Leave"})]})]})})]})}function Mp({collaborators:e,className:n}){return e.length===0?null:t.jsxs("div",{className:Oe("flex items-center gap-1",n),children:[t.jsx(er,{className:"h-4 w-4 text-muted-foreground"}),t.jsxs("div",{className:"flex -space-x-2",children:[e.slice(0,5).map(s=>t.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center text-xs font-medium text-white border-2 border-background",style:{backgroundColor:s.color},title:s.name,children:s.name.charAt(0).toUpperCase()},s.odcId)),e.length>5&&t.jsxs("div",{className:"w-6 h-6 rounded-full flex items-center justify-center text-xs font-medium bg-muted text-muted-foreground border-2 border-background",title:`${e.length-5} more`,children:["+",e.length-5]})]}),t.jsxs("span",{className:"text-xs text-muted-foreground ml-1",children:[e.length," ",e.length===1?"user":"users"," editing"]})]})}function Tp({isConnected:e,isCollaborating:n,collaborators:s,error:o,isOffline:l=!1}){return o?t.jsxs("div",{className:"flex items-center gap-2 text-xs text-destructive",children:[t.jsx("div",{className:"w-2 h-2 rounded-full bg-destructive"}),t.jsxs("span",{children:["Error: ",o]})]}):l?t.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[t.jsx("div",{className:"w-2 h-2 rounded-full bg-muted"}),t.jsx("span",{children:"Offline mode"})]}):e?n&&s.length>0?t.jsx(Mp,{collaborators:s}):t.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[t.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500"}),t.jsx("span",{children:"Connected"})]}):t.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[t.jsx("div",{className:"w-2 h-2 rounded-full bg-muted animate-pulse"}),t.jsx("span",{children:"Connecting..."})]})}const Ap=0,Bl=1,zl=2,Pp=(e,n,s)=>{In(e,Bl),ji(e,qc(n,s))},Op=(e,n,s)=>Pp(n,s,ki(e)),Vl=(e,n,s,o)=>{try{Uc(n,ki(e),s)}catch(l){o!=null&&o(l),console.error("Caught error while handling a Yjs update",l)}},Ep=(e,n)=>{In(e,zl),ji(e,n)},_p=Vl,Ip=(e,n,s,o,l)=>{const u=jr(e);switch(u){case Ap:Op(e,n,s);break;case Bl:Vl(e,s,o,l);break;case zl:_p(e,s,o,l);break;default:throw new Error("Unknown message type")}return u},Ca=3e4;class Fp extends Gc{constructor(n){super(),this.doc=n,this.clientID=n.clientID,this.states=new Map,this.meta=new Map,this._checkInterval=setInterval(()=>{const s=ds();this.getLocalState()!==null&&Ca/2<=s-this.meta.get(this.clientID).lastUpdated&&this.setLocalState(this.getLocalState());const o=[];this.meta.forEach((l,u)=>{u!==this.clientID&&Ca<=s-l.lastUpdated&&this.states.has(u)&&o.push(u)}),o.length>0&&Lp(this,o,"timeout")},Qc(Ca/10)),n.on("destroy",()=>{this.destroy()}),this.setLocalState({})}destroy(){this.emit("destroy",[this]),this.setLocalState(null),super.destroy(),clearInterval(this._checkInterval)}getLocalState(){return this.states.get(this.clientID)||null}setLocalState(n){const s=this.clientID,o=this.meta.get(s),l=o===void 0?0:o.clock+1,u=this.states.get(s);n===null?this.states.delete(s):this.states.set(s,n),this.meta.set(s,{clock:l,lastUpdated:ds()});const d=[],m=[],y=[],g=[];n===null?g.push(s):u==null?n!=null&&d.push(s):(m.push(s),Ci(u,n)||y.push(s)),(d.length>0||y.length>0||g.length>0)&&this.emit("change",[{added:d,updated:y,removed:g},"local"]),this.emit("update",[{added:d,updated:m,removed:g},"local"])}setLocalStateField(n,s){const o=this.getLocalState();o!==null&&this.setLocalState({...o,[n]:s})}getStates(){return this.states}}const Lp=(e,n,s)=>{const o=[];for(let l=0;l<n.length;l++){const u=n[l];if(e.states.has(u)){if(e.states.delete(u),u===e.clientID){const d=e.meta.get(u);e.meta.set(u,{clock:d.clock+1,lastUpdated:ds()})}o.push(u)}}o.length>0&&(e.emit("change",[{added:[],updated:[],removed:o},s]),e.emit("update",[{added:[],updated:[],removed:o},s]))},Rp=(e,n,s=e.states)=>{const o=n.length,l=Aa();In(l,o);for(let u=0;u<o;u++){const d=n[u],m=s.get(d)||null,y=e.meta.get(d).clock;In(l,d),In(l,y),Jc(l,JSON.stringify(m))}return Ta(l)},$p=(e,n,s)=>{const o=Ni(n),l=ds(),u=[],d=[],m=[],y=[],g=jr(o);for(let w=0;w<g;w++){const b=jr(o);let C=jr(o);const x=JSON.parse(Xc(o)),j=e.meta.get(b),I=e.states.get(b),k=j===void 0?0:j.clock;(k<C||k===C&&x===null&&e.states.has(b))&&(x===null?b===e.clientID&&e.getLocalState()!=null?C++:e.states.delete(b):e.states.set(b,x),e.meta.set(b,{clock:C,lastUpdated:l}),j===void 0&&x!==null?u.push(b):j!==void 0&&x===null?y.push(b):x!==null&&(Ci(x,I)||m.push(b),d.push(b)))}(u.length>0||m.length>0||y.length>0)&&e.emit("change",[{added:u,updated:m,removed:y},s]),(u.length>0||d.length>0||y.length>0)&&e.emit("update",[{added:u,updated:d,removed:y},s])},Na=0,oi=["#FF6B6B","#4ECDC4","#45B7D1","#96CEB4","#FFEAA7","#DDA0DD","#98D8C8","#F7DC6F"];function Bp(e){const[n,s]=f.useState({isConnected:!1,isCollaborating:!1,collaborators:[],error:null,isOffline:!1}),o=f.useRef(null),l=f.useRef(null),u=f.useRef(null),d=f.useCallback(()=>{var j;if((j=o.current)!=null&&j.connected)return;const C=localStorage.getItem("token");if(!C){s(I=>({...I,error:"Not authenticated"}));return}const x=Zc("http://localhost:3001",{auth:{token:C},path:"/socket.io",transports:["websocket","polling"]});x.on("connect",()=>{s(I=>({...I,isConnected:!0,error:null,isOffline:!1}))}),x.on("disconnect",()=>{s(I=>({...I,isConnected:!1,isCollaborating:!1,collaborators:[]}))}),x.on("connect_error",()=>{s(I=>({...I,isOffline:!0,error:null}))}),o.current=x},[]),m=f.useCallback(()=>{o.current&&(o.current.disconnect(),o.current=null),l.current=null,u.current=null,s({isConnected:!1,isCollaborating:!1,collaborators:[],error:null,isOffline:!1})},[]),y=f.useCallback(async()=>{var C;return!e||!((C=o.current)!=null&&C.connected)?null:new Promise(x=>{const j=o.current,I=new eu;l.current=I;const k=new Fp(I);u.current=k;const M=JSON.parse(localStorage.getItem("user")||"{}");k.setLocalStateField("user",{name:M.displayName||M.email||"Anonymous",color:oi[Math.floor(Math.random()*oi.length)]}),j.on("sync",q=>{const O=Ni(new Uint8Array(q));if(jr(O)===Na){const T=Aa();In(T,Na),Ip(O,T,I,null),tu(T)>1&&j.emit("sync",e,Ta(T))}}),j.on("awareness",q=>{$p(k,new Uint8Array(q),null),D()}),j.on("user-joined",q=>{q.noteId===e&&D()}),j.on("user-left",q=>{q.noteId===e&&D()}),j.on("cursor",q=>{q.noteId===e&&s(O=>({...O,collaborators:O.collaborators.map(Q=>Q.odcId===q.userId?{...Q,cursor:q.cursor}:Q)}))});const D=()=>{const q=k.getStates(),O=[];q.forEach((Q,T)=>{T!==I.clientID&&Q.user&&O.push({odcId:T.toString(),name:Q.user.name,color:Q.user.color,cursor:Q.cursor})}),s(Q=>({...Q,collaborators:O}))};I.on("update",q=>{const O=Aa();In(O,Na),Ep(O,q),j.emit("sync",e,Ta(O))}),k.on("change",()=>{const q=Rp(k,Array.from(k.getStates().keys()));j.emit("awareness",e,q),D()}),j.emit("join-document",e,q=>{q.success?(s(O=>({...O,isCollaborating:!0})),x(I)):(s(O=>({...O,error:q.error||"Failed to join"})),x(null))})})},[e]),g=f.useCallback(()=>{e&&o.current&&o.current.emit("leave-document",e),l.current=null,u.current=null,s(C=>({...C,isCollaborating:!1,collaborators:[]}))},[e]),w=f.useCallback((C,x)=>{var j;e&&((j=o.current)!=null&&j.connected)&&o.current.emit("cursor",e,{position:C,selection:x}),u.current&&u.current.setLocalStateField("cursor",{position:C,selection:x})},[e]),b=f.useCallback((C="content")=>{var x;return((x=l.current)==null?void 0:x.getText(C))||null},[]);return f.useEffect(()=>(d(),()=>{g(),m()}),[d,m,g]),f.useEffect(()=>(e&&n.isConnected&&y(),()=>{g()}),[e,n.isConnected,y,g]),{...n,connect:d,disconnect:m,joinDocument:y,leaveDocument:g,updateCursor:w,getText:b,doc:l.current,awareness:u.current}}function zp(){const[e,n]=f.useState({activeModal:null,modalData:void 0}),s=f.useCallback((u,d)=>{n({activeModal:u,modalData:d})},[]),o=f.useCallback(()=>{n({activeModal:null,modalData:void 0})},[]),l=f.useCallback(u=>e.activeModal===u,[e.activeModal]);return{...e,openModal:s,closeModal:o,isOpen:l}}const Vp={selectedNote:null,selectedFolderId:null,errorMessage:null,showArchived:!1,showFolders:!0,distractionFreeMode:!1};function Yp(e,n){switch(n.type){case"SELECT_NOTE":return{...e,selectedNote:n.payload};case"SELECT_FOLDER":return{...e,selectedFolderId:n.payload};case"SET_ERROR":return{...e,errorMessage:n.payload};case"TOGGLE_ARCHIVED":return{...e,showArchived:!e.showArchived,selectedNote:null};case"TOGGLE_FOLDERS":return{...e,showFolders:!e.showFolders};case"TOGGLE_DISTRACTION_FREE":return{...e,distractionFreeMode:!e.distractionFreeMode};case"EXIT_DISTRACTION_FREE":return{...e,distractionFreeMode:!1};case"CLEAR_SELECTION":return{...e,selectedNote:null};default:return e}}function Kp(){const[e,n]=f.useReducer(Yp,Vp),s=f.useCallback(w=>{n({type:"SELECT_NOTE",payload:w})},[]),o=f.useCallback(w=>{n({type:"SELECT_FOLDER",payload:w})},[]),l=f.useCallback(w=>{n({type:"SET_ERROR",payload:w})},[]),u=f.useCallback(()=>{n({type:"TOGGLE_ARCHIVED"})},[]),d=f.useCallback(()=>{n({type:"TOGGLE_FOLDERS"})},[]),m=f.useCallback(()=>{n({type:"TOGGLE_DISTRACTION_FREE"})},[]),y=f.useCallback(()=>{n({type:"EXIT_DISTRACTION_FREE"})},[]),g=f.useCallback(()=>{n({type:"CLEAR_SELECTION"})},[]);return{state:e,actions:{selectNote:s,selectFolder:o,setError:l,toggleArchived:u,toggleFolders:d,toggleDistractionFree:m,exitDistractionFree:y,clearSelection:g}}}const ii=240,Wp=72;function fg(){var Wt,Ct;const e=Pc(),n=Va(),s=xi(n.breakpoints.down("md")),[o,l]=f.useState(!1),[u,d]=f.useState("notes"),{state:m,actions:y}=Kp(),{selectedNote:g,selectedFolderId:w,errorMessage:b,showArchived:C,showFolders:x,distractionFreeMode:j}=m,{selectNote:I,selectFolder:k,setError:M,toggleArchived:D,toggleFolders:q,toggleDistractionFree:O,exitDistractionFree:Q,clearSelection:T}=y,P=zp(),[U,Y]=f.useState(!s),{notes:J,createNote:ne,updateNote:G,deleteNote:oe,searchNotes:te,refresh:z,fetchArchivedNotes:K,archivedNotes:W}=yd(),ee=Bp((g==null?void 0:g.id)||null),{isOnline:ie,isSyncing:me,sync:ke}=wd(),[Te,Ae]=f.useState(""),Be=f.useMemo(()=>{const fe=new Set;return J.forEach(Se=>{var Ge;(Ge=Se.tags)==null||Ge.forEach(bt=>fe.add(bt))}),Array.from(fe).sort()},[J]),de=fe=>{},Le=f.useMemo(()=>{try{return JSON.parse(localStorage.getItem("user")||"{}")}catch{return{}}},[]),Ve=[{id:"notes",label:"All Notes",icon:t.jsx(_t,{className:"h-5 w-5"}),onClick:()=>{d("notes"),C&&D()}},{id:"starred",label:"Starred",icon:t.jsx(Pu,{className:"h-5 w-5"}),onClick:()=>d("starred")},{id:"archive",label:"Archive",icon:t.jsx(ks,{className:"h-5 w-5"}),onClick:()=>{d("archive"),C||(D(),K())}},{id:"tags",label:"Tags",icon:t.jsx(rr,{className:"h-5 w-5"}),badge:Be.length,onClick:()=>d("tags")}],tt=[{id:"graph",label:"Graph View",icon:t.jsx(ju,{className:"h-5 w-5"}),onClick:()=>P.openModal("graphView")},{id:"activity",label:"Activity",icon:t.jsx(hs,{className:"h-5 w-5"}),onClick:()=>P.openModal("activityFeed")},{id:"workspaces",label:"Workspaces",icon:t.jsx(er,{className:"h-5 w-5"}),onClick:()=>P.openModal("workspaces")}];f.useEffect(()=>{Jn.isFirstVisit()&&P.openModal("welcome")},[P]),f.useEffect(()=>{const fe=Se=>{(Se.ctrlKey||Se.metaKey)&&Se.key==="?"&&(Se.preventDefault(),P.openModal("keyboardShortcuts")),(Se.ctrlKey||Se.metaKey)&&Se.shiftKey&&Se.key==="F"&&(Se.preventDefault(),O()),Se.key==="Escape"&&j&&Q()};return window.addEventListener("keydown",fe),()=>window.removeEventListener("keydown",fe)},[j,P,O,Q]);const ce=fe=>{Ae(fe),fe.trim()?te(fe):z()},Ie=async()=>{try{const fe=await ne("Untitled","");I(fe),M(null),Xn.trackNoteCreated()}catch(fe){const Se=fe instanceof Error?fe.message:"Failed to create note";M(Se)}},X=async fe=>{try{await oe(fe),(g==null?void 0:g.id)===fe&&T(),M(null)}catch(Se){const Ge=Se instanceof Error?Se.message:"Failed to delete note";M(Ge)}},se=async(fe,Se)=>{try{await G(fe,{isPinned:Se}),z(),M(null)}catch(Ge){const bt=Ge instanceof Error?Ge.message:"Failed to pin note";M(bt)}},Ce=async(fe,Se)=>{try{await G(fe,{isArchived:Se}),(g==null?void 0:g.id)===fe&&T(),z(),C&&K(),M(null)}catch(Ge){const bt=Ge instanceof Error?Ge.message:"Failed to archive note";M(bt)}},we=()=>{D(),C?z():K()},re=async(fe,Se)=>{try{await G(fe,Se),M(null)}catch(Ge){const bt=Ge instanceof Error?Ge.message:"Failed to save note";M(bt)}},Pe=()=>{or.logout(),e("/login")},qe=async()=>{try{await ke(),M(null)}catch(fe){const Se=fe instanceof Error?fe.message:"Failed to sync";M(Se)}},Ze=async fe=>{try{for(const Se of fe)await ne(Se.title||"Untitled",Se.content||"",Se.tags);z(),M(null)}catch(Se){const Ge=Se instanceof Error?Se.message:"Failed to import notes";M(Ge)}},st=async fe=>{try{const Se=Bt.createNoteFromTemplate(fe),Ge=await ne(Se.title||"Untitled",Se.content||"",Se.tags);I(Ge),M(null),Xn.trackTemplateUsed(fe.name,fe.id.startsWith("custom-"))}catch(Se){const Ge=Se instanceof Error?Se.message:"Failed to create note from template";M(Ge)}},Ee=async()=>{try{const fe=Bt.createDailyNote(),Se=await ne(fe.title||"Untitled",fe.content||"",fe.tags);I(Se),M(null),Xn.trackDailyNoteCreated()}catch(fe){const Se=fe instanceof Error?fe.message:"Failed to create daily note";M(Se)}},Re=async()=>{try{if(!Jn.hasSampleNotes()){for(const fe of Td)await ne(fe.title,fe.content,fe.tags);Jn.markSampleNotesCreated(),z()}Jn.completeOnboarding(),Xn.trackOnboardingCompleted(!Jn.hasSampleNotes()),M(null)}catch(fe){const Se=fe instanceof Error?fe.message:"Failed to create sample notes";M(Se)}},kt=async fe=>{try{g&&(await G(g.id,{title:fe.title,content:fe.content,tags:fe.tags}),z(),P.closeModal(),Xn.trackVersionRestored(),M(null))}catch(Se){const Ge=Se instanceof Error?Se.message:"Failed to restore version";M(Ge)}},pt=()=>t.jsxs(Qe,{sx:{width:o?Wp:ii,height:"100vh",bgcolor:"#1a1a2e",color:"white",display:"flex",flexDirection:"column",transition:"width 0.2s ease",overflow:"hidden"},children:[t.jsxs(Qe,{sx:{p:2,display:"flex",alignItems:"center",gap:1.5,borderBottom:"1px solid rgba(255,255,255,0.1)",minHeight:64},children:[t.jsx(Qe,{sx:{width:36,height:36,borderRadius:2,background:"linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%)",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:t.jsx(_t,{className:"h-5 w-5 text-white"})}),!o&&t.jsx(St,{variant:"h6",sx:{fontWeight:700,color:"white"},children:"VibeNotes"})]}),t.jsxs(Qe,{sx:{flex:1,py:2,overflow:"auto"},children:[t.jsx(Lo,{sx:{px:1},children:Ve.map(fe=>t.jsx(Ro,{disablePadding:!0,sx:{mb:.5},children:t.jsxs(da,{onClick:fe.onClick,selected:u===fe.id,sx:{borderRadius:2,px:o?1.5:2,justifyContent:o?"center":"flex-start","&.Mui-selected":{bgcolor:"rgba(99, 102, 241, 0.2)","&:hover":{bgcolor:"rgba(99, 102, 241, 0.3)"}},"&:hover":{bgcolor:"rgba(255,255,255,0.05)"}},children:[t.jsx(ha,{sx:{color:u===fe.id?"#6366f1":"rgba(255,255,255,0.7)",minWidth:o?0:40},children:fe.badge?t.jsx(Ac,{badgeContent:fe.badge,color:"primary",max:99,children:fe.icon}):fe.icon}),!o&&t.jsx(fa,{primary:fe.label,sx:{"& .MuiTypography-root":{fontSize:"0.9rem",color:u===fe.id?"white":"rgba(255,255,255,0.7)"}}})]})},fe.id))}),t.jsx(us,{sx:{my:2,borderColor:"rgba(255,255,255,0.1)"}}),!o&&t.jsx(St,{variant:"caption",sx:{px:3,color:"rgba(255,255,255,0.5)",fontWeight:600,textTransform:"uppercase",letterSpacing:1},children:"Tools"}),t.jsx(Lo,{sx:{px:1,mt:1},children:tt.map(fe=>t.jsx(Ro,{disablePadding:!0,sx:{mb:.5},children:t.jsxs(da,{onClick:fe.onClick,sx:{borderRadius:2,px:o?1.5:2,justifyContent:o?"center":"flex-start","&:hover":{bgcolor:"rgba(255,255,255,0.05)"}},children:[t.jsx(ha,{sx:{color:"rgba(255,255,255,0.7)",minWidth:o?0:40},children:fe.icon}),!o&&t.jsx(fa,{primary:fe.label,sx:{"& .MuiTypography-root":{fontSize:"0.9rem",color:"rgba(255,255,255,0.7)"}}})]})},fe.id))})]}),t.jsx(Qe,{sx:{p:2,borderTop:"1px solid rgba(255,255,255,0.1)"},children:t.jsxs(da,{onClick:()=>l(!o),sx:{borderRadius:2,justifyContent:o?"center":"flex-start","&:hover":{bgcolor:"rgba(255,255,255,0.05)"}},children:[t.jsx(ha,{sx:{color:"rgba(255,255,255,0.7)",minWidth:o?0:40},children:t.jsx(ru,{className:`h-5 w-5 transition-transform ${o?"rotate-180":""}`})}),!o&&t.jsx(fa,{primary:"Collapse",sx:{"& .MuiTypography-root":{fontSize:"0.9rem",color:"rgba(255,255,255,0.7)"}}})]})})]});return j?t.jsxs(Qe,{sx:{height:"100vh",position:"relative"},children:[t.jsx(Qe,{sx:{position:"absolute",top:8,right:8,fontSize:"0.75rem",color:"text.secondary",opacity:.5,transition:"opacity 0.2s",zIndex:10,"&:hover":{opacity:1}},children:"Press Esc to exit"}),t.jsx(zo,{note:g,onSave:re,onError:M})]}):t.jsxs(Qe,{sx:{display:"flex",height:"100vh",bgcolor:"#f5f5f5"},children:[!s&&pt(),s&&t.jsx(Nc,{open:U,onClose:()=>Y(!1),sx:{"& .MuiDrawer-paper":{width:ii,bgcolor:"#1a1a2e"}},children:pt()}),t.jsxs(Qe,{sx:{flex:1,display:"flex",flexDirection:"column",overflow:"hidden"},children:[t.jsxs(ca,{elevation:0,sx:{px:3,py:1.5,display:"flex",alignItems:"center",gap:2,borderBottom:"1px solid",borderColor:"divider",bgcolor:"white"},children:[s&&t.jsx(_n,{onClick:()=>Y(!0),children:t.jsx(bu,{className:"h-5 w-5"})}),t.jsx(fi,{placeholder:"Search notes...",size:"small",value:Te,onChange:fe=>ce(fe.target.value),sx:{width:300,"& .MuiOutlinedInput-root":{bgcolor:"#f5f5f5",borderRadius:2,"& fieldset":{border:"none"}}},InputProps:{startAdornment:t.jsx(Dc,{position:"start",children:t.jsx(ws,{className:"h-4 w-4 text-gray-400"})})}}),t.jsx(Qe,{sx:{flex:1}}),t.jsxs(Qe,{sx:{display:"flex",alignItems:"center",gap:1},children:[ie?t.jsx(ou,{className:"h-4 w-4 text-green-500"}):t.jsx(au,{className:"h-4 w-4 text-gray-400"}),t.jsx(St,{variant:"caption",color:"text.secondary",children:ie?"Online":"Offline"})]}),t.jsx(ua,{title:"Sync",children:t.jsx("span",{children:t.jsx(_n,{onClick:qe,disabled:!ie||me,size:"small",children:t.jsx(Ma,{className:`h-4 w-4 ${me?"animate-spin":""}`})})})}),t.jsx(ud,{note:g,notes:J,onImport:Ze,onError:M}),t.jsx(ua,{title:"Keyboard Shortcuts",children:t.jsx(_n,{onClick:()=>P.openModal("keyboardShortcuts"),size:"small",children:t.jsx(Oi,{className:"h-4 w-4"})})}),t.jsx(Fc,{}),t.jsx(us,{orientation:"vertical",flexItem:!0}),t.jsxs(Qe,{sx:{display:"flex",alignItems:"center",gap:1},children:[t.jsx(Sc,{sx:{width:32,height:32,bgcolor:"#6366f1",fontSize:"0.875rem"},children:((Wt=Le.displayName)==null?void 0:Wt.charAt(0))||((Ct=Le.email)==null?void 0:Ct.charAt(0))||"U"}),!s&&t.jsx(St,{variant:"body2",sx:{fontWeight:500},children:Le.displayName||Le.email||"User"}),t.jsx(ua,{title:"Logout",children:t.jsx(_n,{onClick:Pe,size:"small",children:t.jsx(Ei,{className:"h-4 w-4"})})})]})]}),t.jsxs(Qe,{sx:{flex:1,display:"flex",overflow:"hidden"},children:[t.jsxs(ca,{elevation:0,sx:{width:320,borderRight:"1px solid",borderColor:"divider",display:"flex",flexDirection:"column",bgcolor:"white"},children:[t.jsxs(Qe,{sx:{p:2,borderBottom:"1px solid",borderColor:"divider"},children:[t.jsxs(Qe,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:2},children:[t.jsx(St,{variant:"h6",sx:{fontWeight:600},children:C?"Archived Notes":"All Notes"}),t.jsxs(St,{variant:"caption",color:"text.secondary",children:[(C?W:J).length," notes"]})]}),t.jsxs(Qe,{sx:{display:"flex",gap:1},children:[t.jsx(le,{onClick:Ie,className:"flex-1",size:"sm",children:"New Note"}),t.jsx(Sd,{onSelectTemplate:st,onCreateDailyNote:Ee})]})]}),t.jsx(Qe,{sx:{px:2,py:1,borderBottom:"1px solid",borderColor:"divider"},children:t.jsxs(le,{variant:"ghost",size:"sm",onClick:q,className:"w-full justify-start",children:[t.jsx(hu,{className:"h-4 w-4 mr-2"}),x?"Hide Folders":"Show Folders"]})}),x&&t.jsx(Qe,{sx:{px:2,py:1,borderBottom:"1px solid",borderColor:"divider",maxHeight:150,overflowY:"auto"},children:t.jsx(Xh,{selectedFolderId:w,onSelectFolder:k,onError:M})}),t.jsx(Qe,{sx:{flex:1,overflow:"auto"},children:t.jsx(Qu,{notes:C?W:J,selectedNote:g,onSelectNote:I,onCreateNote:Ie,onDeleteNote:X,onTogglePin:se,onToggleArchive:Ce,onSearch:te,showArchived:C,onToggleShowArchived:we})})]}),t.jsxs(Qe,{sx:{flex:1,display:"flex",flexDirection:"column",bgcolor:"white"},children:[g&&t.jsxs(Qe,{sx:{px:2,py:1,borderBottom:"1px solid",borderColor:"divider",display:"flex",alignItems:"center",gap:1},children:[t.jsx(Bu,{noteId:g.id,onError:M}),t.jsxs(le,{variant:"ghost",size:"sm",onClick:()=>{P.openModal("versionHistory"),Xn.trackVersionHistoryViewed()},children:[t.jsx(Wa,{className:"h-4 w-4 mr-2"}),"History"]}),t.jsxs(le,{variant:"ghost",size:"sm",onClick:()=>P.isOpen("comments")?P.closeModal():P.openModal("comments"),children:[t.jsx(_a,{className:"h-4 w-4 mr-2"}),"Comments"]}),t.jsx(Qe,{sx:{flex:1}}),t.jsx(Tp,{isConnected:ee.isConnected,isCollaborating:ee.isCollaborating,collaborators:ee.collaborators,error:ee.error,isOffline:ee.isOffline})]}),t.jsx(Qe,{sx:{flex:1,overflow:"auto"},children:t.jsx(zo,{note:g,onSave:re,onError:M})})]}),t.jsxs(ca,{elevation:0,sx:{width:280,borderLeft:"1px solid",borderColor:"divider",p:2,overflow:"auto",display:{xs:"none",lg:"block"},bgcolor:"#fafafa"},children:[t.jsx(md,{}),g&&t.jsx(fd,{noteId:g.id,onError:M})]})]})]}),P.isOpen("versionHistory")&&g&&t.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:t.jsx("div",{className:"bg-background rounded-lg shadow-lg w-full h-full sm:w-[90vw] sm:h-[80vh] max-w-6xl overflow-hidden",children:t.jsx(Uh,{noteId:g.id,onRestore:kt,onClose:()=>P.closeModal()})})}),t.jsx(Md,{open:P.isOpen("welcome"),onClose:()=>{P.closeModal(),Jn.completeOnboarding()},onCreateSampleNotes:Re}),t.jsx(Gh,{isOpen:P.isOpen("keyboardShortcuts"),onClose:()=>P.closeModal()}),P.isOpen("graphView")&&t.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:t.jsx("div",{className:"bg-background rounded-lg shadow-lg w-full h-full sm:w-[90vw] sm:h-[80vh] max-w-6xl flex flex-col overflow-hidden",children:t.jsx(Jh,{notes:J,onSelectNote:fe=>{const Se=J.find(Ge=>Ge.id===fe);Se&&I(Se),P.closeModal()},onClose:()=>P.closeModal()})})}),P.isOpen("advancedSearch")&&t.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:t.jsx("div",{className:"bg-background rounded-lg shadow-lg w-full sm:w-[90vw] max-w-2xl max-h-full sm:max-h-[80vh] overflow-y-auto",children:t.jsx(cp,{notes:J,allTags:Be,onFiltersChange:de,onClose:()=>P.closeModal()})})}),P.isOpen("activityFeed")&&t.jsx(gp,{onClose:()=>P.closeModal(),onSelectNote:fe=>{const Se=J.find(Ge=>Ge.id===fe);Se&&I(Se),P.closeModal()}}),P.isOpen("comments")&&g&&t.jsx(vp,{noteId:g.id,onClose:()=>P.closeModal()}),P.isOpen("workspaces")&&t.jsx(Sp,{onClose:()=>P.closeModal()}),t.jsx(Mc,{open:!!b,autoHideDuration:6e3,onClose:()=>M(null),anchorOrigin:{vertical:"bottom",horizontal:"center"},children:t.jsx(Tc,{onClose:()=>M(null),severity:"error",sx:{width:"100%"},children:b})})]})}export{fg as default};
